var Xn=Object.defineProperty;var Li=e=>{throw TypeError(e)};var eo=(e,r,a)=>r in e?Xn(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var Gr=(e,r,a)=>eo(e,typeof r!="symbol"?r+"":r,a),ti=(e,r,a)=>r.has(e)||Li("Cannot "+a);var G=(e,r,a)=>(ti(e,r,"read from private field"),a?a.call(e):r.get(e)),pt=(e,r,a)=>r.has(e)?Li("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,a),ut=(e,r,a,n)=>(ti(e,r,"write to private field"),n?n.call(e,a):r.set(e,a),a),xr=(e,r,a)=>(ti(e,r,"access private method"),a);var Ws=Array.isArray,to=Array.prototype.indexOf,Da=Array.prototype.includes,Hs=Array.from,Ia=Object.defineProperty,Ga=Object.getOwnPropertyDescriptor,ro=Object.getOwnPropertyDescriptors,rn=Object.prototype,ao=Array.prototype,gi=Object.getPrototypeOf,Ri=Object.isExtensible;const so=()=>{};function io(e){for(var r=0;r<e.length;r++)e[r]()}function an(){var e,r,a=new Promise((n,o)=>{e=n,r=o});return{promise:a,resolve:e,reject:r}}function no(e,r){if(Array.isArray(e))return e;if(!(Symbol.iterator in e))return Array.from(e);const a=[];for(const n of e)if(a.push(n),a.length===r)break;return a}const vr=2,bs=4,Js=8,sn=1<<24,na=16,Br=32,za=64,nn=128,Or=512,ir=1024,ur=2048,zr=4096,kr=8192,fa=16384,$s=32768,Qa=65536,Us=1<<17,on=1<<18,ss=1<<19,oo=1<<20,ra=1<<25,Ma=65536,ni=1<<21,Ys=1<<22,pa=1<<23,La=Symbol("$state"),lo=Symbol(""),ln=Symbol("proxy path"),Ta=new class extends Error{constructor(){super(...arguments);Gr(this,"name","StaleReactionError");Gr(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},co=1,vo=11;function uo(e){{const r=new Error(`lifecycle_outside_component
\`${e}(...)\` can only be used during component initialisation
https://svelte.dev/e/lifecycle_outside_component`);throw r.name="Svelte error",r}}function fo(){{const e=new Error("async_derived_orphan\nCannot create a `$derived(...)` with an `await` expression outside of an effect tree\nhttps://svelte.dev/e/async_derived_orphan");throw e.name="Svelte error",e}}function Ni(){{const e=new Error("bind_invalid_checkbox_value\nUsing `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\nhttps://svelte.dev/e/bind_invalid_checkbox_value");throw e.name="Svelte error",e}}function po(e,r){{const a=new Error(`component_api_changed
Calling \`${e}\` on a component instance (of ${r}) is no longer valid in Svelte 5
https://svelte.dev/e/component_api_changed`);throw a.name="Svelte error",a}}function xo(e,r){{const a=new Error(`component_api_invalid_new
Attempted to instantiate ${e} with \`new ${r}\`, which is no longer valid in Svelte 5. If this component is not under your control, set the \`compatibility.componentApi\` compiler option to \`4\` to keep it working.
https://svelte.dev/e/component_api_invalid_new`);throw a.name="Svelte error",a}}function mo(){{const e=new Error(`derived_references_self
A derived value cannot reference itself recursively
https://svelte.dev/e/derived_references_self`);throw e.name="Svelte error",e}}function _o(e,r,a){{const n=new Error(`each_key_duplicate
${a?`Keyed each block has duplicate key \`${a}\` at indexes ${e} and ${r}`:`Keyed each block has duplicate key at indexes ${e} and ${r}`}
https://svelte.dev/e/each_key_duplicate`);throw n.name="Svelte error",n}}function bo(e){{const r=new Error(`effect_in_teardown
\`${e}\` cannot be used inside an effect cleanup function
https://svelte.dev/e/effect_in_teardown`);throw r.name="Svelte error",r}}function go(){{const e=new Error("effect_in_unowned_derived\nEffect cannot be created inside a `$derived` value that was not itself created inside an effect\nhttps://svelte.dev/e/effect_in_unowned_derived");throw e.name="Svelte error",e}}function ho(e){{const r=new Error(`effect_orphan
\`${e}\` can only be used inside an effect (e.g. during component initialisation)
https://svelte.dev/e/effect_orphan`);throw r.name="Svelte error",r}}function yo(){{const e=new Error(`effect_update_depth_exceeded
Maximum update depth exceeded. This typically indicates that an effect reads and writes the same piece of state
https://svelte.dev/e/effect_update_depth_exceeded`);throw e.name="Svelte error",e}}function wo(e){{const r=new Error(`rune_outside_svelte
The \`${e}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files
https://svelte.dev/e/rune_outside_svelte`);throw r.name="Svelte error",r}}function ko(){{const e=new Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw e.name="Svelte error",e}}function To(){{const e=new Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw e.name="Svelte error",e}}function $o(){{const e=new Error("state_unsafe_mutation\nUpdating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw e.name="Svelte error",e}}function Eo(){{const e=new Error("svelte_boundary_reset_onerror\nA `<svelte:boundary>` `reset` function cannot be called while an error is still being handled\nhttps://svelte.dev/e/svelte_boundary_reset_onerror");throw e.name="Svelte error",e}}const So=1,Co=2,dn=4,Ao=8,Po=16,Oo=1,jo=2,lr=Symbol(),c=Symbol("filename"),cn="http://www.w3.org/1999/xhtml";var Es="font-weight: bold",Ss="font-weight: normal";function Lo(e,r){console.warn(`%c[svelte] binding_property_non_reactive
%c${r?`\`${e}\` (${r}) is binding to a non-reactive property`:`\`${e}\` is binding to a non-reactive property`}
https://svelte.dev/e/binding_property_non_reactive`,Es,Ss)}function Ro(e){console.warn(`%c[svelte] console_log_state
%cYour \`console.${e}\` contained \`$state\` proxies. Consider using \`$inspect(...)\` or \`$state.snapshot(...)\` instead
https://svelte.dev/e/console_log_state`,Es,Ss)}function No(){console.warn("%c[svelte] select_multiple_invalid_value\n%cThe `value` property of a `<select multiple>` element should be an array, but it received a non-array value. The selection will be kept as is.\nhttps://svelte.dev/e/select_multiple_invalid_value",Es,Ss)}function fs(e){console.warn(`%c[svelte] state_proxy_equality_mismatch
%cReactive \`$state(...)\` proxies and the values they proxy have different identities. Because of this, comparisons with \`${e}\` will produce unexpected results
https://svelte.dev/e/state_proxy_equality_mismatch`,Es,Ss)}function Do(){console.warn("%c[svelte] svelte_boundary_reset_noop\n%cA `<svelte:boundary>` `reset` function only resets the boundary the first time it is called\nhttps://svelte.dev/e/svelte_boundary_reset_noop",Es,Ss)}function vn(e){return e===this.v}function Io(e,r){return e!=e?r==r:e!==r||e!==null&&typeof e=="object"||typeof e=="function"}function un(e){return!Io(e,this.v)}let Mo=!1;var Fo="font-weight: bold",Uo="font-weight: normal";function Di(e){console.warn(`%c[svelte] state_snapshot_uncloneable
%c${e?`The following properties cannot be cloned with \`$state.snapshot\` — the return value contains the originals:

${e}`:"Value cannot be cloned with `$state.snapshot` — the original value was returned"}
https://svelte.dev/e/state_snapshot_uncloneable`,Fo,Uo)}const zo=[];function Bo(e,r=!1,a=!1){if(!r){const n=[],o=ps(e,new Map,"",n,null,a);if(n.length===1&&n[0]==="")Di();else if(n.length>0){const l=n.length>10?n.slice(0,7):n.slice(0,10),p=n.length-l.length;let m=l.map(b=>`- <value>${b}`).join(`
`);p>0&&(m+=`
- ...and ${p} more`),Di(m)}return o}return ps(e,new Map,"",zo,null,a)}function ps(e,r,a,n,o=null,l=!1){if(typeof e=="object"&&e!==null){var p=r.get(e);if(p!==void 0)return p;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(Ws(e)){var m=Array(e.length);r.set(e,m),o!==null&&r.set(o,m);for(var b=0;b<e.length;b+=1){var C=e[b];b in e&&(m[b]=ps(C,r,`${a}[${b}]`,n,null,l))}return m}if(gi(e)===rn){m={},r.set(e,m),o!==null&&r.set(o,m);for(var y in e)m[y]=ps(e[y],r,`${a}.${y}`,n,null,l);return m}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function"&&!l)return ps(e.toJSON(),r,`${a}.toJSON()`,n,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return n.push(a),e}}function $(e,r){return e.label=r,is(e.v,r),e}function is(e,r){var a;return(a=e==null?void 0:e[ln])==null||a.call(e,r),e}function Go(e){const r=new Error,a=qo();return a.length===0?null:(a.unshift(`
`),Ia(r,"stack",{value:a.join(`
`)}),Ia(r,"name",{value:e}),r)}function qo(){const e=Error.stackTraceLimit;Error.stackTraceLimit=1/0;const r=new Error().stack;if(Error.stackTraceLimit=e,!r)return[];const a=r.split(`
`),n=[];for(let o=0;o<a.length;o++){const l=a[o],p=l.replaceAll("\\","/");if(l.trim()!=="Error"){if(l.includes("validate_each_keys"))return[];p.includes("svelte/src/internal")||p.includes("node_modules/.vite")||n.push(l)}}return n}let Xt=null;function Za(e){Xt=e}let aa=null;function zs(e){aa=e}function x(e,r,a,n,o,l){const p=aa;aa={type:r,file:a[c],line:n,column:o,parent:p,...l};try{return e()}finally{aa=p}}let xa=null;function Ii(e){xa=e}function Gt(e,r=!1,a){Xt={p:Xt,i:!1,c:null,e:null,s:e,x:null,l:null},Xt.function=a,xa=a}function qt(e){var r=Xt,a=r.e;if(a!==null){r.e=null;for(var n of a)Ln(n)}return e!==void 0&&(r.x=e),r.i=!0,Xt=r.p,xa=(Xt==null?void 0:Xt.function)??null,e??{}}function fn(){return!0}let $a=[];function pn(){var e=$a;$a=[],io(e)}function Yr(e){if($a.length===0&&!xs){var r=$a;queueMicrotask(()=>{r===$a&&pn()})}$a.push(e)}function Ko(){for(;$a.length>0;)pn()}const oi=new WeakMap;function xn(e){var r=$t;if(r===null)return _t.f|=pa,e;if(e instanceof Error&&!oi.has(e)&&oi.set(e,Vo(e,r)),(r.f&$s)===0&&(r.f&bs)===0)throw!r.parent&&e instanceof Error&&mn(e),e;Xa(e,r)}function Xa(e,r){for(;r!==null;){if((r.f&nn)!==0){if((r.f&$s)===0)throw e;try{r.b.error(e);return}catch(a){e=a}}r=r.parent}throw e instanceof Error&&mn(e),e}function Vo(e,r){var p,m,b;const a=Ga(e,"message");if(!(a&&!a.configurable)){for(var n=Ti?"  ":"	",o=`
${n}in ${((p=r.fn)==null?void 0:p.name)||"<unknown>"}`,l=r.ctx;l!==null;)o+=`
${n}in ${(m=l.function)==null?void 0:m[c].split("/").pop()}`,l=l.p;return{message:e.message+`
${o}
`,stack:(b=e.stack)==null?void 0:b.split(`
`).filter(C=>!C.includes("svelte/src/internal")).join(`
`)}}}function mn(e){const r=oi.get(e);r&&(Ia(e,"message",{value:r.message}),Ia(e,"stack",{value:r.stack}))}const Wo=-7169;function Jt(e,r){e.f=e.f&Wo|r}function hi(e){(e.f&Or)!==0||e.deps===null?Jt(e,ir):Jt(e,zr)}function _n(e){if(e!==null)for(const r of e)(r.f&vr)===0||(r.f&Ma)===0||(r.f^=Ma,_n(r.deps))}function bn(e,r,a){(e.f&ur)!==0?r.add(e):(e.f&zr)!==0&&a.add(e),_n(e.deps),Jt(e,ir)}const Os=new Set;let vt=null,Bs=null,dr=null,br=[],Qs=null,li=!1,xs=!1;var qa,Ka,Sa,Va,ys,ws,Ca,ea,Wa,Xr,di,ci,gn;const ji=class ji{constructor(){pt(this,Xr);Gr(this,"committed",!1);Gr(this,"current",new Map);Gr(this,"previous",new Map);pt(this,qa,new Set);pt(this,Ka,new Set);pt(this,Sa,0);pt(this,Va,0);pt(this,ys,null);pt(this,ws,new Set);pt(this,Ca,new Set);pt(this,ea,new Map);Gr(this,"is_fork",!1);pt(this,Wa,!1)}is_deferred(){return this.is_fork||G(this,Va)>0}skip_effect(r){G(this,ea).has(r)||G(this,ea).set(r,{d:[],m:[]})}unskip_effect(r){var a=G(this,ea).get(r);if(a){G(this,ea).delete(r);for(var n of a.d)Jt(n,ur),Dr(n);for(n of a.m)Jt(n,zr),Dr(n)}}process(r){var o;br=[],this.apply();var a=[],n=[];for(const l of r)xr(this,Xr,di).call(this,l,a,n);if(this.is_deferred()){xr(this,Xr,ci).call(this,n),xr(this,Xr,ci).call(this,a);for(const[l,p]of G(this,ea))kn(l,p)}else{for(const l of G(this,qa))l();G(this,qa).clear(),G(this,Sa)===0&&xr(this,Xr,gn).call(this),Bs=this,vt=null,Mi(n),Mi(a),Bs=null,(o=G(this,ys))==null||o.resolve()}dr=null}capture(r,a){a!==lr&&!this.previous.has(r)&&this.previous.set(r,a),(r.f&pa)===0&&(this.current.set(r,r.v),dr==null||dr.set(r,r.v))}activate(){vt=this,this.apply()}deactivate(){vt===this&&(vt=null,dr=null)}flush(){if(this.activate(),br.length>0){if(hn(),vt!==null&&vt!==this)return}else G(this,Sa)===0&&this.process([]);this.deactivate()}discard(){for(const r of G(this,Ka))r(this);G(this,Ka).clear()}increment(r){ut(this,Sa,G(this,Sa)+1),r&&ut(this,Va,G(this,Va)+1)}decrement(r){ut(this,Sa,G(this,Sa)-1),r&&ut(this,Va,G(this,Va)-1),!G(this,Wa)&&(ut(this,Wa,!0),Yr(()=>{ut(this,Wa,!1),this.is_deferred()?br.length>0&&this.flush():this.revive()}))}revive(){for(const r of G(this,ws))G(this,Ca).delete(r),Jt(r,ur),Dr(r);for(const r of G(this,Ca))Jt(r,zr),Dr(r);this.flush()}oncommit(r){G(this,qa).add(r)}ondiscard(r){G(this,Ka).add(r)}settled(){return(G(this,ys)??ut(this,ys,an())).promise}static ensure(){if(vt===null){const r=vt=new ji;Os.add(vt),xs||Yr(()=>{vt===r&&r.flush()})}return vt}apply(){}};qa=new WeakMap,Ka=new WeakMap,Sa=new WeakMap,Va=new WeakMap,ys=new WeakMap,ws=new WeakMap,Ca=new WeakMap,ea=new WeakMap,Wa=new WeakMap,Xr=new WeakSet,di=function(r,a,n){r.f^=ir;for(var o=r.first,l=null;o!==null;){var p=o.f,m=(p&(Br|za))!==0,b=m&&(p&ir)!==0,C=b||(p&kr)!==0||G(this,ea).has(o);if(!C&&o.fn!==null){m?o.f^=ir:l!==null&&(p&(bs|Js|sn))!==0?l.b.defer_effect(o):(p&bs)!==0?a.push(o):As(o)&&((p&na)!==0&&G(this,Ca).add(o),rs(o));var y=o.first;if(y!==null){o=y;continue}}var w=o.parent;for(o=o.next;o===null&&w!==null;)w===l&&(l=null),o=w.next,w=w.parent}},ci=function(r){for(var a=0;a<r.length;a+=1)bn(r[a],G(this,ws),G(this,Ca))},gn=function(){var o;if(Os.size>1){this.previous.clear();var r=dr,a=!0;for(const l of Os){if(l===this){a=!1;continue}const p=[];for(const[b,C]of this.current){if(l.current.has(b))if(a&&C!==l.current.get(b))l.current.set(b,C);else continue;p.push(b)}if(p.length===0)continue;const m=[...l.current.keys()].filter(b=>!this.current.has(b));if(m.length>0){var n=br;br=[];const b=new Set,C=new Map;for(const y of p)yn(y,m,b,C);if(br.length>0){vt=l,l.apply();for(const y of br)xr(o=l,Xr,di).call(o,y,[],[]);l.deactivate()}br=n}}vt=null,dr=r}this.committed=!0,Os.delete(this)};let ma=ji;function Ho(e){var r=xs;xs=!0;try{for(var a;;){if(Ko(),br.length===0&&(vt==null||vt.flush(),br.length===0))return Qs=null,a;hn()}}finally{xs=r}}function hn(){li=!0;var e=new Set;try{for(var r=0;br.length>0;){var a=ma.ensure();if(r++>1e3){var n=new Map;for(const l of a.current.keys())for(const[p,m]of l.updated??[]){var o=n.get(p);o||(o={error:m.error,count:0},n.set(p,o)),o.count+=m.count}for(const l of n.values())l.error&&console.error(l.error);Jo()}a.process(br),_a.clear();for(const l of a.current.keys())e.add(l)}}finally{br=[],li=!1,Qs=null;for(const l of e)l.updated=null}}function Jo(){try{yo()}catch(e){Ia(e,"stack",{value:""}),Xa(e,Qs)}}let Rr=null;function Mi(e){var r=e.length;if(r!==0){for(var a=0;a<r;){var n=e[a++];if((n.f&(fa|kr))===0&&As(n)&&(Rr=new Set,rs(n),n.deps===null&&n.first===null&&n.nodes===null&&n.teardown===null&&n.ac===null&&Dn(n),(Rr==null?void 0:Rr.size)>0)){_a.clear();for(const o of Rr){if((o.f&(fa|kr))!==0)continue;const l=[o];let p=o.parent;for(;p!==null;)Rr.has(p)&&(Rr.delete(p),l.push(p)),p=p.parent;for(let m=l.length-1;m>=0;m--){const b=l[m];(b.f&(fa|kr))===0&&rs(b)}}Rr.clear()}}Rr=null}}function yn(e,r,a,n){if(!a.has(e)&&(a.add(e),e.reactions!==null))for(const o of e.reactions){const l=o.f;(l&vr)!==0?yn(o,r,a,n):(l&(Ys|na))!==0&&(l&ur)===0&&wn(o,r,n)&&(Jt(o,ur),Dr(o))}}function wn(e,r,a){const n=a.get(e);if(n!==void 0)return n;if(e.deps!==null)for(const o of e.deps){if(Da.call(r,o))return!0;if((o.f&vr)!==0&&wn(o,r,a))return a.set(o,!0),!0}return a.set(e,!1),!1}function Dr(e){for(var r=Qs=e;r.parent!==null;){r=r.parent;var a=r.f;if(li&&r===$t&&(a&na)!==0&&(a&on)===0)return;if((a&(za|Br))!==0){if((a&ir)===0)return;r.f^=ir}}br.push(r)}function kn(e,r){if(!((e.f&Br)!==0&&(e.f&ir)!==0)){(e.f&ur)!==0?r.d.push(e):(e.f&zr)!==0&&r.m.push(e),Jt(e,ir);for(var a=e.first;a!==null;)kn(a,r),a=a.next}}function Yo(e){let r=0,a=Fa(0),n;return $(a,"createSubscriber version"),()=>{$i()&&(t(a),gs(()=>(r===0&&(n=ns(()=>e(()=>ms(a)))),r+=1,()=>{Yr(()=>{r-=1,r===0&&(n==null||n(),n=void 0,ms(a))})})))}}var Qo=Qa|ss|nn;function Zo(e,r,a){new Xo(e,r,a)}var Cr,bi,qr,Aa,Kr,Ar,_r,Vr,ta,ca,Pa,va,Ha,Oa,Ja,Ya,Wr,Ks,nr,el,tl,vi,Ns,Ds,ui;class Xo{constructor(r,a,n){pt(this,nr);Gr(this,"parent");Gr(this,"is_pending",!1);pt(this,Cr);pt(this,bi,null);pt(this,qr);pt(this,Aa);pt(this,Kr);pt(this,Ar,null);pt(this,_r,null);pt(this,Vr,null);pt(this,ta,null);pt(this,ca,null);pt(this,Pa,0);pt(this,va,0);pt(this,Ha,!1);pt(this,Oa,!1);pt(this,Ja,new Set);pt(this,Ya,new Set);pt(this,Wr,null);pt(this,Ks,Yo(()=>(ut(this,Wr,Fa(G(this,Pa))),$(G(this,Wr),"$effect.pending()"),()=>{ut(this,Wr,null)})));ut(this,Cr,r),ut(this,qr,a),ut(this,Aa,n),this.parent=$t.b,this.is_pending=!!G(this,qr).pending,ut(this,Kr,Si(()=>{$t.b=this;{var o=xr(this,nr,vi).call(this);try{ut(this,Ar,Pr(()=>n(o)))}catch(l){this.error(l)}G(this,va)>0?xr(this,nr,Ds).call(this):this.is_pending=!1}return()=>{var l;(l=G(this,ca))==null||l.remove()}},Qo))}defer_effect(r){bn(r,G(this,Ja),G(this,Ya))}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!G(this,qr).pending}update_pending_count(r){xr(this,nr,ui).call(this,r),ut(this,Pa,G(this,Pa)+r),!(!G(this,Wr)||G(this,Ha))&&(ut(this,Ha,!0),Yr(()=>{ut(this,Ha,!1),G(this,Wr)&&ts(G(this,Wr),G(this,Pa))}))}get_effect_pending(){return G(this,Ks).call(this),t(G(this,Wr))}error(r){var a=G(this,qr).onerror;let n=G(this,qr).failed;if(G(this,Oa)||!a&&!n)throw r;G(this,Ar)&&(hr(G(this,Ar)),ut(this,Ar,null)),G(this,_r)&&(hr(G(this,_r)),ut(this,_r,null)),G(this,Vr)&&(hr(G(this,Vr)),ut(this,Vr,null));var o=!1,l=!1;const p=()=>{if(o){Do();return}o=!0,l&&Eo(),ma.ensure(),ut(this,Pa,0),G(this,Vr)!==null&&Ra(G(this,Vr),()=>{ut(this,Vr,null)}),this.is_pending=this.has_pending_snippet(),ut(this,Ar,xr(this,nr,Ns).call(this,()=>(ut(this,Oa,!1),Pr(()=>G(this,Aa).call(this,G(this,Cr)))))),G(this,va)>0?xr(this,nr,Ds).call(this):this.is_pending=!1};Yr(()=>{try{l=!0,a==null||a(r,p),l=!1}catch(m){Xa(m,G(this,Kr)&&G(this,Kr).parent)}n&&ut(this,Vr,xr(this,nr,Ns).call(this,()=>{ma.ensure(),ut(this,Oa,!0);try{return Pr(()=>{n(G(this,Cr),()=>r,()=>p)})}catch(m){return Xa(m,G(this,Kr).parent),null}finally{ut(this,Oa,!1)}}))})}}Cr=new WeakMap,bi=new WeakMap,qr=new WeakMap,Aa=new WeakMap,Kr=new WeakMap,Ar=new WeakMap,_r=new WeakMap,Vr=new WeakMap,ta=new WeakMap,ca=new WeakMap,Pa=new WeakMap,va=new WeakMap,Ha=new WeakMap,Oa=new WeakMap,Ja=new WeakMap,Ya=new WeakMap,Wr=new WeakMap,Ks=new WeakMap,nr=new WeakSet,el=function(){try{ut(this,Ar,Pr(()=>G(this,Aa).call(this,G(this,Cr))))}catch(r){this.error(r)}},tl=function(){const r=G(this,qr).pending;r&&(ut(this,_r,Pr(()=>r(G(this,Cr)))),Yr(()=>{var a=xr(this,nr,vi).call(this);ut(this,Ar,xr(this,nr,Ns).call(this,()=>(ma.ensure(),Pr(()=>G(this,Aa).call(this,a))))),G(this,va)>0?xr(this,nr,Ds).call(this):(Ra(G(this,_r),()=>{ut(this,_r,null)}),this.is_pending=!1)}))},vi=function(){var r=G(this,Cr);return this.is_pending&&(ut(this,ca,ia()),G(this,Cr).before(G(this,ca)),r=G(this,ca)),r},Ns=function(r){var a=$t,n=_t,o=Xt;Zr(G(this,Kr)),Lr(G(this,Kr)),Za(G(this,Kr).ctx);try{return r()}catch(l){return xn(l),null}finally{Zr(a),Lr(n),Za(o)}},Ds=function(){const r=G(this,qr).pending;G(this,Ar)!==null&&(ut(this,ta,document.createDocumentFragment()),G(this,ta).append(G(this,ca)),Fn(G(this,Ar),G(this,ta))),G(this,_r)===null&&ut(this,_r,Pr(()=>r(G(this,Cr))))},ui=function(r){var a;if(!this.has_pending_snippet()){this.parent&&xr(a=this.parent,nr,ui).call(a,r);return}if(ut(this,va,G(this,va)+r),G(this,va)===0){this.is_pending=!1;for(const n of G(this,Ja))Jt(n,ur),Dr(n);for(const n of G(this,Ya))Jt(n,zr),Dr(n);G(this,Ja).clear(),G(this,Ya).clear(),G(this,_r)&&Ra(G(this,_r),()=>{ut(this,_r,null)}),G(this,ta)&&(G(this,Cr).before(G(this,ta)),ut(this,ta,null))}};function Tn(e,r,a,n){const o=yi;var l=e.filter(h=>!h.settled);if(a.length===0&&l.length===0){n(r.map(o));return}var p=vt,m=$t,b=al(),C=l.length===1?l[0].promise:l.length>1?Promise.all(l.map(h=>h.promise)):null;function y(h){b();try{n(h)}catch(D){(m.f&fa)===0&&Xa(D,m)}p==null||p.deactivate(),fi()}if(a.length===0){C.then(()=>y(r.map(o)));return}function w(){b(),Promise.all(a.map(h=>il(h))).then(h=>y([...r.map(o),...h])).catch(h=>Xa(h,m))}C?C.then(w):w()}function rl(e,r){Tn(e,[],[],r)}function al(){var e=$t,r=_t,a=Xt,n=vt,o=aa;return function(p=!0){Zr(e),Lr(r),Za(a),p&&(n==null||n.activate()),zs(o)}}async function N(e){var r=await e;return()=>r}function fi(){Zr(null),Lr(null),Za(null),zs(null)}const sl=new Set;function yi(e){var r=vr|ur,a=_t!==null&&(_t.f&vr)!==0?_t:null;return $t!==null&&($t.f|=ss),{ctx:Xt,deps:null,effects:null,equals:vn,f:r,fn:e,reactions:null,rv:0,v:lr,wv:0,parent:a??$t,ac:null}}function il(e,r,a){let n=$t;n===null&&fo();var o=n.b,l=void 0,p=Fa(lr);p.label=r;var m=!_t,b=new Map;return Tl(()=>{var D;var C=an();l=C.promise;try{Promise.resolve(e()).then(C.resolve,C.reject).then(()=>{y===vt&&y.committed&&y.deactivate(),fi()})}catch(I){C.reject(I),fi()}var y=vt;if(m){var w=o.is_rendered();o.update_pending_count(1),y.increment(w),(D=b.get(y))==null||D.reject(Ta),b.delete(y),b.set(y,C)}const h=(I,Y=void 0)=>{if(y.activate(),Y)Y!==Ta&&(p.f|=pa,ts(p,Y));else{(p.f&pa)!==0&&(p.f^=pa),ts(p,I);for(const[j,z]of b){if(b.delete(j),j===y)break;z.reject(Ta)}}m&&(o.update_pending_count(-1),y.decrement(w))};C.promise.then(h,I=>h(null,I||"unknown"))}),Ei(()=>{for(const C of b.values())C.reject(Ta)}),p.f|=Ys,new Promise(C=>{function y(w){function h(){w===l?C(p):y(l)}w.then(h,h)}y(l)})}function cr(e){const r=yi(e);return Un(r),r}function nl(e){const r=yi(e);return r.equals=un,r}function ol(e){var r=e.effects;if(r!==null){e.effects=null;for(var a=0;a<r.length;a+=1)hr(r[a])}}let ri=[];function ll(e){for(var r=e.parent;r!==null;){if((r.f&vr)===0)return(r.f&fa)===0?r:null;r=r.parent}return null}function wi(e){var r,a=$t;Zr(ll(e));{let n=es;Fi(new Set);try{Da.call(ri,e)&&mo(),ri.push(e),e.f&=~Ma,ol(e),r=qn(e)}finally{Zr(a),Fi(n),ri.pop()}}return r}function $n(e){var r=wi(e);if(!e.equals(r)&&(e.wv=Bn(),(!(vt!=null&&vt.is_fork)||e.deps===null)&&(e.v=r,e.deps===null))){Jt(e,ir);return}Ua||(dr!==null?($i()||vt!=null&&vt.is_fork)&&dr.set(e,r):hi(e))}function dl(e){var r,a;if(e.effects!==null)for(const n of e.effects)(n.teardown||n.ac)&&((r=n.teardown)==null||r.call(n),(a=n.ac)==null||a.abort(Ta),n.teardown=so,n.ac=null,hs(n,0),Ci(n))}function En(e){if(e.effects!==null)for(const r of e.effects)r.teardown&&rs(r)}let es=new Set;const _a=new Map;function Fi(e){es=e}let ki=!1;function cl(){ki=!0}function Fa(e,r){var a={f:0,v:e,reactions:null,equals:vn,rv:0,wv:0};return a}function A(e,r){const a=Fa(e);return Un(a),a}function vl(e,r=!1,a=!0){const n=Fa(e);return r||(n.equals=un),n}function f(e,r,a=!1){_t!==null&&(!Ir||(_t.f&Us)!==0)&&fn()&&(_t.f&(vr|na|Ys|Us))!==0&&(jr===null||!Da.call(jr,e))&&$o();let n=a?ht(r):r;return is(n,e.label),ts(e,n)}function ts(e,r){var o;if(!e.equals(r)){var a=e.v;Ua?_a.set(e,r):_a.set(e,a),e.v=r;var n=ma.ensure();n.capture(e,a);{if($t!==null){e.updated??(e.updated=new Map);const l=(((o=e.updated.get(""))==null?void 0:o.count)??0)+1;if(e.updated.set("",{error:null,count:l}),l>5){const p=Go("updated at");if(p!==null){let m=e.updated.get(p.stack);m||(m={error:p,count:0},e.updated.set(p.stack,m)),m.count++}}}$t!==null&&(e.set_during_effect=!0)}if((e.f&vr)!==0){const l=e;(e.f&ur)!==0&&wi(l),hi(l)}e.wv=Bn(),Cn(e,ur),$t!==null&&($t.f&ir)!==0&&($t.f&(Br|za))===0&&(Sr===null?Sl([e]):Sr.push(e)),!n.is_fork&&es.size>0&&!ki&&Sn()}return r}function Sn(){ki=!1;for(const e of es)(e.f&ir)!==0&&Jt(e,zr),As(e)&&rs(e);es.clear()}function Ui(e,r=1){var a=t(e),n=r===1?a++:a--;return f(e,a),n}function ms(e){f(e,e.v+1)}function Cn(e,r){var a=e.reactions;if(a!==null)for(var n=a.length,o=0;o<n;o++){var l=a[o],p=l.f;if((p&Us)!==0){es.add(l);continue}var m=(p&ur)===0;if(m&&Jt(l,r),(p&vr)!==0){var b=l;dr==null||dr.delete(b),(p&Ma)===0&&(p&Or&&(l.f|=Ma),Cn(b,zr))}else m&&((p&na)!==0&&Rr!==null&&Rr.add(l),Dr(l))}}const ul=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function ht(e){if(typeof e!="object"||e===null||La in e)return e;const r=gi(e);if(r!==rn&&r!==ao)return e;var a=new Map,n=Ws(e),o=A(0),l=Na,p=y=>{if(Na===l)return y();var w=_t,h=Na;Lr(null),Ki(l);var D=y();return Lr(w),Ki(h),D};n&&(a.set("length",A(e.length)),e=xl(e));var m="";let b=!1;function C(y){if(!b){b=!0,m=y,$(o,`${m} version`);for(const[w,h]of a)$(h,ka(m,w));b=!1}}return new Proxy(e,{defineProperty(y,w,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&ko();var D=a.get(w);return D===void 0?p(()=>{var I=A(h.value);return a.set(w,I),typeof w=="string"&&$(I,ka(m,w)),I}):f(D,h.value,!0),!0},deleteProperty(y,w){var h=a.get(w);if(h===void 0){if(w in y){const D=p(()=>A(lr));a.set(w,D),ms(o),$(D,ka(m,w))}}else f(h,lr),ms(o);return!0},get(y,w,h){var j;if(w===La)return e;if(w===ln)return C;var D=a.get(w),I=w in y;if(D===void 0&&(!I||(j=Ga(y,w))!=null&&j.writable)&&(D=p(()=>{var z=ht(I?y[w]:lr),re=A(z);return $(re,ka(m,w)),re}),a.set(w,D)),D!==void 0){var Y=t(D);return Y===lr?void 0:Y}return Reflect.get(y,w,h)},getOwnPropertyDescriptor(y,w){var h=Reflect.getOwnPropertyDescriptor(y,w);if(h&&"value"in h){var D=a.get(w);D&&(h.value=t(D))}else if(h===void 0){var I=a.get(w),Y=I==null?void 0:I.v;if(I!==void 0&&Y!==lr)return{enumerable:!0,configurable:!0,value:Y,writable:!0}}return h},has(y,w){var Y;if(w===La)return!0;var h=a.get(w),D=h!==void 0&&h.v!==lr||Reflect.has(y,w);if(h!==void 0||$t!==null&&(!D||(Y=Ga(y,w))!=null&&Y.writable)){h===void 0&&(h=p(()=>{var j=D?ht(y[w]):lr,z=A(j);return $(z,ka(m,w)),z}),a.set(w,h));var I=t(h);if(I===lr)return!1}return D},set(y,w,h,D){var me;var I=a.get(w),Y=w in y;if(n&&w==="length")for(var j=h;j<I.v;j+=1){var z=a.get(j+"");z!==void 0?f(z,lr):j in y&&(z=p(()=>A(lr)),a.set(j+"",z),$(z,ka(m,j)))}if(I===void 0)(!Y||(me=Ga(y,w))!=null&&me.writable)&&(I=p(()=>A(void 0)),$(I,ka(m,w)),f(I,ht(h)),a.set(w,I));else{Y=I.v!==lr;var re=p(()=>ht(h));f(I,re)}var se=Reflect.getOwnPropertyDescriptor(y,w);if(se!=null&&se.set&&se.set.call(D,h),!Y){if(n&&typeof w=="string"){var be=a.get("length"),Oe=Number(w);Number.isInteger(Oe)&&Oe>=be.v&&f(be,Oe+1)}ms(o)}return!0},ownKeys(y){t(o);var w=Reflect.ownKeys(y).filter(I=>{var Y=a.get(I);return Y===void 0||Y.v!==lr});for(var[h,D]of a)D.v!==lr&&!(h in y)&&w.push(h);return w},setPrototypeOf(){To()}})}function ka(e,r){return typeof r=="symbol"?`${e}[Symbol(${r.description??""})]`:ul.test(r)?`${e}.${r}`:/^\d+$/.test(r)?`${e}[${r}]`:`${e}['${r}']`}function sa(e){try{if(e!==null&&typeof e=="object"&&La in e)return e[La]}catch{}return e}function fl(e,r){return Object.is(sa(e),sa(r))}const pl=new Set(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"]);function xl(e){return new Proxy(e,{get(r,a,n){var o=Reflect.get(r,a,n);return pl.has(a)?function(...l){cl();var p=o.apply(this,l);return Sn(),p}:o}})}function ml(){const e=Array.prototype,r=Array.__svelte_cleanup;r&&r();const{indexOf:a,lastIndexOf:n,includes:o}=e;e.indexOf=function(l,p){const m=a.call(this,l,p);if(m===-1){for(let b=p??0;b<this.length;b+=1)if(sa(this[b])===l){fs("array.indexOf(...)");break}}return m},e.lastIndexOf=function(l,p){const m=n.call(this,l,p??this.length-1);if(m===-1){for(let b=0;b<=(p??this.length-1);b+=1)if(sa(this[b])===l){fs("array.lastIndexOf(...)");break}}return m},e.includes=function(l,p){const m=o.call(this,l,p);if(!m){for(let b=0;b<this.length;b+=1)if(sa(this[b])===l){fs("array.includes(...)");break}}return m},Array.__svelte_cleanup=()=>{e.indexOf=a,e.lastIndexOf=n,e.includes=o}}function O(e,r,a=!0){try{e===r!=(sa(e)===sa(r))&&fs(a?"===":"!==")}catch{}return e===r===a}function zi(e,r,a=!0){return e==r!=(sa(e)==sa(r))&&fs(a?"==":"!="),e==r===a}var Bi,Ti,An,Pn;function _l(){if(Bi===void 0){Bi=window,Ti=/Firefox/.test(navigator.userAgent);var e=Element.prototype,r=Node.prototype,a=Text.prototype;An=Ga(r,"firstChild").get,Pn=Ga(r,"nextSibling").get,Ri(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Ri(a)&&(a.__t=void 0),e.__svelte_meta=null,ml()}}function ia(e=""){return document.createTextNode(e)}function Gs(e){return An.call(e)}function Cs(e){return Pn.call(e)}function s(e,r){return Gs(e)}function We(e,r=!1){{var a=Gs(e);return a instanceof Comment&&a.data===""?Cs(a):a}}function i(e,r=1,a=!1){let n=e;for(;r--;)n=Cs(n);return n}function bl(e){e.textContent=""}function On(){return!1}function gl(e,r,a){return document.createElementNS(cn,e,void 0)}function js(e,r){if(r){const a=document.body;e.autofocus=!0,Yr(()=>{document.activeElement===a&&e.focus()})}}let Gi=!1;function hl(){Gi||(Gi=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{var r;if(!e.defaultPrevented)for(const a of e.target.elements)(r=a.__on_r)==null||r.call(a)})},{capture:!0}))}function Zs(e){var r=_t,a=$t;Lr(null),Zr(null);try{return e()}finally{Lr(r),Zr(a)}}function jn(e,r,a,n=a){e.addEventListener(r,()=>Zs(a));const o=e.__on_r;o?e.__on_r=()=>{o(),n(!0)}:e.__on_r=()=>n(!0),hl()}function yl(e){$t===null&&(_t===null&&ho(e),go()),Ua&&bo(e)}function wl(e,r){var a=r.last;a===null?r.last=r.first=e:(a.next=e,e.prev=a,r.last=e)}function oa(e,r,a){for(var n=$t;n!==null&&(n.f&Us)!==0;)n=n.parent;n!==null&&(n.f&kr)!==0&&(e|=kr);var o={ctx:Xt,deps:null,nodes:null,f:e|ur|Or,first:null,fn:r,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,wv:0,ac:null};if(o.component_function=xa,a)try{rs(o)}catch(m){throw hr(o),m}else r!==null&&Dr(o);var l=o;if(a&&l.deps===null&&l.teardown===null&&l.nodes===null&&l.first===l.last&&(l.f&ss)===0&&(l=l.first,(e&na)!==0&&(e&Qa)!==0&&l!==null&&(l.f|=Qa)),l!==null&&(l.parent=n,n!==null&&wl(l,n),_t!==null&&(_t.f&vr)!==0&&(e&za)===0)){var p=_t;(p.effects??(p.effects=[])).push(l)}return o}function $i(){return _t!==null&&!Ir}function Ei(e){const r=oa(Js,null,!1);return Jt(r,ir),r.teardown=e,r}function fr(e){yl("$effect"),Ia(e,"name",{value:"$effect"});var r=$t.f,a=!_t&&(r&Br)!==0&&(r&$s)===0;if(a){var n=Xt;(n.e??(n.e=[])).push(e)}else return Ln(e)}function Ln(e){return oa(bs|oo,e,!1)}function kl(e){ma.ensure();const r=oa(za|ss,e,!0);return(a={})=>new Promise(n=>{a.outro?Ra(r,()=>{hr(r),n(void 0)}):(hr(r),n(void 0))})}function Rn(e){return oa(bs,e,!1)}function Tl(e){return oa(Ys|ss,e,!0)}function gs(e,r=0){return oa(Js|r,e,!0)}function S(e,r=[],a=[],n=[]){Tn(n,r,a,o=>{oa(Js,()=>e(...o.map(t)),!0)})}function Si(e,r=0){var a=oa(na|r,e,!0);return a.dev_stack=aa,a}function Pr(e){return oa(Br|ss,e,!0)}function Nn(e){var r=e.teardown;if(r!==null){const a=Ua,n=_t;qi(!0),Lr(null);try{r.call(null)}finally{qi(a),Lr(n)}}}function Ci(e,r=!1){var a=e.first;for(e.first=e.last=null;a!==null;){const o=a.ac;o!==null&&Zs(()=>{o.abort(Ta)});var n=a.next;(a.f&za)!==0?a.parent=null:hr(a,r),a=n}}function $l(e){for(var r=e.first;r!==null;){var a=r.next;(r.f&Br)===0&&hr(r),r=a}}function hr(e,r=!0){var a=!1;(r||(e.f&on)!==0)&&e.nodes!==null&&e.nodes.end!==null&&(El(e.nodes.start,e.nodes.end),a=!0),Ci(e,r&&!a),hs(e,0),Jt(e,fa);var n=e.nodes&&e.nodes.t;if(n!==null)for(const l of n)l.stop();Nn(e);var o=e.parent;o!==null&&o.first!==null&&Dn(e),e.component_function=null,e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes=e.ac=null}function El(e,r){for(;e!==null;){var a=e===r?null:Cs(e);e.remove(),e=a}}function Dn(e){var r=e.parent,a=e.prev,n=e.next;a!==null&&(a.next=n),n!==null&&(n.prev=a),r!==null&&(r.first===e&&(r.first=n),r.last===e&&(r.last=a))}function Ra(e,r,a=!0){var n=[];In(e,n,!0);var o=()=>{a&&hr(e),r&&r()},l=n.length;if(l>0){var p=()=>--l||o();for(var m of n)m.out(p)}else o()}function In(e,r,a){if((e.f&kr)===0){e.f^=kr;var n=e.nodes&&e.nodes.t;if(n!==null)for(const m of n)(m.is_global||a)&&r.push(m);for(var o=e.first;o!==null;){var l=o.next,p=(o.f&Qa)!==0||(o.f&Br)!==0&&(e.f&na)!==0;In(o,r,p?a:!1),o=l}}}function Ai(e){Mn(e,!0)}function Mn(e,r){if((e.f&kr)!==0){e.f^=kr,(e.f&ir)===0&&(Jt(e,ur),Dr(e));for(var a=e.first;a!==null;){var n=a.next,o=(a.f&Qa)!==0||(a.f&Br)!==0;Mn(a,o?r:!1),a=n}var l=e.nodes&&e.nodes.t;if(l!==null)for(const p of l)(p.is_global||r)&&p.in()}}function Fn(e,r){if(e.nodes)for(var a=e.nodes.start,n=e.nodes.end;a!==null;){var o=a===n?null:Cs(a);r.append(a),a=o}}let Is=!1,Ua=!1;function qi(e){Ua=e}let _t=null,Ir=!1;function Lr(e){_t=e}let $t=null;function Zr(e){$t=e}let jr=null;function Un(e){_t!==null&&(jr===null?jr=[e]:jr.push(e))}let gr=null,yr=0,Sr=null;function Sl(e){Sr=e}let zn=1,Ea=0,Na=Ea;function Ki(e){Na=e}function Bn(){return++zn}function As(e){var r=e.f;if((r&ur)!==0)return!0;if(r&vr&&(e.f&=~Ma),(r&zr)!==0){for(var a=e.deps,n=a.length,o=0;o<n;o++){var l=a[o];if(As(l)&&$n(l),l.wv>e.wv)return!0}(r&Or)!==0&&dr===null&&Jt(e,ir)}return!1}function Gn(e,r,a=!0){var n=e.reactions;if(n!==null&&!(jr!==null&&Da.call(jr,e)))for(var o=0;o<n.length;o++){var l=n[o];(l.f&vr)!==0?Gn(l,r,!1):r===l&&(a?Jt(l,ur):(l.f&ir)!==0&&Jt(l,zr),Dr(l))}}function qn(e){var Y;var r=gr,a=yr,n=Sr,o=_t,l=jr,p=Xt,m=Ir,b=Na,C=e.f;gr=null,yr=0,Sr=null,_t=(C&(Br|za))===0?e:null,jr=null,Za(e.ctx),Ir=!1,Na=++Ea,e.ac!==null&&(Zs(()=>{e.ac.abort(Ta)}),e.ac=null);try{e.f|=ni;var y=e.fn,w=y();e.f|=$s;var h=e.deps,D=vt==null?void 0:vt.is_fork;if(gr!==null){var I;if(D||hs(e,yr),h!==null&&yr>0)for(h.length=yr+gr.length,I=0;I<gr.length;I++)h[yr+I]=gr[I];else e.deps=h=gr;if($i()&&(e.f&Or)!==0)for(I=yr;I<h.length;I++)((Y=h[I]).reactions??(Y.reactions=[])).push(e)}else!D&&h!==null&&yr<h.length&&(hs(e,yr),h.length=yr);if(fn()&&Sr!==null&&!Ir&&h!==null&&(e.f&(vr|zr|ur))===0)for(I=0;I<Sr.length;I++)Gn(Sr[I],e);if(o!==null&&o!==e){if(Ea++,o.deps!==null)for(let j=0;j<a;j+=1)o.deps[j].rv=Ea;if(r!==null)for(const j of r)j.rv=Ea;Sr!==null&&(n===null?n=Sr:n.push(...Sr))}return(e.f&pa)!==0&&(e.f^=pa),w}catch(j){return xn(j)}finally{e.f^=ni,gr=r,yr=a,Sr=n,_t=o,jr=l,Za(p),Ir=m,Na=b}}function Cl(e,r){let a=r.reactions;if(a!==null){var n=to.call(a,e);if(n!==-1){var o=a.length-1;o===0?a=r.reactions=null:(a[n]=a[o],a.pop())}}if(a===null&&(r.f&vr)!==0&&(gr===null||!Da.call(gr,r))){var l=r;(l.f&Or)!==0&&(l.f^=Or,l.f&=~Ma),hi(l),dl(l),hs(l,0)}}function hs(e,r){var a=e.deps;if(a!==null)for(var n=r;n<a.length;n++)Cl(e,a[n])}function rs(e){var r=e.f;if((r&fa)===0){Jt(e,ir);var a=$t,n=Is;$t=e,Is=!0;{var o=xa;Ii(e.component_function);var l=aa;zs(e.dev_stack??aa)}try{(r&(na|sn))!==0?$l(e):Ci(e),Nn(e);var p=qn(e);e.teardown=typeof p=="function"?p:null,e.wv=zn;var m;Mo&&(e.f&ur)!==0&&e.deps}finally{Is=n,$t=a,Ii(o),zs(l)}}}async function Ms(){await Promise.resolve(),Ho()}function t(e){var r=e.f,a=(r&vr)!==0;if(_t!==null&&!Ir){var n=$t!==null&&($t.f&fa)!==0;if(!n&&(jr===null||!Da.call(jr,e))){var o=_t.deps;if((_t.f&ni)!==0)e.rv<Ea&&(e.rv=Ea,gr===null&&o!==null&&o[yr]===e?yr++:gr===null?gr=[e]:gr.push(e));else{(_t.deps??(_t.deps=[])).push(e);var l=e.reactions;l===null?e.reactions=[_t]:Da.call(l,_t)||l.push(_t)}}}if(sl.delete(e),Ua&&_a.has(e))return _a.get(e);if(a){var p=e;if(Ua){var m=p.v;return((p.f&ir)===0&&p.reactions!==null||Vn(p))&&(m=wi(p)),_a.set(p,m),m}var b=(p.f&Or)===0&&!Ir&&_t!==null&&(Is||(_t.f&Or)!==0),C=(p.f&$s)===0;As(p)&&(b&&(p.f|=Or),$n(p)),b&&!C&&(En(p),Kn(p))}if(dr!=null&&dr.has(e))return dr.get(e);if((e.f&pa)!==0)throw e.v;return e.v}function Kn(e){if(e.f|=Or,e.deps!==null)for(const r of e.deps)(r.reactions??(r.reactions=[])).push(e),(r.f&vr)!==0&&(r.f&Or)===0&&(En(r),Kn(r))}function Vn(e){if(e.v===lr)return!0;if(e.deps===null)return!1;for(const r of e.deps)if(_a.has(r)||(r.f&vr)!==0&&Vn(r))return!0;return!1}function ns(e){var r=Ir;try{return Ir=!0,e()}finally{Ir=r}}const Al=["touchstart","touchmove"];function Pl(e){return Al.includes(e)}function v(e,r,a){return(...n)=>{const o=e(...n);var l=o.nodeType===vo?o.firstChild:o;return Wn(l,r,a),o}}function Ol(e,r,a){e.__svelte_meta={parent:aa,loc:{file:r,line:a[0],column:a[1]}},a[2]&&Wn(e.firstChild,r,a[2])}function Wn(e,r,a){for(var n=0;e&&n<a.length;)e.nodeType===co&&Ol(e,r,a[n++]),e=e.nextSibling}const Fs=Symbol("events"),Hn=new Set,pi=new Set;function jl(e,r,a,n={}){function o(l){if(n.capture||xi.call(r,l),!l.cancelBubble)return Zs(()=>a==null?void 0:a.call(this,l))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Yr(()=>{r.addEventListener(e,o,n)}):r.addEventListener(e,o,n),o}function Ll(e,r,a,n,o){var l={capture:n,passive:o},p=jl(e,r,a,l);(r===document.body||r===window||r===document||r instanceof HTMLMediaElement)&&Ei(()=>{r.removeEventListener(e,p,l)})}function X(e,r,a){(r[Fs]??(r[Fs]={}))[e]=a}function ar(e){for(var r=0;r<e.length;r++)Hn.add(e[r]);for(var a of pi)a(e)}let Vi=null;function xi(e){var j,z;var r=this,a=r.ownerDocument,n=e.type,o=((j=e.composedPath)==null?void 0:j.call(e))||[],l=o[0]||e.target;Vi=e;var p=0,m=Vi===e&&e.__root;if(m){var b=o.indexOf(m);if(b!==-1&&(r===document||r===window)){e.__root=r;return}var C=o.indexOf(r);if(C===-1)return;b<=C&&(p=b)}if(l=o[p]||e.target,l!==r){Ia(e,"currentTarget",{configurable:!0,get(){return l||a}});var y=_t,w=$t;Lr(null),Zr(null);try{for(var h,D=[];l!==null;){var I=l.assignedSlot||l.parentNode||l.host||null;try{var Y=(z=l[Fs])==null?void 0:z[n];Y!=null&&(!l.disabled||e.target===l)&&Y.call(l,e)}catch(re){h?D.push(re):h=re}if(e.cancelBubble||I===r||I===null)break;l=I}if(h){for(let re of D)queueMicrotask(()=>{throw re});throw h}}finally{e.__root=r,delete e.currentTarget,Lr(y),Zr(w)}}}var Xi,en;const ai=(en=(Xi=globalThis==null?void 0:globalThis.window)==null?void 0:Xi.trustedTypes)==null?void 0:en.createPolicy("svelte-trusted-html",{createHTML:e=>e});function Rl(e){return(ai==null?void 0:ai.createHTML(e))??e}function Nl(e,r=!1){var a=gl("template");return e=e.replaceAll("<!>","<!---->"),a.innerHTML=r?Rl(e):e,a.content}function qs(e,r){var a=$t;a.nodes===null&&(a.nodes={start:e,end:r,a:null,t:null})}function u(e,r){var a=(r&Oo)!==0,n=(r&jo)!==0,o,l=!e.startsWith("<!>");return()=>{o===void 0&&(o=Nl(l?e:"<!>"+e,!0),a||(o=Gs(o)));var p=n||Ti?document.importNode(o,!0):o.cloneNode(!0);if(a){var m=Gs(p),b=p.lastChild;qs(m,b)}else qs(p,p);return p}}function ua(e=""){{var r=ia(e+"");return qs(r,r),r}}function er(){var e=document.createDocumentFragment(),r=document.createComment(""),a=ia();return e.append(r,a),qs(r,a),e}function d(e,r){e!==null&&e.before(r)}function _(e,r){var a=r==null?"":typeof r=="object"?r+"":r;a!==(e.__t??(e.__t=e.nodeValue))&&(e.__t=a,e.nodeValue=a+"")}function Dl(e,r){return Il(e,r)}const Ls=new Map;function Il(e,{target:r,anchor:a,props:n={},events:o,context:l,intro:p=!0}){_l();var m=new Set,b=w=>{for(var h=0;h<w.length;h++){var D=w[h];if(!m.has(D)){m.add(D);var I=Pl(D);for(const z of[r,document]){var Y=Ls.get(z);Y===void 0&&(Y=new Map,Ls.set(z,Y));var j=Y.get(D);j===void 0?(z.addEventListener(D,xi,{passive:I}),Y.set(D,1)):Y.set(D,j+1)}}}};b(Hs(Hn)),pi.add(b);var C=void 0,y=kl(()=>{var w=a??r.appendChild(ia());return Zo(w,{pending:()=>{}},h=>{Gt({});var D=Xt;l&&(D.c=l),o&&(n.$$events=o),C=e(h,n)||{},qt()}),()=>{var Y;for(var h of m)for(const j of[r,document]){var D=Ls.get(j),I=D.get(h);--I==0?(j.removeEventListener(h,xi),D.delete(h),D.size===0&&Ls.delete(j)):D.set(h,I)}pi.delete(b),w!==a&&((Y=w.parentNode)==null||Y.removeChild(w))}});return Ml.set(C,y),C}let Ml=new WeakMap;function Wt(e){e&&xo(e[c]??"a component",e.name)}function Ht(){const e=Xt==null?void 0:Xt.function;function r(a){po(a,e[c])}return{$destroy:()=>r("$destroy()"),$on:()=>r("$on(...)"),$set:()=>r("$set(...)")}}var Nr,Hr,wr,ja,ks,Ts,Vs;class Fl{constructor(r,a=!0){Gr(this,"anchor");pt(this,Nr,new Map);pt(this,Hr,new Map);pt(this,wr,new Map);pt(this,ja,new Set);pt(this,ks,!0);pt(this,Ts,()=>{var r=vt;if(G(this,Nr).has(r)){var a=G(this,Nr).get(r),n=G(this,Hr).get(a);if(n)Ai(n),G(this,ja).delete(a);else{var o=G(this,wr).get(a);o&&(G(this,Hr).set(a,o.effect),G(this,wr).delete(a),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),n=o.effect)}for(const[l,p]of G(this,Nr)){if(G(this,Nr).delete(l),l===r)break;const m=G(this,wr).get(p);m&&(hr(m.effect),G(this,wr).delete(p))}for(const[l,p]of G(this,Hr)){if(l===a||G(this,ja).has(l))continue;const m=()=>{if(Array.from(G(this,Nr).values()).includes(l)){var C=document.createDocumentFragment();Fn(p,C),C.append(ia()),G(this,wr).set(l,{effect:p,fragment:C})}else hr(p);G(this,ja).delete(l),G(this,Hr).delete(l)};G(this,ks)||!n?(G(this,ja).add(l),Ra(p,m,!1)):m()}}});pt(this,Vs,r=>{G(this,Nr).delete(r);const a=Array.from(G(this,Nr).values());for(const[n,o]of G(this,wr))a.includes(n)||(hr(o.effect),G(this,wr).delete(n))});this.anchor=r,ut(this,ks,a)}ensure(r,a){var n=vt,o=On();if(a&&!G(this,Hr).has(r)&&!G(this,wr).has(r))if(o){var l=document.createDocumentFragment(),p=ia();l.append(p),G(this,wr).set(r,{effect:Pr(()=>a(p)),fragment:l})}else G(this,Hr).set(r,Pr(()=>a(this.anchor)));if(G(this,Nr).set(n,r),o){for(const[m,b]of G(this,Hr))m===r?n.unskip_effect(b):n.skip_effect(b);for(const[m,b]of G(this,wr))m===r?n.unskip_effect(b.effect):n.skip_effect(b.effect);n.oncommit(G(this,Ts)),n.ondiscard(G(this,Vs))}else G(this,Ts).call(this)}}Nr=new WeakMap,Hr=new WeakMap,wr=new WeakMap,ja=new WeakMap,ks=new WeakMap,Ts=new WeakMap,Vs=new WeakMap;function g(e,r,a=!1){var n=new Fl(e),o=a?Qa:0;function l(p,m){n.ensure(p,m)}Si(()=>{var p=!1;r((m,b=0)=>{p=!0,l(b,m)}),p||l(!1,null)},o)}function Ft(e,r){return r}function Ul(e,r,a){for(var n=[],o=r.length,l,p=r.length,m=0;m<o;m++){let w=r[m];Ra(w,()=>{if(l){if(l.pending.delete(w),l.done.add(w),l.pending.size===0){var h=e.outrogroups;mi(Hs(l.done)),h.delete(l),h.size===0&&(e.outrogroups=null)}}else p-=1},!1)}if(p===0){var b=n.length===0&&a!==null;if(b){var C=a,y=C.parentNode;bl(y),y.append(C),e.items.clear()}mi(r,!b)}else l={pending:new Set(r),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(l)}function mi(e,r=!0){for(var a=0;a<e.length;a++)hr(e[a],r)}var Wi;function mt(e,r,a,n,o,l=null){var p=e,m=new Map,b=(r&dn)!==0;if(b){var C=e;p=C.appendChild(ia())}var y=null,w=nl(()=>{var z=a();return Ws(z)?z:z==null?[]:Hs(z)}),h,D=!0;function I(){j.fallback=y,zl(j,h,p,r,n),y!==null&&(h.length===0?(y.f&ra)===0?Ai(y):(y.f^=ra,vs(y,null,p)):Ra(y,()=>{y=null}))}var Y=Si(()=>{h=t(w);for(var z=h.length,re=new Set,se=vt,be=On(),Oe=0;Oe<z;Oe+=1){var me=h[Oe],Se=n(me,Oe),Ce=D?null:m.get(Se);Ce?(Ce.v&&ts(Ce.v,me),Ce.i&&ts(Ce.i,Oe),be&&se.unskip_effect(Ce.e)):(Ce=Bl(m,D?p:Wi??(Wi=ia()),me,Se,Oe,o,r,a),D||(Ce.e.f|=ra),m.set(Se,Ce)),re.add(Se)}if(z===0&&l&&!y&&(D?y=Pr(()=>l(p)):(y=Pr(()=>l(Wi??(Wi=ia()))),y.f|=ra)),z>re.size&&Gl(h,n),!D)if(be){for(const[Ee,Z]of m)re.has(Ee)||se.skip_effect(Z.e);se.oncommit(I),se.ondiscard(()=>{})}else I();t(w)}),j={effect:Y,items:m,outrogroups:null,fallback:y};D=!1}function cs(e){for(;e!==null&&(e.f&Br)===0;)e=e.next;return e}function zl(e,r,a,n,o){var Z,ye,Be,De,U,te,$e,T,k;var l=(n&Ao)!==0,p=r.length,m=e.items,b=cs(e.effect.first),C,y=null,w,h=[],D=[],I,Y,j,z;if(l)for(z=0;z<p;z+=1)I=r[z],Y=o(I,z),j=m.get(Y).e,(j.f&ra)===0&&((ye=(Z=j.nodes)==null?void 0:Z.a)==null||ye.measure(),(w??(w=new Set)).add(j));for(z=0;z<p;z+=1){if(I=r[z],Y=o(I,z),j=m.get(Y).e,e.outrogroups!==null)for(const R of e.outrogroups)R.pending.delete(j),R.done.delete(j);if((j.f&ra)!==0)if(j.f^=ra,j===b)vs(j,null,a);else{var re=y?y.next:b;j===e.effect.last&&(e.effect.last=j.prev),j.prev&&(j.prev.next=j.next),j.next&&(j.next.prev=j.prev),da(e,y,j),da(e,j,re),vs(j,re,a),y=j,h=[],D=[],b=cs(y.next);continue}if((j.f&kr)!==0&&(Ai(j),l&&((De=(Be=j.nodes)==null?void 0:Be.a)==null||De.unfix(),(w??(w=new Set)).delete(j))),j!==b){if(C!==void 0&&C.has(j)){if(h.length<D.length){var se=D[0],be;y=se.prev;var Oe=h[0],me=h[h.length-1];for(be=0;be<h.length;be+=1)vs(h[be],se,a);for(be=0;be<D.length;be+=1)C.delete(D[be]);da(e,Oe.prev,me.next),da(e,y,Oe),da(e,me,se),b=se,y=me,z-=1,h=[],D=[]}else C.delete(j),vs(j,b,a),da(e,j.prev,j.next),da(e,j,y===null?e.effect.first:y.next),da(e,y,j),y=j;continue}for(h=[],D=[];b!==null&&b!==j;)(C??(C=new Set)).add(b),D.push(b),b=cs(b.next);if(b===null)continue}(j.f&ra)===0&&h.push(j),y=j,b=cs(j.next)}if(e.outrogroups!==null){for(const R of e.outrogroups)R.pending.size===0&&(mi(Hs(R.done)),(U=e.outrogroups)==null||U.delete(R));e.outrogroups.size===0&&(e.outrogroups=null)}if(b!==null||C!==void 0){var Se=[];if(C!==void 0)for(j of C)(j.f&kr)===0&&Se.push(j);for(;b!==null;)(b.f&kr)===0&&b!==e.fallback&&Se.push(b),b=cs(b.next);var Ce=Se.length;if(Ce>0){var Ee=(n&dn)!==0&&p===0?a:null;if(l){for(z=0;z<Ce;z+=1)($e=(te=Se[z].nodes)==null?void 0:te.a)==null||$e.measure();for(z=0;z<Ce;z+=1)(k=(T=Se[z].nodes)==null?void 0:T.a)==null||k.fix()}Ul(e,Se,Ee)}}l&&Yr(()=>{var R,ee;if(w!==void 0)for(j of w)(ee=(R=j.nodes)==null?void 0:R.a)==null||ee.apply()})}function Bl(e,r,a,n,o,l,p,m){var b=(p&So)!==0?(p&Po)===0?vl(a,!1,!1):Fa(a):null,C=(p&Co)!==0?Fa(o):null;return b&&(b.trace=()=>{m()[(C==null?void 0:C.v)??o]}),{v:b,i:C,e:Pr(()=>(l(r,b??a,C??o,m),()=>{e.delete(n)}))}}function vs(e,r,a){if(e.nodes)for(var n=e.nodes.start,o=e.nodes.end,l=r&&(r.f&ra)===0?r.nodes.start:a;n!==null;){var p=Cs(n);if(l.before(n),n===o)return;n=p}}function da(e,r,a){r===null?e.effect.first=a:r.next=a,a===null?e.effect.last=r:a.prev=r}function Gl(e,r){const a=new Map,n=e.length;for(let o=0;o<n;o++){const l=r(e[o],o);if(a.has(l)){const p=String(a.get(l)),m=String(o);let b=String(l);b.startsWith("[object ")&&(b=null),_o(p,m,b)}a.set(l,o)}}const Hi=[...` 	
\r\f \v\uFEFF`];function ql(e,r,a){var n=e==null?"":""+e;if(r&&(n=n?n+" "+r:r),a){for(var o in a)if(a[o])n=n?n+" "+o:o;else if(n.length)for(var l=o.length,p=0;(p=n.indexOf(o,p))>=0;){var m=p+l;(p===0||Hi.includes(n[p-1]))&&(m===n.length||Hi.includes(n[m]))?n=(p===0?"":n.substring(0,p))+n.substring(m+1):p=m}}return n===""?null:n}function Kl(e,r){return e==null?null:String(e)}function Le(e,r,a,n,o,l){var p=e.__className;if(p!==a||p===void 0){var m=ql(a,n,l);m==null?e.removeAttribute("class"):e.className=m,e.__className=a}else if(l&&o!==l)for(var b in l){var C=!!l[b];(o==null||C!==!!o[b])&&e.classList.toggle(b,C)}return l}function us(e,r,a,n){var o=e.__style;if(o!==r){var l=Kl(r);l==null?e.removeAttribute("style"):e.style.cssText=l,e.__style=r}return n}function Pi(e,r,a=!1){if(e.multiple){if(r==null)return;if(!Ws(r))return No();for(var n of e.options)n.selected=r.includes(_s(n));return}for(n of e.options){var o=_s(n);if(fl(o,r)){n.selected=!0;return}}(!a||r!==void 0)&&(e.selectedIndex=-1)}function Jn(e){var r=new MutationObserver(()=>{Pi(e,e.__value)});r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ei(()=>{r.disconnect()})}function Xs(e,r,a=r){var n=new WeakSet,o=!0;jn(e,"change",l=>{var p=l?"[selected]":":checked",m;if(e.multiple)m=[].map.call(e.querySelectorAll(p),_s);else{var b=e.querySelector(p)??e.querySelector("option:not([disabled])");m=b&&_s(b)}a(m),vt!==null&&n.add(vt)}),Rn(()=>{var l=r();if(e===document.activeElement){var p=Bs??vt;if(n.has(p))return}if(Pi(e,l,o),o&&l===void 0){var m=e.querySelector(":checked");m!==null&&(l=_s(m),a(l))}e.__value=l,o=!1}),Jn(e)}function _s(e){return"__value"in e?e.__value:e.value}const Vl=Symbol("is custom element"),Wl=Symbol("is html");function Vt(e,r,a,n){var o=Hl(e);o[r]!==(o[r]=a)&&(r==="loading"&&(e[lo]=a),a==null?e.removeAttribute(r):typeof a!="string"&&Jl(e).includes(r)?e[r]=a:e.setAttribute(r,a))}function Hl(e){return e.__attributes??(e.__attributes={[Vl]:e.nodeName.includes("-"),[Wl]:e.namespaceURI===cn})}var Ji=new Map;function Jl(e){var r=e.getAttribute("is")||e.nodeName,a=Ji.get(r);if(a)return a;Ji.set(r,a=[]);for(var n,o=e,l=Element.prototype;l!==o;){n=ro(o);for(var p in n)n[p].set&&a.push(p);o=gi(o)}return a}function St(e,r,a=r){var n=new WeakSet;jn(e,"input",async o=>{e.type==="checkbox"&&Ni();var l=o?e.defaultValue:e.value;if(l=si(e)?ii(l):l,a(l),vt!==null&&n.add(vt),await Ms(),l!==(l=r())){var p=e.selectionStart,m=e.selectionEnd,b=e.value.length;if(e.value=l??"",m!==null){var C=e.value.length;p===m&&m===b&&C>b?(e.selectionStart=C,e.selectionEnd=C):(e.selectionStart=p,e.selectionEnd=Math.min(m,C))}}}),ns(r)==null&&e.value&&(a(si(e)?ii(e.value):e.value),vt!==null&&n.add(vt)),gs(()=>{e.type==="checkbox"&&Ni();var o=r();if(e===document.activeElement){var l=Bs??vt;if(n.has(l))return}si(e)&&o===ii(e.value)||e.type==="date"&&!o&&!e.value||o!==e.value&&(e.value=o??"")})}function si(e){var r=e.type;return r==="number"||r==="range"}function ii(e){return e===""?null:+e}function Yi(e,r){return e===r||(e==null?void 0:e[La])===r}function Yl(e={},r,a,n){return Rn(()=>{var o,l;return gs(()=>{o=l,l=[],ns(()=>{e!==a(...l)&&(r(e,...l),o&&Yi(a(...o),e)&&r(null,...o))})}),()=>{Yr(()=>{l&&Yi(a(...l),e)&&r(null,...l)})}}),e}let Rs=!1;function Ql(e){var r=Rs;try{return Rs=!1,[e(),Rs]}finally{Rs=r}}function Zl(e,r,a,n){var o=n,l=!0,p=()=>(l&&(l=!1,o=n),o),m;m=e[r],m===void 0&&n!==void 0&&(m=p());var b;return b=()=>{var C=e[r];return C===void 0?p():(l=!0,C)},b}function Qi(e,r,a,n,o,l){rl(r,()=>{var p=!1,m=xa==null?void 0:xa[c];gs(()=>{if(!p){var[b,C]=Ql(a);if(!C){var y=n(),w=!1,h=gs(()=>{w||b[y]});if(w=!0,h.deps===null){var D=`${m}:${o}:${l}`;Lo(e,D),p=!0}}}})})}function bt(e,...r){return ns(()=>{try{let a=!1;const n=[];for(const o of r)o&&typeof o=="object"&&La in o?(n.push(Bo(o,!0)),a=!0):n.push(o);a&&(Ro(e),console.log("%c[snapshot]","color: grey",...n))}catch{}}),r}{let e=function(r){if(!(r in globalThis)){let a;Object.defineProperty(globalThis,r,{configurable:!0,get:()=>{if(a!==void 0)return a;wo(r)},set:n=>{a=n}})}};var P2=e;e("$state"),e("$effect"),e("$derived"),e("$inspect"),e("$props"),e("$bindable")}function os(e){Xt===null&&uo("onMount"),fr(()=>{const r=ns(e);if(typeof r=="function")return r})}const Xl="5";var tn;typeof window<"u"&&((tn=window.__svelte??(window.__svelte={})).v??(tn.v=new Set)).add(Xl);const ed=100,ot=is(ht({refreshCounter:0,currentTab:"overview",currentMemoryTab:"core"}),"dashboard"),Tt=is(ht({checked:!1,authenticated:!1,userId:null,role:null,subject:null,onboardingCompleted:null}),"auth"),It=is(ht({events:[],isThinking:!1,activeTool:null}),"liveFeed");function Mr(){ot.refreshCounter++}function Yn(e){switch(It.events=[e,...It.events].slice(0,ed),e.type){case"thinking":It.isThinking=!0,It.activeTool=null;break;case"tool_start":It.activeTool=e.tool;break;case"tool_result":It.activeTool=null;break;case"turn_complete":case"error":It.isThinking=!1,It.activeTool=null;break}}function Qn(){It.events=[],It.isThinking=!1,It.activeTool=null}dt[c]="src/components/LoginOverlay.svelte";var td=v(u('<div class="mb-4 px-3 py-2 rounded-md bg-error-950 border border-error-500/30 text-sm text-error-400"><i class="fa-solid fa-circle-exclamation mr-1"></i> </div>'),dt[c],[[261,12,[[262,16]]]]),rd=v(u('<div class="text-center py-4"><i class="fa-solid fa-spinner fa-spin text-text-muted"></i></div>'),dt[c],[[267,12,[[268,16]]]]),ad=v(u('<i class="fa-solid fa-spinner fa-spin"></i> Waiting for passkey...',1),dt[c],[[284,28]]),sd=v(u('<i class="fa-solid fa-fingerprint text-amber-400"></i> Use Passkey',1),dt[c],[[286,28]]),id=v(u(`<button type="button" class="w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md
                               border border-border bg-surface-elevated text-text font-medium text-sm
                               hover:bg-surface hover:border-primary-500/40 transition-colors
                               disabled:opacity-50 disabled:cursor-not-allowed"><!></button>`),dt[c],[[274,20]]),nd=v(u('<div class="relative my-2"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-border"></div></div> <div class="relative flex justify-center text-xs uppercase"><span class="bg-surface px-3 text-text-muted tracking-wider">or</span></div></div>'),dt[c],[[292,20,[[293,24,[[294,28]]],[296,24,[[297,28]]]]]]),od=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Verifying...',1),dt[c],[[329,36]]),ld=v(u('<i class="fa-solid fa-check mr-1"></i> Verify',1),dt[c],[[331,36]]),dd=v(u(`<div><label class="block mb-3"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Authenticator Code</span> <input type="text" maxlength="6" class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                           font-mono tracking-widest text-center text-lg
                                           placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50
                                           disabled:opacity-50" placeholder="000000"/></label> <button type="button" class="w-full px-4 py-2 rounded-md bg-primary-600 text-white font-medium text-sm
                                       hover:bg-primary-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div> <button type="button" class="w-full text-xs text-text-muted hover:text-primary-400 transition-colors">Use a recovery code instead</button>`,1),dt[c],[[304,24,[[305,28,[[306,32],[307,32]]],[321,28]]],[335,24]]),cd=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Verifying...',1),dt[c],[[367,36]]),vd=v(u('<i class="fa-solid fa-check mr-1"></i> Verify Recovery Code',1),dt[c],[[369,36]]),ud=v(u(`<div><label class="block mb-3"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Recovery Code</span> <input type="text" class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                           font-mono tracking-wider text-center
                                           placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50
                                           disabled:opacity-50" placeholder="abcd1234"/></label> <button type="button" class="w-full px-4 py-2 rounded-md bg-primary-600 text-white font-medium text-sm
                                       hover:bg-primary-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button></div> <button type="button" class="w-full text-xs text-text-muted hover:text-primary-400 transition-colors">Use authenticator code instead</button>`,1),dt[c],[[343,24,[[344,28,[[345,32],[346,32]]],[359,28]]],[373,24]]),fd=v(u('<div class="space-y-4"><!> <!> <!> <button type="button" class="w-full text-xs text-text-muted hover:text-text transition-colors mt-2"><i class="fa-solid fa-arrow-left mr-1"></i> Back to login</button></div>'),dt[c],[[272,12,[[383,16,[[388,20]]]]]]),pd=v(u(`<button type="button" class="w-full flex items-center justify-center gap-2 px-4 py-2.5 rounded-md
                                   border border-border bg-surface-elevated text-text font-medium text-sm
                                   hover:bg-surface hover:border-primary-500/40 transition-colors"><i></i> </button>`),dt[c],[[396,24,[[403,28]]]]),xd=v(u('<div class="relative my-5"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-border"></div></div> <div class="relative flex justify-center text-xs uppercase"><span class="bg-surface px-3 text-text-muted tracking-wider">or</span></div></div>'),dt[c],[[410,20,[[411,24,[[412,28]]],[414,24,[[415,28]]]]]]),md=v(u('<div class="space-y-2 mb-4"></div> <!>',1),dt[c],[[394,16]]),_d=v(u(`<label class="block mb-3"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Username</span> <input type="text" required="" class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                       placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50
                                       disabled:opacity-50" placeholder="Enter username"/></label>`),dt[c],[[424,24,[[425,28],[426,28]]]]),bd=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Signing in...',1),dt[c],[[461,28]]),gd=v(u('<i class="fa-solid fa-right-to-bracket mr-1"></i> Sign In',1),dt[c],[[463,28]]),hd=v(u(`<form><!> <label class="block mb-4"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Password</span> <input type="password" required="" class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                   placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50
                                   disabled:opacity-50" placeholder="Enter password"/></label> <button type="submit" class="w-full px-4 py-2 rounded-md bg-primary-600 text-white font-medium text-sm
                               hover:bg-primary-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button></form>`),dt[c],[[422,16,[[439,20,[[440,24],[441,24]]],[454,20]]]]),yd=v(u("<!> <!>",1),dt[c],[]),wd=v(u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm"><div class="w-full max-w-sm mx-4 p-8 rounded-xl border border-border bg-surface shadow-2xl"><div class="text-center mb-6"><i class="fa-solid fa-robot text-3xl text-primary-400 mb-3"></i> <h2 class="text-lg font-semibold text-text">safe-agent</h2> <p class="text-sm text-text-muted mt-1"><!></p></div> <!> <!></div></div>'),dt[c],[[242,0,[[243,4,[[244,8,[[245,12],[246,12],[247,12]]]]]]]]);function dt(e,r){Wt(new.target),Gt(r,!0,dt);let a=$(A(""),"username"),n=$(A(""),"password"),o=$(A(""),"error"),l=$(A(!1),"loading"),p=$(A(!0),"passwordEnabled"),m=$(A(ht([])),"ssoProviders"),b=$(A(!1),"infoLoaded"),C=$(A(!1),"multiUserMode"),y=$(A(!1),"twoFaRequired"),w=$(A(""),"challengeToken"),h=$(A(ht([])),"twoFaMethods"),D=$(A(""),"twoFaUserId"),I=$(A(""),"totpCode"),Y=$(A(""),"recoveryCode"),j=$(A(!1),"showRecoveryInput"),z=$(A(!1),"passkeyLoading");fr(()=>{re()});async function re(){try{const L=(await N(fetch("/api/auth/info")))(),K=(await N(L.json()))();f(p,K.password_enabled??!0,!0),f(m,K.sso_providers??[],!0),f(C,K.multi_user??!1,!0)}catch{f(p,!0),f(m,[],!0)}finally{f(b,!0)}}async function se(L){L.preventDefault(),f(o,""),f(l,!0);try{const K={password:t(n)};t(C)&&t(a)&&(K.username=t(a));const ce=(await N(fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)})))(),he=(await N(ce.json()))();he.requires_2fa?(f(y,!0),f(w,he.challenge_token,!0),f(h,he.methods||[],!0),f(D,he.user_id||"",!0),f(n,"")):ce.ok&&he.ok?me(he):f(o,he.error||"Login failed",!0)}catch{f(o,"Connection failed")}finally{f(l,!1)}}async function be(){f(o,""),f(l,!0);try{const L={challenge_token:t(w)};t(j)?L.recovery_code=t(Y).trim():L.totp_code=t(I).trim();const K=(await N(fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})))(),ce=(await N(K.json()))();K.ok&&ce.ok?me(ce):f(o,ce.error||"Verification failed",!0)}catch{f(o,"Connection failed")}finally{f(l,!1)}}async function Oe(){f(o,""),f(z,!0);try{const L=(await N(fetch("/api/auth/passkey/authenticate/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({challenge_token:t(w)})})))(),K=(await N(L.json()))();if(!K.ok){f(o,K.error||"Failed to start passkey authentication",!0),f(z,!1);return}const ce=K.options;if(ce.publicKey.challenge=Ee(ce.publicKey.challenge),ce.publicKey.allowCredentials)for(const P of ce.publicKey.allowCredentials)P.id=Ee(P.id);const he=(await N(navigator.credentials.get(ce)))();if(!he){f(o,"Passkey authentication was cancelled"),f(z,!1);return}const ge=he.response,V={challenge_token:t(w),credential:{id:he.id,rawId:Z(he.rawId),response:{authenticatorData:Z(ge.authenticatorData),clientDataJSON:Z(ge.clientDataJSON),signature:Z(ge.signature),userHandle:ge.userHandle?Z(ge.userHandle):null},type:he.type}},M=(await N(fetch("/api/auth/passkey/authenticate/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)})))(),_e=(await N(M.json()))();M.ok&&_e.ok?me(_e):f(o,_e.error||"Passkey verification failed",!0)}catch(L){O(L.name,"NotAllowedError")?f(o,"Passkey authentication was cancelled or timed out"):f(o,`Passkey authentication failed: ${L.message}`)}finally{f(z,!1)}}function me(L){Tt.authenticated=!0,L.user&&(Tt.userId=L.user.id,Tt.role=L.user.role,Tt.subject=L.user.username),f(a,""),f(n,""),f(y,!1),f(w,""),f(I,""),f(Y,"")}function Se(){f(y,!1),f(w,""),f(h,[],!0),f(I,""),f(Y,""),f(j,!1),f(o,"")}function Ce(L){window.location.href=L.login_url}function Ee(L){const K=L.replace(/-/g,"+").replace(/_/g,"/"),ce=K+"=".repeat((4-K.length%4)%4),he=atob(ce),ge=new ArrayBuffer(he.length),V=new Uint8Array(ge);for(let M=0;M<he.length;M++)V[M]=he.charCodeAt(M);return ge}function Z(L){const K=new Uint8Array(L);let ce="";for(const he of K)ce+=String.fromCharCode(he);return btoa(ce).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var ye={...Ht()},Be=wd(),De=s(Be),U=s(De),te=i(s(U),4),$e=s(te);{var T=L=>{var K=ua("Two-factor authentication required");d(L,K)},k=L=>{var K=ua("Sign in to continue");d(L,K)},R=L=>{var K=ua("Sign in with your account");d(L,K)},ee=L=>{var K=ua("Enter the dashboard password to continue");d(L,K)};x(()=>g($e,L=>{t(y)?L(T):t(p)&&t(m).length>0?L(k,1):t(m).length>0?L(R,2):L(ee,!1)}),"if",dt,248,16)}var W=i(U,2);{var le=L=>{var K=td(),ce=i(s(K));S(()=>_(ce,` ${t(o)??""}`)),d(L,K)};x(()=>g(W,L=>{t(o)&&L(le)}),"if",dt,260,8)}var ke=i(W,2);{var Ae=L=>{var K=rd();d(L,K)},q=L=>{var K=fd(),ce=s(K);{var he=ne=>{var pe=id(),ie=s(pe);{var H=E=>{var J=ad();d(E,J)},Q=E=>{var J=sd();d(E,J)};x(()=>g(ie,E=>{t(z)?E(H):E(Q,!1)}),"if",dt,283,24)}S(()=>pe.disabled=t(z)),X("click",pe,Oe),d(ne,pe)},ge=cr(()=>t(h).includes("passkey"));x(()=>g(ce,ne=>{t(ge)&&ne(he)}),"if",dt,273,16)}var V=i(ce,2);{var M=ne=>{var pe=nd();d(ne,pe)},_e=cr(()=>t(h).includes("passkey")&&t(h).includes("totp"));x(()=>g(V,ne=>{t(_e)&&ne(M)}),"if",dt,291,16)}var P=i(V,2);{var ae=ne=>{var pe=er(),ie=We(pe);{var H=E=>{var J=dd(),xe=We(J),oe=s(xe),ue=i(s(oe),2);js(ue,!0);var Te=i(oe,2),ze=s(Te);{var Ne=fe=>{var we=od();d(fe,we)},Fe=fe=>{var we=ld();d(fe,we)};x(()=>g(ze,fe=>{t(l)?fe(Ne):fe(Fe,!1)}),"if",dt,328,32)}var Ie=i(xe,2);S(fe=>{ue.disabled=t(l),Te.disabled=fe},[()=>t(l)||O(t(I).trim().length,6,!1)]),X("keydown",ue,function(we){O(we.key,"Enter")&&O(t(I).trim().length,6)&&be()}),St(ue,function(){return t(I)},function(we){f(I,we)}),X("click",Te,be),X("click",Ie,function(){f(j,!0),f(o,"")}),d(E,J)},Q=E=>{var J=ud(),xe=We(J),oe=s(xe),ue=i(s(oe),2);js(ue,!0);var Te=i(oe,2),ze=s(Te);{var Ne=fe=>{var we=cd();d(fe,we)},Fe=fe=>{var we=vd();d(fe,we)};x(()=>g(ze,fe=>{t(l)?fe(Ne):fe(Fe,!1)}),"if",dt,366,32)}var Ie=i(xe,2);S(fe=>{ue.disabled=t(l),Te.disabled=fe},[()=>t(l)||!t(Y).trim()]),X("keydown",ue,function(we){O(we.key,"Enter")&&t(Y).trim()&&be()}),St(ue,function(){return t(Y)},function(we){f(Y,we)}),X("click",Te,be),X("click",Ie,function(){f(j,!1),f(o,"")}),d(E,J)};x(()=>g(ie,E=>{t(j)?E(Q,!1):E(H)}),"if",dt,303,20)}d(ne,pe)},de=cr(()=>t(h).includes("totp"));x(()=>g(P,ne=>{t(de)&&ne(ae)}),"if",dt,302,16)}var F=i(P,2);X("click",F,Se),d(L,K)},B=L=>{var K=yd(),ce=We(K);{var he=M=>{var _e=md(),P=We(_e);x(()=>mt(P,21,()=>t(m),Ft,(F,ne)=>{var pe=pd(),ie=s(pe),H=i(ie);S(()=>{Le(ie,1,`${t(ne).icon??""} text-base`),_(H,` Continue with ${t(ne).name??""}`)}),X("click",pe,function(){return Ce(t(ne))}),d(F,pe)}),"each",dt,395,20);var ae=i(P,2);{var de=F=>{var ne=xd();d(F,ne)};x(()=>g(ae,F=>{t(p)&&F(de)}),"if",dt,409,16)}d(M,_e)};x(()=>g(ce,M=>{t(m).length>0&&M(he)}),"if",dt,393,12)}var ge=i(ce,2);{var V=M=>{var _e=hd(),P=s(_e);{var ae=Q=>{var E=_d(),J=i(s(E),2);js(J,!0),S(()=>J.disabled=t(l)),St(J,function(){return t(a)},function(oe){f(a,oe)}),d(Q,E)};x(()=>g(P,Q=>{t(C)&&Q(ae)}),"if",dt,423,20)}var de=i(P,2),F=i(s(de),2);js(F,!t(C));var ne=i(de,2),pe=s(ne);{var ie=Q=>{var E=bd();d(Q,E)},H=Q=>{var E=gd();d(Q,E)};x(()=>g(pe,Q=>{t(l)?Q(ie):Q(H,!1)}),"if",dt,460,24)}S(()=>{F.disabled=t(l),ne.disabled=t(l)||!t(n)}),Ll("submit",_e,se),St(F,function(){return t(n)},function(E){f(n,E)}),d(M,_e)};x(()=>g(ge,M=>{t(p)&&M(V)}),"if",dt,421,12)}d(L,K)};x(()=>g(ke,L=>{t(b)?t(y)?L(q,1):L(B,!1):L(Ae)}),"if",dt,266,8)}return d(e,Be),qt(ye)}ar(["click","keydown"]);nt[c]="src/components/OnboardingWizard.svelte";var kd=v(u('<i class="fa-solid fa-check"></i>'),nt[c],[[146,28]]),Td=v(u("<div></div>"),nt[c],[[152,24]]),$d=v(u('<div class="flex items-center"><div><!></div> <!></div>'),nt[c],[[142,16,[[143,20]]]]),Ed=v(u(`<div class="text-center mb-6"><div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-primary-600/10 mb-4"><i class="fa-solid fa-robot text-3xl text-primary-500"></i></div> <h2 class="text-2xl font-bold text-text">Welcome to Safe Agent</h2> <p class="text-text-muted mt-2">Let's set up your AI agent. You can change these later in Settings.</p></div> <label class="block mb-4"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Agent Name</span> <input type="text" class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                   placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50" placeholder="e.g. Jarvis, Friday, Atlas..."/></label> <label class="block mb-2"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Core Personality</span> <textarea rows="4" class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                   placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50 resize-none" placeholder="Describe how your agent should behave, e.g. 'You are a helpful assistant that responds concisely.'"></textarea></label> <p class="text-xs text-text-muted">This instruction persists across all interactions.</p>`,1),nt[c],[[163,20,[[164,24,[[165,28]]],[167,24],[168,24]]],[171,20,[[172,24],[173,24]]],[182,20,[[183,24],[184,24]]],[192,20]]),Sd=v(u("<option> </option>"),nt[c],[[212,32]]),Cd=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Testing connection...',1),nt[c],[[230,28]]),Ad=v(u('<i class="fa-solid fa-flask mr-1"></i> Test Connection',1),nt[c],[[232,28]]),Pd=v(u('<i class="fa-solid fa-check-circle mr-1"></i> <strong>Success!</strong> <p class="mt-1 text-xs opacity-80"> </p>',1),nt[c],[[239,32],[239,78],[240,32]]),Od=v(u('<i class="fa-solid fa-times-circle mr-1"></i> <strong>Failed</strong> <p class="mt-1 text-xs opacity-80"> </p>',1),nt[c],[[242,32],[242,78],[243,32]]),jd=v(u("<div><!></div>"),nt[c],[[237,24]]),Ld=v(u(`<div class="text-center mb-6"><div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-primary-600/10 mb-4"><i class="fa-solid fa-brain text-3xl text-primary-500"></i></div> <h2 class="text-2xl font-bold text-text">LLM Backend</h2> <p class="text-text-muted mt-2">Choose and test the AI model that powers your agent.</p></div> <label class="block mb-4"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Backend</span> <select class="mt-1 w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text
                                   focus:outline-none focus:ring-2 focus:ring-primary-500/50"></select></label> <p class="text-xs text-text-muted mb-4">Make sure the required environment variable for your chosen backend is set
                        (e.g. <code class="bg-surface-elevated px-1 rounded text-xs">OPENROUTER_API_KEY</code>, <code class="bg-surface-elevated px-1 rounded text-xs">CLAUDE_BIN</code>, etc.)</p> <button class="w-full px-4 py-2 rounded-md border border-border bg-surface-elevated text-text font-medium text-sm
                               hover:bg-surface transition-colors disabled:opacity-50 disabled:cursor-not-allowed"><!></button> <!>`,1),nt[c],[[196,20,[[197,24,[[198,28]]],[200,24],[201,24]]],[204,20,[[205,24],[206,24]]],[217,20,[[219,30],[220,24]]],[223,20]]),Rd=v(u('<div class="text-center mb-6"><div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-primary-600/10 mb-4"><i class="fa-solid fa-comments text-3xl text-primary-500"></i></div> <h2 class="text-2xl font-bold text-text">Messaging Platforms</h2> <p class="text-text-muted mt-2">Optionally connect messaging platforms. You can do this later in Settings.</p></div> <div class="space-y-4"><div class="flex items-center justify-between p-4 rounded-lg border border-border bg-surface-elevated"><div class="flex items-center gap-3"><i class="fa-brands fa-telegram text-2xl text-blue-400"></i> <div><p class="font-medium text-text">Telegram</p> <p class="text-xs text-text-muted">Requires <code class="bg-surface px-1 rounded">TELEGRAM_BOT_TOKEN</code></p></div></div> <span> </span></div> <div class="flex items-center justify-between p-4 rounded-lg border border-border bg-surface-elevated"><div class="flex items-center gap-3"><i class="fa-brands fa-whatsapp text-2xl text-green-400"></i> <div><p class="font-medium text-text">WhatsApp</p> <p class="text-xs text-text-muted">Requires WhatsApp bridge setup</p></div></div> <span> </span></div></div> <p class="text-xs text-text-muted mt-4">Messaging platforms can be configured later via the config file or environment variables.</p>',1),nt[c],[[250,20,[[251,24,[[252,28]]],[254,24],[255,24]]],[258,20,[[259,24,[[260,28,[[261,32],[262,32,[[263,36],[264,36,[[264,80]]]]]]],[267,28]]],[273,24,[[274,28,[[275,32],[276,32,[[277,36],[278,36]]]]],[281,28]]]]],[288,20]]),Nd=v(u('<div class="p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-xs text-text-muted uppercase tracking-wide">Personality</span> <p class="text-sm text-text mt-1 line-clamp-3"> </p></div>'),nt[c],[[324,28,[[325,32],[326,32]]]]),Dd=v(u('<div class="text-center mb-6"><div class="inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-green-600/10 mb-4"><i class="fa-solid fa-check-double text-3xl text-green-500"></i></div> <h2 class="text-2xl font-bold text-text">Ready to Go</h2> <p class="text-text-muted mt-2">Review your configuration and complete setup.</p></div> <div class="space-y-3 mb-6"><div class="flex justify-between items-center p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-sm text-text-muted">Agent Name</span> <span class="text-sm font-medium text-text"> </span></div> <div class="flex justify-between items-center p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-sm text-text-muted">LLM Backend</span> <span class="text-sm font-medium text-text"> </span></div> <div class="flex justify-between items-center p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-sm text-text-muted">Telegram</span> <span> </span></div> <div class="flex justify-between items-center p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-sm text-text-muted">WhatsApp</span> <span> </span></div> <!></div> <p class="text-xs text-text-muted text-center mb-2">You can change all of these later from the Settings tab.</p>',1),nt[c],[[294,20,[[295,24,[[296,28]]],[298,24],[299,24]]],[302,20,[[303,24,[[304,28],[305,28]]],[307,24,[[308,28],[309,28]]],[311,24,[[312,28],[313,28]]],[317,24,[[318,28],[319,28]]]]],[331,20]]),Id=v(u('<div class="px-8 pb-2"><div class="p-3 rounded-md bg-red-900/30 border border-red-700/50 text-red-300 text-sm"><i class="fa-solid fa-triangle-exclamation mr-1"></i> </div></div>'),nt[c],[[339,16,[[340,20,[[341,24]]]]]]),Md=v(u('<button class="px-4 py-2 rounded-md text-sm text-text-muted hover:text-text transition-colors"><i class="fa-solid fa-arrow-left mr-1"></i> Back</button>'),nt[c],[[350,24,[[354,28]]]]),Fd=v(u('<button class="px-4 py-2 rounded-md text-sm text-text-muted hover:text-text transition-colors">Skip <i class="fa-solid fa-forward ml-1"></i></button>'),nt[c],[[363,24,[[367,33]]]]),Ud=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Saving...',1),nt[c],[[379,32]]),zd=v(u('Next <i class="fa-solid fa-arrow-right ml-1"></i>',1),nt[c],[[381,37]]),Bd=v(u(`<button class="px-5 py-2 rounded-md bg-primary-600 text-white font-medium text-sm
                                   hover:bg-primary-500 transition-colors disabled:opacity-50"><!></button>`),nt[c],[[372,24]]),Gd=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Completing...',1),nt[c],[[392,32]]),qd=v(u('<i class="fa-solid fa-rocket mr-1"></i> Complete Setup',1),nt[c],[[394,32]]),Kd=v(u(`<button class="px-5 py-2 rounded-md bg-green-600 text-white font-medium text-sm
                                   hover:bg-green-500 transition-colors disabled:opacity-50"><!></button>`),nt[c],[[385,24]]),Vd=v(u('<div class="fixed inset-0 z-50 flex items-center justify-center bg-bg/95 backdrop-blur-sm"><div class="w-full max-w-2xl mx-4"><div class="flex items-center justify-center mb-8 gap-2"></div> <div class="bg-surface rounded-xl border border-border shadow-2xl overflow-hidden"><div class="p-8"><!></div> <!> <div class="flex justify-between items-center px-8 py-5 bg-surface-elevated border-t border-border"><div><!></div> <div class="flex items-center gap-2"><span class="text-xs text-text-muted"> </span> <!> <!></div></div></div></div></div>'),nt[c],[[136,0,[[137,4,[[139,8],[158,8,[[160,12],[347,12,[[348,16],[359,16,[[360,20]]]]]]]]]]]]);function nt(e,r){Wt(new.target),Gt(r,!0,nt);let a=$(A(1),"currentStep");const n=4;let o=$(A(""),"agentName"),l=$(A(""),"corePersonality"),p=$(A(""),"activeBackend"),m=$(A(ht([])),"availableBackends"),b=$(A(""),"llmTestResult"),C=$(A(null),"llmTestOk"),y=$(A(!1),"llmTesting"),w=$(A(!1),"telegramEnabled"),h=$(A(!1),"whatsappEnabled"),D=$(A(!1),"saving"),I=$(A(""),"error"),Y=$(A(!1),"completing");const j=V=>{window.dispatchEvent(new CustomEvent(V))};fr(()=>{z()});async function z(){try{const V=(await N(fetch("/api/onboarding/status")))(),M=(await N(V.json()))();f(o,M.agent_name||"",!0),f(l,M.core_personality||"",!0),f(p,M.llm_backend||"",!0),f(m,M.llm_available||[],!0),f(w,M.telegram_enabled||!1,!0),f(h,M.whatsapp_enabled||!1,!0)}catch(V){console.error(...bt("error","Failed to load onboarding status",V))}}async function re(){f(D,!0),f(I,"");try{const V=(await N(fetch("/api/onboarding/save-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_name:t(o)||void 0,core_personality:t(l)||void 0,llm_backend:t(p)||void 0})})))(),M=(await N(V.json()))();M.ok||f(I,M.message||"Failed to save config",!0)}catch{f(I,"Network error saving config")}finally{f(D,!1)}}async function se(){f(y,!0),f(b,""),f(C,null);try{const V=(await N(fetch("/api/onboarding/test-llm",{method:"POST",headers:{"Content-Type":"application/json"}})))(),M=(await N(V.json()))();f(C,M.ok,!0),f(b,M.ok?M.response:M.error,!0)}catch{f(C,!1),f(b,"Network error testing LLM connection")}finally{f(y,!1)}}async function be(){f(Y,!0),f(I,"");try{const V=(await N(fetch("/api/onboarding/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agent_name:t(o)||void 0,core_personality:t(l)||void 0})})))(),M=(await N(V.json()))();M.ok?j("onboarding-complete"):f(I,M.message||"Failed to complete onboarding",!0)}catch{f(I,"Network error completing onboarding")}finally{f(Y,!1)}}function Oe(){O(t(a),1)&&re(),t(a)<n&&Ui(a)}function me(){t(a)>1&&Ui(a,-1)}var Se={...Ht()},Ce=Vd(),Ee=s(Ce),Z=s(Ee);x(()=>mt(Z,21,()=>Array(n),Ft,(V,M,_e)=>{const P=$(cr(()=>_e+1),"step");t(P);var ae=$d(),de=s(ae),F=s(de);{var ne=Q=>{var E=kd();d(Q,E)},pe=Q=>{var E=ua();S(()=>_(E,t(P))),d(Q,E)};x(()=>g(F,Q=>{t(P)<t(a)?Q(ne):Q(pe,!1)}),"if",nt,145,24)}var ie=i(de,2);{var H=Q=>{var E=Td();S(()=>Le(E,1,`w-12 h-0.5 mx-1 ${t(P)<t(a)?"bg-green-600":"bg-border"}`)),d(Q,E)};x(()=>g(ie,Q=>{_e<n-1&&Q(H)}),"if",nt,151,20)}S(()=>Le(de,1,`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-colors
                        ${t(P)<t(a)?"bg-green-600 text-white":O(t(P),t(a))?"bg-primary-600 text-white":"bg-surface-elevated text-text-muted border border-border"}`)),d(V,ae)}),"each",nt,140,12);var ye=i(Z,2),Be=s(ye),De=s(Be);{var U=V=>{var M=Ed(),_e=i(We(M),2),P=i(s(_e),2),ae=i(_e,2),de=i(s(ae),2);St(P,function(){return t(o)},function(ne){f(o,ne)}),St(de,function(){return t(l)},function(ne){f(l,ne)}),d(V,M)},te=V=>{var M=Ld(),_e=i(We(M),2),P=i(s(_e),2);x(()=>mt(P,21,()=>t(m),Ft,(H,Q)=>{var E=Sd(),J=s(E,!0);var xe={};S(()=>{_(J,t(Q)),xe!==(xe=t(Q))&&(E.value=(E.__value=t(Q))??"")}),d(H,E)}),"each",nt,211,28);var ae=i(_e,4),de=s(ae);{var F=H=>{var Q=Cd();d(H,Q)},ne=H=>{var Q=Ad();d(H,Q)};x(()=>g(de,H=>{t(y)?H(F):H(ne,!1)}),"if",nt,229,24)}var pe=i(ae,2);{var ie=H=>{var Q=jd(),E=s(Q);{var J=oe=>{var ue=Pd(),Te=i(We(ue),4),ze=s(Te);S(()=>_(ze,t(b))),d(oe,ue)},xe=oe=>{var ue=Od(),Te=i(We(ue),4),ze=s(Te);S(()=>_(ze,t(b))),d(oe,ue)};x(()=>g(E,oe=>{t(C)?oe(J):oe(xe,!1)}),"if",nt,238,28)}S(()=>Le(Q,1,`mt-4 p-3 rounded-md text-sm ${t(C)?"bg-green-900/30 border border-green-700/50 text-green-300":"bg-red-900/30 border border-red-700/50 text-red-300"}`)),d(H,Q)};x(()=>g(pe,H=>{O(t(C),null,!1)&&H(ie)}),"if",nt,236,20)}S(()=>ae.disabled=t(y)),Xs(P,function(){return t(p)},function(Q){f(p,Q)}),X("click",ae,se),d(V,M)},$e=V=>{var M=Rd(),_e=i(We(M),2),P=s(_e),ae=i(s(P),2),de=s(ae),F=i(P,2),ne=i(s(F),2),pe=s(ne);S(()=>{Le(ae,1,`px-2 py-1 text-xs rounded-full font-medium
                                ${t(w)?"bg-green-900/40 text-green-400 border border-green-700/50":"bg-surface text-text-muted border border-border"}`),_(de,t(w)?"Enabled":"Not configured"),Le(ne,1,`px-2 py-1 text-xs rounded-full font-medium
                                ${t(h)?"bg-green-900/40 text-green-400 border border-green-700/50":"bg-surface text-text-muted border border-border"}`),_(pe,t(h)?"Enabled":"Not configured")}),d(V,M)},T=V=>{var M=Dd(),_e=i(We(M),2),P=s(_e),ae=i(s(P),2),de=s(ae),F=i(P,2),ne=i(s(F),2),pe=s(ne),ie=i(F,2),H=i(s(ie),2),Q=s(H),E=i(ie,2),J=i(s(E),2),xe=s(J),oe=i(E,2);{var ue=Te=>{var ze=Nd(),Ne=i(s(ze),2),Fe=s(Ne);S(()=>_(Fe,t(l))),d(Te,ze)};x(()=>g(oe,Te=>{t(l)&&Te(ue)}),"if",nt,323,24)}S(()=>{_(de,t(o)||"(default)"),_(pe,t(p)||"(default)"),Le(H,1,`text-sm font-medium ${t(w)?"text-green-400":"text-text-muted"}`),_(Q,t(w)?"Enabled":"Not configured"),Le(J,1,`text-sm font-medium ${t(h)?"text-green-400":"text-text-muted"}`),_(xe,t(h)?"Enabled":"Not configured")}),d(V,M)};x(()=>g(De,V=>{O(t(a),1)?V(U):O(t(a),2)?V(te,1):O(t(a),3)?V($e,2):O(t(a),4)&&V(T,3)}),"if",nt,161,16)}var k=i(Be,2);{var R=V=>{var M=Id(),_e=s(M),P=i(s(_e));S(()=>_(P,` ${t(I)??""}`)),d(V,M)};x(()=>g(k,V=>{t(I)&&V(R)}),"if",nt,338,12)}var ee=i(k,2),W=s(ee),le=s(W);{var ke=V=>{var M=Md();X("click",M,me),d(V,M)};x(()=>g(le,V=>{t(a)>1&&V(ke)}),"if",nt,349,20)}var Ae=i(W,2),q=s(Ae),B=s(q),L=i(q,2);{var K=V=>{var M=Fd();X("click",M,Oe),d(V,M)};x(()=>g(L,V=>{O(t(a),3)&&V(K)}),"if",nt,362,20)}var ce=i(L,2);{var he=V=>{var M=Bd(),_e=s(M);{var P=de=>{var F=Ud();d(de,F)},ae=de=>{var F=zd();d(de,F)};x(()=>g(_e,de=>{t(D)?de(P):de(ae,!1)}),"if",nt,378,28)}S(()=>M.disabled=t(D)),X("click",M,Oe),d(V,M)},ge=V=>{var M=Kd(),_e=s(M);{var P=de=>{var F=Gd();d(de,F)},ae=de=>{var F=qd();d(de,F)};x(()=>g(_e,de=>{t(Y)?de(P):de(ae,!1)}),"if",nt,391,28)}S(()=>M.disabled=t(Y)),X("click",M,be),d(V,M)};x(()=>g(ce,V=>{t(a)<n?V(he):V(ge,!1)}),"if",nt,371,20)}return S(()=>_(B,`Step ${t(a)??""} of 4`)),d(e,Ce),qt(Se)}ar(["click"]);class Wd extends Error{constructor(){super("Unauthorized"),this.name="UnauthorizedError"}}async function et(e,r,a){const n={method:e,headers:{}};a&&(n.headers["Content-Type"]="application/json",n.body=JSON.stringify(a));const o=await fetch(r,n);if(o.status===401)throw Tt.authenticated=!1,new Wd;if(!o.ok)throw new Error(`${e} ${r}: ${o.status}`);return o.json()}Fr[c]="src/components/Header.svelte";var Hd=v(u('<button class="px-4 py-2 border border-border rounded-md bg-surface text-sm hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-play mr-1"></i> Resume</button>'),Fr[c],[[79,12,[[83,16]]]]),Jd=v(u('<button class="px-4 py-2 border border-border rounded-md bg-surface text-sm hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-pause mr-1"></i> Pause</button>'),Fr[c],[[86,12,[[90,16]]]]),Yd=v(u('<span class="text-text-muted/60 ml-1"> </span>'),Fr[c],[[106,20]]),Qd=v(u('<span class="text-xs text-text-muted border border-border rounded px-2 py-1"><i class="fa-solid fa-user mr-1"></i> <!></span>'),Fr[c],[[102,12,[[103,16]]]]),Zd=v(u('<header class="flex justify-between items-center px-6 py-4 border-b border-border bg-surface"><div class="flex items-center gap-3"><h1 class="text-lg font-semibold tracking-tight text-primary-400"><i class="fa-solid fa-robot mr-1"></i> safe-agent</h1> <span><i></i> </span> <span class="text-xs px-2 py-0.5 rounded-full font-medium bg-primary-950 text-primary-400"><i class="fa-solid fa-screwdriver-wrench mr-1"></i> </span></div> <div class="flex gap-2"><!> <button class="px-4 py-2 border border-border rounded-md bg-surface text-sm hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-bolt mr-1"></i> Force Tick</button> <!> <button class="px-4 py-2 border border-border rounded-md bg-surface text-sm hover:bg-surface-elevated transition-colors text-text-muted" title="Sign out"><i class="fa-solid fa-right-from-bracket"></i></button></div></header>'),Fr[c],[[65,0,[[66,4,[[67,8,[[68,12]]],[70,8,[[71,12]]],[73,8,[[74,12]]]]],[77,4,[[94,8,[[98,12]]],[111,8,[[116,12]]]]]]]]);function Fr(e,r){Wt(new.target),Gt(r,!0,Fr);let a=$(A(!1),"paused"),n=$(A(0),"toolsCount"),o=$(A(""),"statusClass"),l=$(A("fa-spinner fa-spin"),"statusIcon"),p=$(A("loading..."),"statusText"),m=$(A(!1),"disconnected");async function b(){try{const De=(await N(et("GET","/api/status")))();f(a,De.paused,!0),f(n,De.tools_count,!0),f(m,!1),De.paused?(f(o,"badge-paused"),f(l,"fa-circle-pause"),f(p,"paused")):(f(o,"badge-running"),f(l,"fa-circle-check"),f(p,"running"))}catch{f(m,!0),f(o,"text-error-500"),f(l,"fa-circle-xmark"),f(p,"disconnected")}}async function C(){(await N(et("POST","/api/agent/pause")))(),Mr()}async function y(){(await N(et("POST","/api/agent/resume")))(),Mr()}async function w(){(await N(et("POST","/api/agent/tick")))(),Mr()}async function h(){try{(await N(fetch("/api/auth/logout",{method:"POST"})))()}catch{}Tt.authenticated=!1}fr(()=>{ot.refreshCounter,b()});var D={...Ht()},I=Zd(),Y=s(I),j=i(s(Y),2),z=s(j),re=i(z,1,!0),se=i(j,2),be=i(s(se)),Oe=i(Y,2),me=s(Oe);{var Se=De=>{var U=Hd();X("click",U,y),d(De,U)},Ce=De=>{var U=Jd();X("click",U,C),d(De,U)};x(()=>g(me,De=>{t(a)?De(Se):De(Ce,!1)}),"if",Fr,78,8)}var Ee=i(me,2),Z=i(Ee,2);{var ye=De=>{var U=Qd(),te=i(s(U)),$e=i(te);{var T=k=>{var R=Yd(),ee=s(R);S(()=>_(ee,`(${Tt.role??""})`)),d(k,R)};x(()=>g($e,k=>{Tt.role&&k(T)}),"if",Fr,105,16)}S(()=>_(te,` ${Tt.subject??""} `)),d(De,U)};x(()=>g(Z,De=>{Tt.subject&&De(ye)}),"if",Fr,101,8)}var Be=i(Z,2);return S(()=>{Le(j,1,`text-xs px-2 py-0.5 rounded-full font-medium ${t(o)??""}`),Le(z,1,`fa-solid ${t(l)??""} mr-1`),_(re,t(p)),_(be,`${t(n)??""} tools`)}),X("click",Ee,w),X("click",Be,h),d(e,I),qt(D)}ar(["click"]);ba[c]="src/components/PendingActions.svelte";var Xd=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No pending actions</p>'),ba[c],[[65,12]]),ec=v(u('<div class="p-3 border border-border rounded-md mb-2 bg-surface-muted"><div class="text-xs uppercase tracking-wider text-primary-500 font-semibold mb-1"><i class="fa-solid fa-gear mr-1"></i> </div> <pre class="text-xs whitespace-pre-wrap my-1 text-text font-mono"> </pre> <div class="text-xs text-text-muted mb-2"> </div> <div class="text-[11px] text-text-subtle"> </div> <div class="flex gap-1.5 mt-2"><button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface text-success-500 hover:bg-success-500/10 hover:border-success-500 transition-colors"><i class="fa-solid fa-check mr-1"></i>Approve</button> <button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface text-error-500 hover:bg-error-500/10 hover:border-error-500 transition-colors"><i class="fa-solid fa-xmark mr-1"></i>Reject</button></div></div>'),ba[c],[[68,16,[[69,20,[[70,24]]],[72,20],[73,20],[74,20],[75,20,[[76,24,[[80,28]]],[82,24,[[86,28]]]]]]]]),tc=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><div class="flex justify-between items-center border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-clock-rotate-left mr-1.5"></i> Pending Actions</h2> <div class="flex gap-1.5 pr-3"><button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface text-success-500 hover:bg-success-500/10 hover:border-success-500 transition-colors">Approve All</button> <button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface text-error-500 hover:bg-error-500/10 hover:border-error-500 transition-colors">Reject All</button></div></div> <div class="p-3 max-h-96 overflow-y-auto custom-scroll"><!></div></section>'),ba[c],[[47,0,[[48,4,[[49,8,[[50,12]]],[52,8,[[53,12],[57,12]]]]],[63,4]]]]);function ba(e,r){Wt(new.target),Gt(r,!0,ba);let a=$(A(ht([])),"actions");async function n(){try{f(a,(await N(et("GET","/api/pending")))(),!0)}catch(se){console.error(...bt("error","loadPending:",se))}}async function o(se){(await N(et("POST",`/api/pending/${se}/approve`)))(),Mr()}async function l(se){(await N(et("POST",`/api/pending/${se}/reject`)))(),Mr()}async function p(){(await N(et("POST","/api/pending/approve-all")))(),Mr()}async function m(){(await N(et("POST","/api/pending/reject-all")))(),Mr()}function b(se){var Oe;const be=(Oe=se.action)==null?void 0:Oe.params;return be?JSON.stringify(be,null,2):"{}"}fr(()=>{ot.refreshCounter,n()});var C={...Ht()},y=tc(),w=s(y),h=i(s(w),2),D=s(h),I=i(D,2),Y=i(w,2),j=s(Y);{var z=se=>{var be=Xd();d(se,be)},re=se=>{var be=er(),Oe=We(be);x(()=>mt(Oe,17,()=>t(a),me=>me.id,(me,Se)=>{var Ce=ec(),Ee=s(Ce),Z=i(s(Ee),1,!0);var ye=i(Ee,2),Be=s(ye,!0);var De=i(ye,2),U=s(De,!0);var te=i(De,2),$e=s(te,!0);var T=i(te,2),k=s(T),R=i(k,2);S(ee=>{var W,le;_(Z,((W=t(Se).action)==null?void 0:W.tool)??"unknown"),_(Be,ee),_(U,t(Se).reasoning??((le=t(Se).action)==null?void 0:le.reasoning)??""),_($e,t(Se).proposed_at)},[()=>b(t(Se))]),X("click",k,function(){return o(t(Se).id)}),X("click",R,function(){return l(t(Se).id)}),d(me,Ce)}),"each",ba,67,12),d(se,be)};x(()=>g(j,se=>{O(t(a).length,0)?se(z):se(re,!1)}),"if",ba,64,8)}return X("click",D,p),X("click",I,m),d(e,y),qt(C)}ar(["click"]);function Oi(e){if(!e)return null;try{return/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/.test(e)?new Date(e.replace(" ","T")+"Z"):new Date(e)}catch{return null}}function Zi(e,r){const a=Oi(e);return!a||isNaN(a.getTime())?"":a.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}function ga(e,r){const a=Oi(e);return!a||isNaN(a.getTime())?e:a.toLocaleString(void 0,{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})}function _i(e,r){const a=Oi(e);if(!a||isNaN(a.getTime()))return e;const n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate()),l=new Date(o.getTime()-864e5),p=new Date(a.getFullYear(),a.getMonth(),a.getDate()),m=a.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"});return p.getTime()===o.getTime()?`Today ${m}`:p.getTime()===l.getTime()?`Yesterday ${m}`:ga(e)}Jr[c]="src/components/ActivityLog.svelte";var rc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No activity yet</p>'),Jr[c],[[35,12]]),ac=v(u('<br/><span class="text-text-muted"> </span>',1),Jr[c],[[43,28],[43,32]]),sc=v(u('<div class="flex items-start gap-2.5 py-2 border-b border-border-muted text-sm"><div></div> <div class="flex-1"><strong> </strong> <!></div> <div class="text-[11px] text-text-subtle whitespace-nowrap"> </div></div>'),Jr[c],[[38,16,[[39,20],[40,20,[[41,24]]],[46,20]]]]),ic=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted border-b border-border"><i class="fa-solid fa-list-check mr-1.5"></i> Activity Log</h2> <div class="p-3 max-h-96 overflow-y-auto custom-scroll"><!></div></section>'),Jr[c],[[29,0,[[30,4,[[31,8]]],[33,4]]]]);function Jr(e,r){Wt(new.target),Gt(r,!0,Jr);let a=$(A(ht([])),"entries");async function n(){try{f(a,(await N(et("GET","/api/activity?limit=30")))(),!0)}catch(w){console.error(...bt("error","loadActivity:",w))}}function o(w){return O(w,"ok")?"bg-success-500":O(w,"error")?"bg-error-500":"bg-warning-500"}fr(()=>{ot.refreshCounter,n()});var l={...Ht()},p=ic(),m=i(s(p),2),b=s(m);{var C=w=>{var h=rc();d(w,h)},y=w=>{var h=er(),D=We(h);x(()=>mt(D,17,()=>t(a),Ft,(I,Y)=>{var j=sc(),z=s(j),re=i(z,2),se=s(re),be=s(se,!0);var Oe=i(se),me=i(Oe);{var Se=Z=>{var ye=ac(),Be=i(We(ye)),De=s(Be,!0);S(U=>_(De,U),[()=>t(Y).detail.slice(0,200)]),d(Z,ye)};x(()=>g(me,Z=>{t(Y).detail&&Z(Se)}),"if",Jr,42,24)}var Ce=i(re,2),Ee=s(Ce,!0);S((Z,ye)=>{Le(z,1,`w-1.5 h-1.5 rounded-full mt-1.5 shrink-0 ${Z??""}`),_(be,t(Y).action_type),_(Oe,`: ${t(Y).summary??""} `),_(Ee,ye)},[()=>o(t(Y).status),()=>_i(t(Y).created_at)]),d(I,j)}),"each",Jr,37,12),d(w,h)};x(()=>g(b,w=>{O(t(a).length,0)?w(C):w(y,!1)}),"if",Jr,34,8)}return d(e,p),qt(l)}Mt[c]="src/components/LiveFeed.svelte";var nc=v(u('<span class="relative flex h-2.5 w-2.5"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-primary-500 opacity-75"></span> <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-primary-500"></span></span>'),Mt[c],[[119,16,[[120,20],[121,20]]]]),oc=v(u('<i class="fa-solid fa-bolt"></i>'),Mt[c],[[124,16]]),lc=v(u('<span class="text-[10px] bg-surface-muted text-text-subtle px-1.5 py-0.5 rounded-full normal-case tracking-normal font-normal"> </span>'),Mt[c],[[128,16]]),dc=v(u('<span class="text-[11px] text-primary-400 font-mono animate-pulse"><i class="fa-solid fa-gear fa-spin mr-1"></i> </span>'),Mt[c],[[136,16,[[137,20]]]]),cc=v(u('<span class="text-[11px] text-info-400 animate-pulse"><i class="fa-solid fa-brain mr-1"></i>thinking…</span>'),Mt[c],[[141,16,[[142,20]]]]),vc=v(u('<button class="text-[11px] text-text-subtle hover:text-text-muted transition-colors" title="Clear feed"><i class="fa-solid fa-xmark"></i></button>'),Mt[c],[[146,16,[[151,20]]]]),uc=v(u('<p class="text-text-subtle text-sm italic text-center py-6">No recent tool activity — events appear here in real time as the agent works.</p>'),Mt[c],[[160,16]]),fc=v(u('<div class="text-xs text-text-muted mt-0.5 truncate font-mono"> </div>'),Mt[c],[[173,36]]),pc=v(u('<div><i></i> <div class="flex-1 min-w-0"><div class="text-sm text-text leading-snug"> </div> <!></div> <div class="text-[10px] text-text-subtle whitespace-nowrap shrink-0 mt-0.5"> </div></div>'),Mt[c],[[166,24,[[167,28],[168,28,[[169,32]]],[178,28]]]]),xc=v(u('<div class="divide-y divide-border-muted"></div>'),Mt[c],[[164,16]]),mc=v(u('<div class="max-h-72 overflow-y-auto custom-scroll"><!></div>'),Mt[c],[[158,8]]),_c=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><div class="flex justify-between items-center border-b border-border"><button class="flex items-center gap-2 text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted hover:text-text transition-colors"><!> Tool Activity <!> <i></i></button> <div class="flex items-center gap-2 pr-3"><!> <!> <!></div></div> <!></section>'),Mt[c],[[112,0,[[113,4,[[114,8,[[132,12]]],[134,8]]]]]]);function Mt(e,r){Wt(new.target),Gt(r,!0,Mt);let a=$(A(!0),"expanded");os(async()=>{if(O(It.events.length,0))try{const U=(await N(et("GET","/api/tool-events?limit=50")))();for(const te of U)Yn(te)}catch(U){console.error(...bt("error","Failed to load buffered tool events:",U))}});function n(U){switch(U.type){case"thinking":return"fa-brain";case"tool_start":return"fa-play";case"tool_result":return U.success?"fa-circle-check":"fa-circle-xmark";case"approval_needed":return"fa-shield-halved";case"turn_complete":return"fa-flag-checkered";case"error":return"fa-triangle-exclamation";default:return"fa-circle"}}function o(U){switch(U.type){case"thinking":return"text-info-500";case"tool_start":return"text-primary-500";case"tool_result":return U.success?"text-success-500":"text-error-500";case"approval_needed":return"text-warning-500";case"turn_complete":return"text-success-400";case"error":return"text-error-500";default:return"text-text-muted"}}function l(U){switch(U.type){case"thinking":return"border-l-info-500";case"tool_start":return"border-l-primary-500";case"tool_result":return U.success?"border-l-success-500":"border-l-error-500";case"approval_needed":return"border-l-warning-500";case"turn_complete":return"border-l-success-400";case"error":return"border-l-error-500";default:return"border-l-border"}}function p(U){switch(U.type){case"thinking":return O(U.context,"follow_up_after_approval")?"Generating follow-up reply…":`Thinking (turn ${U.turn+1}/${U.max_turns})…`;case"tool_start":{const te=U.auto_approved?"auto":U.approved?"approved":"manual";return`Executing ${U.tool} [${te}]`}case"tool_result":return`${U.tool}: ${U.success?"success":"error"}`;case"approval_needed":return`${U.tool} needs approval`;case"turn_complete":{if(U.exhausted)return`Max turns exhausted (${U.turns_used})`;const te=U.pending_approvals?`, ${U.pending_approvals} awaiting approval`:"";return`Complete in ${U.turns_used} turn${O(U.turns_used,1)?"":"s"}${te}`}case"error":return U.message;default:return"Unknown event"}}function m(U){switch(U.type){case"tool_start":return U.reasoning||null;case"tool_result":return U.output_preview||null;case"approval_needed":return U.reasoning||null;default:return null}}function b(U){try{return new Date(U).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}const C=$(cr(()=>It.events.length>0),"hasEvents"),y=$(cr(()=>It.isThinking||O(It.activeTool,null,!1)),"isActive");var w={...Ht()},h=_c(),D=s(h),I=s(D),Y=s(I);{var j=U=>{var te=nc();d(U,te)},z=U=>{var te=oc();d(U,te)};x(()=>g(Y,U=>{t(y)?U(j):U(z,!1)}),"if",Mt,118,12)}var re=i(Y,2);{var se=U=>{var te=lc(),$e=s(te);S(()=>_($e,It.events.length)),d(U,te)};x(()=>g(re,U=>{t(C)&&U(se)}),"if",Mt,127,12)}var be=i(re,2),Oe=i(I,2),me=s(Oe);{var Se=U=>{var te=dc(),$e=i(s(te),1,!0);S(()=>_($e,It.activeTool)),d(U,te)};x(()=>g(me,U=>{It.activeTool&&U(Se)}),"if",Mt,135,12)}var Ce=i(me,2);{var Ee=U=>{var te=cc();d(U,te)};x(()=>g(Ce,U=>{It.isThinking&&!It.activeTool&&U(Ee)}),"if",Mt,140,12)}var Z=i(Ce,2);{var ye=U=>{var te=vc();X("click",te,function(){return Qn()}),d(U,te)};x(()=>g(Z,U=>{t(C)&&U(ye)}),"if",Mt,145,12)}var Be=i(D,2);{var De=U=>{var te=mc(),$e=s(te);{var T=R=>{var ee=uc();d(R,ee)},k=R=>{var ee=xc();x(()=>mt(ee,21,()=>It.events,Ft,(W,le,ke)=>{var Ae=pc(),q=s(Ae),B=i(q,2),L=s(B),K=s(L,!0);var ce=i(L,2);{var he=_e=>{var P=fc(),ae=s(P,!0);S((de,F)=>{Vt(P,"title",de),_(ae,F)},[()=>m(t(le))??void 0,()=>m(t(le))]),d(_e,P)},ge=cr(()=>m(t(le)));x(()=>g(ce,_e=>{t(ge)&&_e(he)}),"if",Mt,172,32)}var V=i(B,2),M=s(V,!0);S((_e,P,ae,de,F)=>{Le(Ae,1,`flex items-start gap-2.5 px-4 py-2.5 border-l-2 ${_e??""} ${O(ke,0)&&t(y)?"bg-surface-muted/50":""}`),Le(q,1,`fa-solid ${P??""} ${ae??""} text-xs mt-0.5 w-4 text-center shrink-0`),_(K,de),_(M,F)},[()=>l(t(le)),()=>n(t(le)),()=>o(t(le)),()=>p(t(le)),()=>b(t(le).timestamp)]),d(W,Ae)}),"each",Mt,165,20),d(R,ee)};x(()=>g($e,R=>{t(C)?R(k,!1):R(T)}),"if",Mt,159,12)}d(U,te)};x(()=>g(Be,U=>{t(a)&&U(De)}),"if",Mt,157,4)}return S(()=>Le(be,1,`fa-solid ${t(a)?"fa-chevron-up":"fa-chevron-down"} text-[10px] ml-1`)),X("click",I,function(){return f(a,!t(a))}),d(e,h),qt(w)}ar(["click"]);rr[c]="src/components/MemoryPanel.svelte";var bc=v(u("<button><i></i> </button>"),rr[c],[[68,12,[[73,16]]]]),gc=v(u('<div class="px-4 py-2 border-b border-border"><input type="text" placeholder="Search archival memory..." class="w-full px-2.5 py-1.5 border border-border rounded-md bg-background text-text text-sm outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-900 font-sans"/></div>'),rr[c],[[79,8,[[80,12]]]]),hc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">Error loading memory</p>'),rr[c],[[92,12]]),yc=v(u('<div class="whitespace-pre-wrap font-mono text-xs leading-relaxed"> </div>'),rr[c],[[94,12]]),wc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No conversation history</p>'),rr[c],[[97,16]]),kc=v(u('<div class="py-1.5 border-b border-border-muted text-sm"><strong> </strong> <span class="text-text-muted"> </span><br/> </div>'),rr[c],[[100,20,[[101,24],[102,24],[102,91]]]]),Tc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No archival entries</p>'),rr[c],[[109,16]]),$c=v(u('<div class="py-1.5 border-b border-border-muted text-sm"><span class="text-xs text-primary-500 font-semibold uppercase tracking-wider"> </span> <span class="text-text-muted text-[11px]"> </span><br/> </div>'),rr[c],[[112,20,[[113,24],[114,24],[114,104]]]]),Ec=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted border-b border-border"><i class="fa-solid fa-brain mr-1.5"></i> Memory</h2> <div class="flex px-4 border-b border-border"></div> <!> <div class="p-3 max-h-96 overflow-y-auto custom-scroll"><!></div></section>'),rr[c],[[62,0,[[63,4,[[64,8]]],[66,4],[90,4]]]]);function rr(e,r){Wt(new.target),Gt(r,!0,rr);let a=$(A(""),"content"),n=$(A(ht([])),"messages"),o=$(A(ht([])),"archivalEntries"),l=$(A(""),"searchQuery"),p=$(A(!1),"error");const m=[{id:"core",label:"Core",icon:"fa-microchip"},{id:"conversation",label:"Conversation",icon:"fa-comments"},{id:"archival",label:"Archival",icon:"fa-box-archive"}];function b(me){ot.currentMemoryTab=me}async function C(){f(p,!1);try{if(O(ot.currentMemoryTab,"core")){const me=(await N(et("GET","/api/memory/core")))();f(a,me.personality||"(empty)",!0),f(n,[],!0),f(o,[],!0)}else if(O(ot.currentMemoryTab,"conversation")){const me=(await N(et("GET","/api/memory/conversation")))();f(n,me,!0),f(a,""),f(o,[],!0)}else if(O(ot.currentMemoryTab,"archival")){const me=t(l)?`/api/memory/archival?q=${encodeURIComponent(t(l))}`:"/api/memory/archival",Se=(await N(et("GET",me)))();f(o,Se,!0),f(a,""),f(n,[],!0)}}catch(me){f(p,!0),console.error(...bt("error","loadMemory:",me))}}function y(me){O(me.key,"Enter")&&C()}fr(()=>{ot.refreshCounter,ot.currentMemoryTab,C()});var w={...Ht()},h=Ec(),D=i(s(h),2);x(()=>mt(D,21,()=>m,Ft,(me,Se)=>{var Ce=bc();let Ee;var Z=s(Ce),ye=i(Z);S(()=>{Ee=Le(Ce,1,"mem-tab",null,Ee,{active:O(ot.currentMemoryTab,t(Se).id)}),Le(Z,1,`fa-solid ${t(Se).icon??""} mr-1`),_(ye,` ${t(Se).label??""}`)}),X("click",Ce,function(){return b(t(Se).id)}),d(me,Ce)}),"each",rr,67,8);var I=i(D,2);{var Y=me=>{var Se=gc(),Ce=s(Se);X("keyup",Ce,y),St(Ce,function(){return t(l)},function(Z){f(l,Z)}),d(me,Se)};x(()=>g(I,me=>{O(ot.currentMemoryTab,"archival")&&me(Y)}),"if",rr,78,4)}var j=i(I,2),z=s(j);{var re=me=>{var Se=hc();d(me,Se)},se=me=>{var Se=yc(),Ce=s(Se);S(()=>_(Ce,t(a))),d(me,Se)},be=me=>{var Se=er(),Ce=We(Se);{var Ee=ye=>{var Be=wc();d(ye,Be)},Z=ye=>{var Be=er(),De=We(Be);x(()=>mt(De,17,()=>t(n),Ft,(U,te)=>{var $e=kc(),T=s($e),k=s(T,!0);var R=i(T,2),ee=s(R,!0);var W=i(R,2);S(le=>{_(k,t(te).role),_(ee,le),_(W,` ${t(te).content??""}`)},[()=>_i(t(te).created_at)]),d(U,$e)}),"each",rr,99,16),d(ye,Be)};x(()=>g(Ce,ye=>{O(t(n).length,0)?ye(Ee):ye(Z,!1)}),"if",rr,96,12)}d(me,Se)},Oe=me=>{var Se=er(),Ce=We(Se);{var Ee=ye=>{var Be=Tc();d(ye,Be)},Z=ye=>{var Be=er(),De=We(Be);x(()=>mt(De,17,()=>t(o),Ft,(U,te)=>{var $e=$c(),T=s($e),k=s(T,!0);var R=i(T,2),ee=s(R,!0);var W=i(R,2);S(le=>{_(k,t(te).category),_(ee,le),_(W,` ${t(te).content??""}`)},[()=>_i(t(te).created_at)]),d(U,$e)}),"each",rr,111,16),d(ye,Be)};x(()=>g(Ce,ye=>{O(t(o).length,0)?ye(Ee):ye(Z,!1)}),"if",rr,108,12)}d(me,Se)};x(()=>g(z,me=>{t(p)?me(re):O(ot.currentMemoryTab,"core")?me(se,1):O(ot.currentMemoryTab,"conversation")?me(be,2):O(ot.currentMemoryTab,"archival")&&me(Oe,3)}),"if",rr,91,8)}return d(e,h),qt(w)}ar(["click","keyup"]);Qr[c]="src/components/StatsPanel.svelte";var Sc=v(u('<i class="fa-regular fa-clock mr-1"></i> <br/>',1),Qr[c],[[48,20],[48,91]]),Cc=v(u("No ticks yet<br/>",1),Qr[c],[[50,32]]),Ac=v(u('<div class="grid grid-cols-2 gap-3"><div class="text-center"><div class="text-3xl font-bold text-primary-500"> </div> <div class="text-[11px] text-text-muted uppercase tracking-wider mt-0.5">Ticks</div></div> <div class="text-center"><div class="text-3xl font-bold text-primary-500"> </div> <div class="text-[11px] text-text-muted uppercase tracking-wider mt-0.5">Actions</div></div> <div class="text-center"><div class="text-3xl font-bold text-success-500"> </div> <div class="text-[11px] text-text-muted uppercase tracking-wider mt-0.5">Approved</div></div> <div class="text-center"><div class="text-3xl font-bold text-error-500"> </div> <div class="text-[11px] text-text-muted uppercase tracking-wider mt-0.5">Rejected</div></div></div> <div class="mt-3 text-xs text-text-muted"><!> <i class="fa-solid fa-power-off mr-1"></i> </div>',1),Qr[c],[[28,12,[[29,16,[[30,20],[31,20]]],[33,16,[[34,20],[35,20]]],[37,16,[[38,20],[39,20]]],[41,16,[[42,20],[43,20]]]]],[46,12,[[52,16]]]]),Pc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">Loading...</p>'),Qr[c],[[55,12]]),Oc=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted border-b border-border"><i class="fa-solid fa-chart-bar mr-1.5"></i> Stats</h2> <div class="p-3 max-h-96 overflow-y-auto custom-scroll"><!></div></section>'),Qr[c],[[22,0,[[23,4,[[24,8]]],[26,4]]]]);function Qr(e,r){Wt(new.target),Gt(r,!0,Qr);let a=$(A(null),"stats");async function n(){try{f(a,(await N(et("GET","/api/stats")))(),!0)}catch(y){console.error(...bt("error","loadStats:",y))}}fr(()=>{ot.refreshCounter,n()});var o={...Ht()},l=Oc(),p=i(s(l),2),m=s(p);{var b=y=>{var w=Ac(),h=We(w),D=s(h),I=s(D),Y=s(I),j=i(D,2),z=s(j),re=s(z),se=i(j,2),be=s(se),Oe=s(be),me=i(se,2),Se=s(me),Ce=s(Se),Ee=i(h,2),Z=s(Ee);{var ye=U=>{var te=Sc(),$e=i(We(te));S(()=>_($e,`Last tick: ${t(a).last_tick_at??""}`)),d(U,te)},Be=U=>{var te=Cc();d(U,te)};x(()=>g(Z,U=>{t(a).last_tick_at?U(ye):U(Be,!1)}),"if",Qr,47,16)}var De=i(Z,3);S(()=>{_(Y,t(a).total_ticks),_(re,t(a).total_actions),_(Oe,t(a).total_approved),_(Ce,t(a).total_rejected),_(De,`Started: ${t(a).started_at??""}`)}),d(y,w)},C=y=>{var w=Pc();d(y,w)};x(()=>g(m,y=>{t(a)?y(b):y(C,!1)}),"if",Qr,27,8)}return d(e,l),qt(o)}Bt[c]="src/components/ChatTab.svelte";var jc=v(u('<div class="flex items-center justify-center h-full"><div class="text-center text-text-subtle"><i class="fa-solid fa-comments text-3xl mb-3 block text-text-subtle"></i> <p class="text-sm">No messages yet. Say something to the agent.</p></div></div>'),Bt[c],[[92,12,[[93,16,[[94,20],[95,20]]]]]]),Lc=v(u('<div class="flex justify-end"><div class="max-w-[70%] min-w-[120px]"><div class="bg-primary-600 text-white rounded-lg rounded-br-sm px-3 py-2 text-sm whitespace-pre-wrap break-words"> </div> <div class="text-[10px] text-text-subtle mt-0.5 text-right"> </div></div></div>'),Bt[c],[[101,20,[[102,24,[[103,28],[106,28]]]]]]),Rc=v(u('<div class="flex justify-start"><div class="max-w-[70%] min-w-[120px]"><div class="bg-surface-elevated border border-border rounded-lg rounded-bl-sm px-3 py-2 text-sm whitespace-pre-wrap break-words"> </div> <div class="text-[10px] text-text-subtle mt-0.5"> </div></div></div>'),Bt[c],[[112,20,[[113,24,[[114,28],[117,28]]]]]]),Nc=v(u('<div class="flex justify-center"><div class="text-[11px] text-text-subtle italic px-3 py-1 bg-surface-muted rounded-full max-w-[80%] truncate"> </div></div>'),Bt[c],[[124,20,[[125,24]]]]),Dc=v(u('<i class="fa-solid fa-gear fa-spin mr-1.5 text-primary-500"></i> <span class="text-primary-400 font-mono"> </span> <span class="text-text-subtle ml-1">running…</span>',1),Bt[c],[[137,32],[138,32],[139,32]]),Ic=v(u('<i class="fa-solid fa-brain mr-1.5 text-info-500 animate-pulse"></i>Thinking…',1),Bt[c],[[141,32]]),Mc=v(u('<i class="fa-solid fa-circle-notch fa-spin mr-1.5"></i>Processing…',1),Bt[c],[[143,32]]),Fc=v(u('<div class="flex justify-start"><div class="min-w-[120px] max-w-[70%]"><div class="bg-surface-elevated border border-border rounded-lg rounded-bl-sm px-3 py-2 text-sm text-text-muted"><!></div></div></div>'),Bt[c],[[133,16,[[134,20,[[135,24]]]]]]),Uc=v(u("<!> <!>",1),Bt[c],[]),zc=v(u('<div class="mx-4 mb-2 px-3 py-2 rounded-md bg-error-950 border border-error-500/30 text-error-400 text-xs"><i class="fa-solid fa-triangle-exclamation mr-1"></i> </div>'),Bt[c],[[154,8,[[155,12]]]]),Bc=v(u('<i class="fa-solid fa-circle-notch fa-spin"></i>'),Bt[c],[[180,20]]),Gc=v(u('<i class="fa-solid fa-paper-plane"></i>'),Bt[c],[[182,20]]),qc=v(u(`<div class="flex flex-col h-[calc(100vh-140px)]"><div class="flex-1 overflow-y-auto custom-scroll p-4 space-y-3"><!></div> <!> <div class="border-t border-border bg-surface px-4 py-3"><div class="flex gap-2 items-end"><textarea placeholder="Type a message..." rows="1" class="flex-1 px-3 py-2 rounded-md border border-border bg-background text-text text-sm outline-none
                       focus:border-primary-500 focus:ring-1 focus:ring-primary-500/50 font-sans
                       placeholder:text-text-subtle disabled:opacity-50 disabled:cursor-not-allowed resize-none"></textarea> <button class="px-4 py-2 rounded-md bg-primary-600 text-white text-sm font-medium
                       hover:bg-primary-500 transition-colors
                       disabled:opacity-50 disabled:cursor-not-allowed shrink-0"><!></button></div></div></div>`),Bt[c],[[85,0,[[87,4],[160,4,[[161,8,[[162,12],[172,12]]]]]]]]);function Bt(e,r){Wt(new.target),Gt(r,!0,Bt);let a=$(A(ht([])),"messages"),n=$(A(""),"input"),o=$(A(!1),"sending"),l=$(A(""),"error"),p=$(A(void 0),"messagesEl");async function m(){try{f(a,(await N(et("GET","/api/memory/conversation")))(),!0),(await N(Ms()))(),b()}catch(Z){console.error(...bt("error","loadChat:",Z))}}function b(){t(p)&&(t(p).scrollTop=t(p).scrollHeight)}async function C(){const Z=t(n).trim();if(!(!Z||t(o))){f(l,""),f(o,!0),f(n,""),f(a,[...t(a),{id:Date.now(),role:"user",content:Z,created_at:new Date().toISOString()}],!0),(await N(Ms()))(),b();try{const ye={message:Z};Tt.userId&&(ye.user_id=Tt.userId);const Be=(await N(et("POST","/api/chat",ye)))();(await N(m()))()}catch(ye){f(l,(ye==null?void 0:ye.message)||"Failed to send message",!0),(await N(m()))()}finally{f(o,!1),(await N(Ms()))(),b()}}}function y(Z){O(Z.key,"Enter")&&!Z.shiftKey&&(Z.preventDefault(),C())}os(()=>{m()}),fr(()=>{ot.refreshCounter,t(o)||m()});var w={...Ht()},h=qc(),D=s(h),I=s(D);{var Y=Z=>{var ye=jc();d(Z,ye)},j=Z=>{var ye=Uc(),Be=We(ye);x(()=>mt(Be,17,()=>t(a),te=>te.id,(te,$e)=>{var T=er(),k=We(T);{var R=le=>{var ke=Lc(),Ae=s(ke),q=s(Ae),B=s(q,!0);var L=i(q,2),K=s(L,!0);S(ce=>{_(B,t($e).content),_(K,ce)},[()=>Zi(t($e).created_at)]),d(le,ke)},ee=le=>{var ke=Rc(),Ae=s(ke),q=s(Ae),B=s(q,!0);var L=i(q,2),K=s(L,!0);S(ce=>{_(B,t($e).content),_(K,ce)},[()=>Zi(t($e).created_at)]),d(le,ke)},W=le=>{var ke=Nc(),Ae=s(ke),q=s(Ae,!0);S(()=>_(q,t($e).content)),d(le,ke)};x(()=>g(k,le=>{O(t($e).role,"user")?le(R):O(t($e).role,"assistant")?le(ee,1):le(W,!1)}),"if",Bt,100,16)}d(te,T)}),"each",Bt,99,12);var De=i(Be,2);{var U=te=>{var $e=Fc(),T=s($e),k=s(T),R=s(k);{var ee=ke=>{var Ae=Dc(),q=i(We(Ae),2),B=s(q);S(()=>_(B,It.activeTool)),d(ke,Ae)},W=ke=>{var Ae=Ic();d(ke,Ae)},le=ke=>{var Ae=Mc();d(ke,Ae)};x(()=>g(R,ke=>{It.activeTool?ke(ee):It.isThinking?ke(W,1):ke(le,!1)}),"if",Bt,136,28)}d(te,$e)};x(()=>g(De,te=>{t(o)&&te(U)}),"if",Bt,132,12)}d(Z,ye)};x(()=>g(I,Z=>{O(t(a).length,0)&&!t(o)?Z(Y):Z(j,!1)}),"if",Bt,91,8)}Yl(D,Z=>f(p,Z),()=>t(p));var z=i(D,2);{var re=Z=>{var ye=zc(),Be=i(s(ye),1,!0);S(()=>_(Be,t(l))),d(Z,ye)};x(()=>g(z,Z=>{t(l)&&Z(re)}),"if",Bt,153,4)}var se=i(z,2),be=s(se),Oe=s(be),me=i(Oe,2),Se=s(me);{var Ce=Z=>{var ye=Bc();d(Z,ye)},Ee=Z=>{var ye=Gc();d(Z,ye)};x(()=>g(Se,Z=>{t(o)?Z(Ce):Z(Ee,!1)}),"if",Bt,179,16)}return S(Z=>{Oe.disabled=t(o),me.disabled=Z},[()=>t(o)||!t(n).trim()]),X("keydown",Oe,y),St(Oe,function(){return t(n)},function(ye){f(n,ye)}),X("click",me,C),d(e,h),qt(w)}ar(["keydown","click"]);it[c]="src/components/GoalsTab.svelte";var Kc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">Error loading goals</p>'),it[c],[[163,12]]),Vc=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No goals yet. The agent will create goals when you assign background tasks.</p>'),it[c],[[165,12]]),Wc=v(u('<span class="text-[11px] px-1.5 py-0.5 rounded-full bg-warning-500/15 text-warning-500 font-medium shrink-0"> </span>'),it[c],[[180,32]]),Hc=v(u('<div class="flex items-center gap-1.5"><div class="w-20 h-1.5 bg-border rounded-full overflow-hidden"><div class="h-full bg-success-500 rounded-full transition-all"></div></div> <span class="text-[11px] text-text-muted font-mono"> </span></div>'),it[c],[[187,32,[[188,36,[[189,40]]],[194,36]]]]),Jc=v(u('<div class="text-sm text-text-muted px-4 pb-3 -mt-1"> </div>'),it[c],[[206,24]]),Yc=v(u('<div class="text-sm text-text-muted px-4 pt-3 pb-2"> </div>'),it[c],[[213,32]]),Qc=v(u('<button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface text-warning-500 hover:bg-warning-500/10 hover:border-warning-500 transition-colors"><i class="fa-solid fa-pause mr-1"></i>Pause</button> <button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface text-error-400 hover:bg-error-500/10 hover:border-error-500 transition-colors"><i class="fa-solid fa-ban mr-1"></i>Cancel</button>',1),it[c],[[219,36,[[223,40]]],[225,36,[[229,40]]]]),Zc=v(u('<button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface text-success-500 hover:bg-success-500/10 hover:border-success-500 transition-colors"><i class="fa-solid fa-play mr-1"></i>Resume</button> <button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface text-error-400 hover:bg-error-500/10 hover:border-error-500 transition-colors"><i class="fa-solid fa-ban mr-1"></i>Cancel</button>',1),it[c],[[232,36,[[236,40]]],[238,36,[[242,40]]]]),Xc=v(u('<div class="p-4 text-sm text-text-subtle italic text-center"><i class="fa-solid fa-spinner fa-spin mr-1"></i>Loading...</div>'),it[c],[[248,32,[[249,36]]]]),ev=v(u('<div class="mx-4 mt-3 p-3 bg-primary-950/40 border border-primary-800/30 rounded-md"><div class="text-[11px] font-semibold uppercase tracking-wider text-primary-400 mb-1"><i class="fa-solid fa-brain mr-1"></i> Self-Reflection</div> <div class="text-xs text-text-muted leading-relaxed"> </div></div>'),it[c],[[254,36,[[255,40,[[256,44]]],[258,40]]]]),tv=v(u('<p class="text-text-subtle text-sm italic text-center py-2">No tasks defined yet.</p>'),it[c],[[272,40]]),rv=v(u('<div class="text-xs text-text-muted mb-1"> </div>'),it[c],[[292,60]]),av=v(u('<div class="text-[10px] text-text-subtle"> </div>'),it[c],[[295,60]]),sv=v(u('<div class="mt-1.5 p-2 bg-background border border-border rounded text-[11px] font-mono text-text-muted max-h-[120px] overflow-auto whitespace-pre-wrap break-all leading-relaxed"> </div>'),it[c],[[300,60]]),iv=v(u('<div class="mt-1 text-[10px] text-accent-300 font-mono"> </div>'),it[c],[[305,60]]),nv=v(u('<div class="flex items-start gap-3 p-3 bg-surface border border-border rounded-md"><div class="shrink-0 mt-0.5"><span><i></i></span></div> <div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-0.5"><span class="text-sm font-medium"> </span> <span> </span></div> <!> <!> <!> <!></div></div>'),it[c],[[278,48,[[279,52,[[280,56,[[281,60]]]]],[284,52,[[285,56,[[286,60],[287,60]]]]]]]]),ov=v(u('<div class="space-y-2"></div>'),it[c],[[276,40]]),lv=v(u('<span class="text-text-subtle">Completed</span> <span class="text-text-muted font-mono"> </span>',1),it[c],[[324,44],[325,44]]),dv=v(u('<!> <div class="p-4"><div class="text-xs font-semibold uppercase tracking-wider text-text-muted mb-3"><i class="fa-solid fa-list-check mr-1"></i> </div> <!></div> <div class="px-4 pb-4"><div class="grid grid-cols-2 gap-x-4 gap-y-1 text-[11px]"><span class="text-text-subtle">Created</span> <span class="text-text-muted font-mono"> </span> <span class="text-text-subtle">Updated</span> <span class="text-text-muted font-mono"> </span> <!> <span class="text-text-subtle">ID</span> <span class="text-text-muted font-mono truncate"> </span></div></div>',1),it[c],[[265,32,[[266,36,[[267,40]]]]],[317,32,[[318,36,[[319,40],[320,40],[321,40],[322,40],[327,40],[328,40]]]]]]),cv=v(u('<div class="border-t border-border"><!> <div class="flex items-center gap-2 px-4 py-2 border-b border-border"><!></div> <!></div>'),it[c],[[211,24,[[217,28]]]]),vv=v(u('<div class="border border-border rounded-md mb-3 bg-surface-muted overflow-hidden"><button class="w-full p-4 flex justify-between items-center hover:bg-surface-elevated/40 transition-colors cursor-pointer text-left"><div class="flex items-center gap-2 flex-1 min-w-0"><i></i> <span class="text-[15px] font-semibold truncate"> </span> <!></div> <div class="flex items-center gap-2 shrink-0 ml-3"><!> <span><i></i> </span></div></button> <!> <!></div>'),it[c],[[170,16,[[172,20,[[176,24,[[177,28],[178,28]]],[185,24,[[199,28,[[200,32]]]]]]]]]]),uv=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><div class="flex justify-between items-center border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-bullseye mr-1.5"></i> Goals &amp; Tasks</h2> <div class="flex items-center gap-2 pr-3"><select class="text-xs px-2 py-1 border border-border rounded-md bg-surface text-text outline-none focus:border-primary-500"><option>All statuses</option><option>Active</option><option>Paused</option><option>Completed</option><option>Failed</option><option>Cancelled</option></select> <span class="text-xs text-text-muted"> </span> <button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-arrows-rotate mr-1"></i> Refresh</button></div></div> <div class="p-3"><!></div></section>'),it[c],[[131,0,[[132,4,[[133,8,[[134,12]]],[136,8,[[137,12,[[142,16],[143,16],[144,16],[145,16],[146,16],[147,16]]],[149,12],[152,12,[[156,16]]]]]]],[161,4]]]]);function it(e,r){Wt(new.target),Gt(r,!0,it);let a=$(A(ht([])),"goals"),n=$(A(!1),"error"),o=$(A(""),"statusFilter"),l=$(A(null),"expandedGoal"),p=$(A(null),"goalDetail"),m=$(A(!1),"detailLoading");async function b(){f(n,!1);try{const T=t(o)?`?status=${t(o)}`:"";f(a,(await N(et("GET",`/api/goals${T}`)))(),!0)}catch(T){f(n,!0),console.error(...bt("error","loadGoals:",T))}}async function C(T){f(m,!0);try{f(p,(await N(et("GET",`/api/goals/${encodeURIComponent(T)}`)))(),!0)}catch(k){console.error(...bt("error","loadGoalDetail:",k))}finally{f(m,!1)}}async function y(T,k){try{(await N(et("PUT",`/api/goals/${encodeURIComponent(T)}/status`,{status:k})))(),b(),O(t(l),T)&&C(T)}catch(R){alert("Failed to update status: "+R.message)}}function w(T){O(t(l),T)?(f(l,null),f(p,null)):(f(l,T,!0),C(T))}function h(T){switch(T){case"active":return"bg-primary-500/15 text-primary-400";case"paused":return"bg-warning-500/15 text-warning-500";case"completed":return"bg-success-500/15 text-success-500";case"failed":return"bg-error-500/12 text-error-400";case"cancelled":return"bg-text-subtle/10 text-text-subtle";case"in_progress":return"bg-primary-500/15 text-primary-400";case"pending":return"bg-text-subtle/10 text-text-muted";case"skipped":return"bg-text-subtle/10 text-text-subtle";default:return"bg-text-subtle/10 text-text-subtle"}}function D(T){switch(T){case"active":return"fa-circle-play";case"paused":return"fa-circle-pause";case"completed":return"fa-circle-check";case"failed":return"fa-circle-xmark";case"cancelled":return"fa-ban";case"in_progress":return"fa-spinner fa-spin";case"pending":return"fa-clock";case"skipped":return"fa-forward";default:return"fa-question"}}fr(()=>{O(ot.currentTab,"goals")&&(ot.refreshCounter,b())});var I={...Ht()},Y=uv(),j=s(Y),z=i(s(j),2),re=s(z),se=s(re);se.value=se.__value="";var be=i(se);be.value=be.__value="active";var Oe=i(be);Oe.value=Oe.__value="paused";var me=i(Oe);me.value=me.__value="completed";var Se=i(me);Se.value=Se.__value="failed";var Ce=i(Se);Ce.value=Ce.__value="cancelled";var Ee=i(re,2),Z=s(Ee),ye=i(Ee,2),Be=i(j,2),De=s(Be);{var U=T=>{var k=Kc();d(T,k)},te=T=>{var k=Vc();d(T,k)},$e=T=>{var k=er(),R=We(k);x(()=>mt(R,17,()=>t(a),ee=>ee.id,(ee,W)=>{var le=vv(),ke=s(le),Ae=s(ke),q=s(Ae),B=i(q,2),L=s(B,!0);var K=i(B,2);{var ce=pe=>{var ie=Wc(),H=s(ie);S(()=>_(H,`P${t(W).priority??""}`)),d(pe,ie)};x(()=>g(K,pe=>{t(W).priority>0&&pe(ce)}),"if",it,179,28)}var he=i(Ae,2),ge=s(he);{var V=pe=>{var ie=Hc(),H=s(ie),Q=s(H);var E=i(H,2),J=s(E);S(()=>{us(Q,`width: ${t(W).total_tasks>0?t(W).completed_tasks/t(W).total_tasks*100:0}%`),_(J,`${t(W).completed_tasks??""}/${t(W).total_tasks??""}`)}),d(pe,ie)};x(()=>g(ge,pe=>{t(W).total_tasks>0&&pe(V)}),"if",it,186,28)}var M=i(ge,2),_e=s(M),P=i(_e,1,!0);var ae=i(ke,2);{var de=pe=>{var ie=Jc(),H=s(ie,!0);S(()=>_(H,t(W).description)),d(pe,ie)};x(()=>g(ae,pe=>{t(W).description&&O(t(l),t(W).id,!1)&&pe(de)}),"if",it,205,20)}var F=i(ae,2);{var ne=pe=>{var ie=cv(),H=s(ie);{var Q=Ne=>{var Fe=Yc(),Ie=s(Fe,!0);S(()=>_(Ie,t(W).description)),d(Ne,Fe)};x(()=>g(H,Ne=>{t(W).description&&Ne(Q)}),"if",it,212,28)}var E=i(H,2),J=s(E);{var xe=Ne=>{var Fe=Qc(),Ie=We(Fe),fe=i(Ie,2);X("click",Ie,function(){return y(t(W).id,"paused")}),X("click",fe,function(){return y(t(W).id,"cancelled")}),d(Ne,Fe)},oe=Ne=>{var Fe=Zc(),Ie=We(Fe),fe=i(Ie,2);X("click",Ie,function(){return y(t(W).id,"active")}),X("click",fe,function(){return y(t(W).id,"cancelled")}),d(Ne,Fe)};x(()=>g(J,Ne=>{O(t(W).status,"active")?Ne(xe):O(t(W).status,"paused")&&Ne(oe,1)}),"if",it,218,32)}var ue=i(E,2);{var Te=Ne=>{var Fe=Xc();d(Ne,Fe)},ze=Ne=>{var Fe=dv(),Ie=We(Fe);{var fe=Qe=>{var ct=ev(),lt=i(s(ct),2),at=s(lt,!0);S(()=>_(at,t(p).goal.reflection)),d(Qe,ct)};x(()=>g(Ie,Qe=>{t(p).goal.reflection&&Qe(fe)}),"if",it,253,32)}var we=i(Ie,2),Pe=s(we),He=i(s(Pe));var Ge=i(Pe,2);{var rt=Qe=>{var ct=tv();d(Qe,ct)},gt=Qe=>{var ct=ov();x(()=>mt(ct,23,()=>t(p).tasks,lt=>lt.id,(lt,at)=>{var wt=nv(),Dt=s(wt),Yt=s(Dt),kt=s(Yt);var Pt=i(Dt,2),Ke=s(Pt),Ze=s(Ke),Ct=s(Ze,!0);var Qt=i(Ze,2),Ut=s(Qt,!0);var Me=i(Ke,2);{var tt=Rt=>{var Et=rv(),Zt=s(Et,!0);S(()=>_(Zt,t(at).description)),d(Rt,Et)};x(()=>g(Me,Rt=>{t(at).description&&Rt(tt)}),"if",it,291,56)}var Lt=i(Me,2);{var At=Rt=>{var Et=av(),Zt=s(Et);S(mr=>_(Zt,`Depends on: ${mr??""}`),[()=>t(at).depends_on.join(", ")]),d(Rt,Et)};x(()=>g(Lt,Rt=>{t(at).depends_on.length>0&&Rt(At)}),"if",it,294,56)}var tr=i(Lt,2);{var Tr=Rt=>{var Et=sv(),Zt=s(Et,!0);S(()=>_(Zt,t(at).result)),d(Rt,Et)};x(()=>g(tr,Rt=>{t(at).result&&Rt(Tr)}),"if",it,299,56)}var or=i(tr,2);{var $r=Rt=>{var Et=iv(),Zt=s(Et);S(mr=>_(Zt,`Tool: ${mr??""}`),[()=>JSON.stringify(t(at).tool_call)]),d(Rt,Et)};x(()=>g(or,Rt=>{t(at).tool_call&&Rt($r)}),"if",it,304,56)}S((Rt,Et,Zt)=>{Le(Yt,1,`inline-flex items-center justify-center w-6 h-6 rounded-full text-[11px] font-semibold ${Rt??""}`),Le(kt,1,`fa-solid ${Et??""}`),_(Ct,t(at).title),Le(Qt,1,`text-[10px] px-1.5 py-0.5 rounded-full ${Zt??""}`),_(Ut,t(at).status)},[()=>h(t(at).status),()=>D(t(at).status),()=>h(t(at).status)]),d(lt,wt)}),"each",it,277,44),d(Qe,ct)};x(()=>g(Ge,Qe=>{O(t(p).tasks.length,0)?Qe(rt):Qe(gt,!1)}),"if",it,271,36)}var qe=i(we,2),je=s(qe),Ve=i(s(je),2),ft=s(Ve,!0);var Nt=i(Ve,4),Kt=s(Nt,!0);var Xe=i(Nt,2);{var Ye=Qe=>{var ct=lv(),lt=i(We(ct),2),at=s(lt,!0);S(wt=>_(at,wt),[()=>ga(t(p).goal.completed_at)]),d(Qe,ct)};x(()=>g(Xe,Qe=>{t(p).goal.completed_at&&Qe(Ye)}),"if",it,323,40)}var yt=i(Xe,4),st=s(yt,!0);S((Qe,ct)=>{_(He,` Tasks (${t(p).tasks.length??""})`),_(ft,Qe),_(Kt,ct),Vt(yt,"title",t(p).goal.id),_(st,t(p).goal.id)},[()=>ga(t(p).goal.created_at),()=>ga(t(p).goal.updated_at)]),d(Ne,Fe)};x(()=>g(ue,Ne=>{t(m)?Ne(Te):t(p)&&Ne(ze,1)}),"if",it,247,28)}d(pe,ie)};x(()=>g(F,pe=>{O(t(l),t(W).id)&&pe(ne)}),"if",it,210,20)}S((pe,ie)=>{Le(q,1,`fa-solid fa-chevron-right text-[10px] text-text-subtle transition-transform ${O(t(l),t(W).id)?"rotate-90":""}`),_(L,t(W).title),Le(M,1,`text-[11px] px-2 py-0.5 rounded-full font-medium ${pe??""}`),Le(_e,1,`fa-solid ${ie??""} mr-1`),_(P,t(W).status)},[()=>h(t(W).status),()=>D(t(W).status)]),X("click",ke,function(){return w(t(W).id)}),d(ee,le)}),"each",it,169,12),d(T,k)};x(()=>g(De,T=>{t(n)?T(U):O(t(a).length,0)?T(te,1):T($e,!1)}),"if",it,162,8)}return S(()=>_(Z,`${t(a).length??""} goal${O(t(a).length,1,!1)?"s":""}`)),X("change",re,function(){return b()}),Xs(re,function(){return t(o)},function(k){f(o,k)}),X("click",ye,b),d(e,Y),qt(I)}ar(["change","click"]);as[c]="src/components/CredentialRow.svelte";var fv=v(u('<button title="Remove" class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface text-error-500 hover:bg-error-500/10 hover:border-error-500 transition-colors"><i class="fa-solid fa-trash-can"></i></button>'),as[c],[[90,12,[[95,16]]]]),pv=v(u('<div class="flex items-center gap-2 mb-2 text-sm"><div></div> <div class="font-mono text-xs min-w-[200px] shrink-0 text-accent-300"> </div> <input type="password" class="flex-1 px-2 py-1 border border-border rounded-md bg-background text-text text-xs font-mono outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-900 placeholder:text-text-subtle"/> <div class="flex gap-1 shrink-0"><button title="Save" class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface text-success-500 hover:bg-success-500/10 hover:border-success-500 transition-colors"><i class="fa-solid fa-floppy-disk"></i></button> <!></div></div>'),as[c],[[66,0,[[67,4],[68,4],[74,4],[81,4,[[82,8,[[87,12]]]]]]]]);function as(e,r){Wt(new.target),Gt(r,!0,as);let a=$(A(""),"inputValue");function n(){return r.credential.configured?"bg-success-500":r.credential.required?"bg-error-500":"bg-warning-500"}function o(){return r.credential.configured?"Configured":r.credential.required?"Required":"Optional"}function l(){return r.credential.configured?"(configured - enter new value to update)":r.credential.description||"Enter value..."}async function p(){const se=t(a).trim();if(se)try{(await N(et("PUT",`/api/skills/${encodeURIComponent(r.skillName)}/credentials`,{key:r.credential.name,value:se})))(),f(a,""),r.onchange()}catch(be){console.error(...bt("error","saveCredential:",be)),alert("Failed to save credential: "+be.message)}}async function m(){if(confirm(`Remove credential "${r.credential.name}" from "${r.skillName}"?`))try{(await N(et("DELETE",`/api/skills/${encodeURIComponent(r.skillName)}/credentials/${encodeURIComponent(r.credential.name)}`)))(),r.onchange()}catch(se){console.error(...bt("error","deleteCredential:",se)),alert("Failed to remove credential: "+se.message)}}function b(se){O(se.key,"Enter")&&p()}var C={...Ht()},y=pv(),w=s(y),h=i(w,2),D=s(h),I=i(h,2),Y=i(I,2),j=s(Y),z=i(j,2);{var re=se=>{var be=fv();X("click",be,m),d(se,be)};x(()=>g(z,se=>{r.credential.configured&&se(re)}),"if",as,89,8)}return S((se,be,Oe)=>{Le(w,1,`w-2 h-2 rounded-full shrink-0 ${se??""}`),Vt(w,"title",be),Vt(h,"title",r.credential.description),_(D,r.credential.label||r.credential.name),Vt(I,"placeholder",Oe)},[n,o,l]),X("keyup",I,b),St(I,function(){return t(a)},function(be){f(a,be)}),X("click",j,p),d(e,y),qt(C)}ar(["keyup","click"]);Ue[c]="src/components/SkillCard.svelte";var xv=v(u('<span class="text-[11px] px-2 py-0.5 rounded-full font-medium bg-primary-950 text-primary-400"><i class="fa-solid fa-server mr-1"></i>daemon</span>'),Ue[c],[[201,16,[[202,20]]]]),mv=v(u('<span class="text-[11px] px-2 py-0.5 rounded-full font-medium bg-warning-500/15 text-warning-500"><i class="fa-solid fa-bolt mr-1"></i>oneshot</span>'),Ue[c],[[205,16,[[206,20]]]]),_v=v(u('<span class="text-[11px] px-2 py-0.5 rounded-full font-medium bg-text-subtle/10 text-text-subtle"><i class="fa-solid fa-ban mr-1"></i>disabled</span>'),Ue[c],[[211,16,[[212,20]]]]),bv=v(u('<span class="text-[11px] px-2 py-0.5 rounded-full font-medium bg-success-500/15 text-success-500"><i class="fa-solid fa-circle-check mr-1"></i>running</span>'),Ue[c],[[215,16,[[216,20]]]]),gv=v(u('<span class="text-[11px] px-2 py-0.5 rounded-full font-medium bg-error-500/12 text-error-400"><i class="fa-solid fa-circle-stop mr-1"></i>stopped</span>'),Ue[c],[[219,16,[[220,20]]]]),hv=v(u('<span class="text-[11px] px-2 py-0.5 rounded-full font-medium bg-violet-900/30 text-violet-400 border border-violet-800/40"><i class="fa-solid fa-plug mr-1"></i>ext</span>'),Ue[c],[[225,16,[[226,20]]]]),yv=v(u('<span class="text-[11px] text-text-subtle font-mono"> </span>'),Ue[c],[[231,16]]),wv=v(u('<div class="text-sm text-text-muted px-4 pb-3 -mt-1"> </div>'),Ue[c],[[237,8]]),kv=v(u('<div class="text-sm text-text-muted px-4 pt-3 pb-2"> </div>'),Ue[c],[[244,16]]),Tv=v(u('<i class="fa-solid fa-power-off mr-1"></i>Disable',1),Ue[c],[[254,24]]),$v=v(u('<i class="fa-solid fa-play mr-1"></i>Enable',1),Ue[c],[[256,24]]),Ev=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i>Deleting...',1),Ue[c],[[278,24]]),Sv=v(u('<i class="fa-solid fa-trash-can mr-1"></i>Delete',1),Ue[c],[[280,24]]),Cv=v(u('<div class="p-4 text-sm text-text-subtle italic text-center"><i class="fa-solid fa-spinner fa-spin mr-1"></i>Loading detail...</div>'),Ue[c],[[286,16,[[287,20]]]]),Av=v(u('<div class="p-4 text-sm text-error-400 italic text-center"> </div>'),Ue[c],[[290,16]]),Pv=v(u('<button><i class="fa-solid fa-plug mr-1"></i>Extension</button>'),Ue[c],[[313,24,[[317,28]]]]),Ov=v(u('<div class="flex items-center gap-2 mb-1.5 text-xs"><span class="font-mono text-accent-300 min-w-[180px]"> </span> <span class="flex-1 font-mono text-text-muted truncate"> </span> <button title="Remove" class="px-2 py-0.5 text-xs border border-border rounded bg-surface text-error-500 hover:bg-error-500/10 hover:border-error-500 transition-colors shrink-0"><i class="fa-solid fa-trash-can"></i></button></div>'),Ue[c],[[344,36,[[345,40],[346,40],[347,40,[[352,44]]]]]]),jv=v(u('<div class="border-t border-border pt-3 mb-3"><div class="text-xs font-semibold uppercase tracking-wider text-primary-400 mb-2"><i class="fa-solid fa-gear mr-1"></i> Environment Variables</div> <!> <div class="flex items-center gap-2 mt-2 text-xs"><input type="text" placeholder="KEY" class="w-[180px] px-2 py-1 border border-border rounded bg-background text-text text-xs font-mono outline-none focus:border-primary-500 placeholder:text-text-subtle"/> <input type="text" placeholder="value" class="flex-1 px-2 py-1 border border-border rounded bg-background text-text text-xs font-mono outline-none focus:border-primary-500 placeholder:text-text-subtle"/> <button class="px-2.5 py-1 text-xs border border-border rounded bg-surface text-success-500 hover:bg-success-500/10 hover:border-success-500 transition-colors shrink-0"><i class="fa-solid fa-plus mr-1"></i>Add</button></div></div>'),Ue[c],[[339,28,[[340,32,[[341,36]]],[358,32,[[359,36],[365,36],[371,36,[[375,40]]]]]]]]),Lv=v(u('<div class="border-t border-border pt-3"><div class="text-xs font-semibold uppercase tracking-wider text-accent-500 mb-2"><i class="fa-solid fa-key mr-1"></i> Credentials</div> <!></div>'),Ue[c],[[383,28,[[384,32,[[385,36]]]]]]),Rv=v(u('<div class="grid grid-cols-2 gap-x-4 gap-y-1 mb-4 text-xs"><div class="text-text-muted">Entrypoint</div> <div class="font-mono text-accent-300"> </div> <div class="text-text-muted">Directory</div> <div class="font-mono text-accent-300 truncate"> </div> <div class="text-text-muted">Type</div> <div> </div> <div class="text-text-muted">Enabled</div> <div> </div></div> <!> <!>',1),Ue[c],[[326,24,[[327,28],[328,28],[329,28],[330,28],[331,28],[332,28],[333,28],[334,28]]]]),Nv=v(u('<div class="p-4 text-sm text-text-subtle italic text-center"><i class="fa-solid fa-spinner fa-spin mr-1"></i>Loading...</div>'),Ue[c],[[407,32,[[408,36]]]]),Dv=v(u('<pre class="bg-background border border-border rounded-md p-3 text-[11px] font-mono text-text-muted max-h-[400px] overflow-auto whitespace-pre-wrap break-all leading-relaxed"> </pre>'),Ue[c],[[411,32]]),Iv=v(u('<div class="relative"><div class="flex justify-between items-center mb-2"><span class="text-xs text-text-muted">Last 300 lines of <span class="font-mono">skill.log</span></span> <button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-arrows-rotate mr-1"></i>Refresh</button></div> <!></div>'),Ue[c],[[394,24,[[395,28,[[396,32,[[397,54]]],[399,32,[[403,36]]]]]]]]),Mv=v(u('<div><div class="text-xs font-semibold uppercase tracking-wider text-violet-400 mb-2"><i class="fa-solid fa-window-maximize mr-1"></i> Skill Panel</div> <div class="bg-background border border-border rounded-md overflow-hidden"><iframe class="w-full border-0" style="min-height: 300px;" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe></div></div>'),Ue[c],[[419,32,[[420,36,[[421,40]]],[423,36,[[424,40]]]]]]),Fv=v(u('<div class="flex items-center gap-2"><a target="_blank" class="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md border border-violet-800/50 bg-violet-900/20 text-violet-400 hover:bg-violet-900/40 transition-colors"><i class="fa-solid fa-arrow-up-right-from-square"></i> Open full page</a></div>'),Ue[c],[[437,32,[[438,36,[[443,40]]]]]]),Uv=v(u('<div class="flex items-center gap-2 text-xs font-mono"><span class="px-1.5 py-0.5 rounded bg-violet-900/30 text-violet-300 border border-violet-800/40 min-w-[48px] text-center"> </span> <span class="text-text-muted"> </span></div>'),Ue[c],[[456,44,[[457,48],[460,48]]]]),zv=v(u('<div><div class="text-xs font-semibold uppercase tracking-wider text-violet-400 mb-2"><i class="fa-solid fa-route mr-1"></i> </div> <div class="space-y-1"></div></div>'),Ue[c],[[450,32,[[451,36,[[452,40]]],[454,36]]]]),Bv=v(u('<p class="text-sm text-text-subtle italic text-center py-4">This skill has an extension but no UI panel or routes registered.</p>'),Ue[c],[[468,32]]),Gv=v(u('<div class="space-y-4"><!> <!> <!> <!></div>'),Ue[c],[[416,24]]),qv=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i>Saving...',1),Ue[c],[[486,40]]),Kv=v(u('<i class="fa-solid fa-floppy-disk mr-1"></i>Save',1),Ue[c],[[488,40]]),Vv=v(u('<div class="text-xs text-error-400 mb-2 p-2 bg-error-500/10 border border-error-500/30 rounded"><i class="fa-solid fa-triangle-exclamation mr-1"></i> </div>'),Ue[c],[[493,32,[[494,36]]]]),Wv=v(u('<div class="text-xs text-success-500 mb-2 p-2 bg-success-500/10 border border-success-500/30 rounded"><i class="fa-solid fa-check mr-1"></i> </div>'),Ue[c],[[498,32,[[499,36]]]]),Hv=v(u('<div><div class="flex justify-between items-center mb-2"><span class="text-xs text-text-muted">Edit <span class="font-mono">skill.toml</span> directly</span> <button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface text-success-500 hover:bg-success-500/10 hover:border-success-500 transition-colors disabled:opacity-50"><!></button></div> <!> <!> <textarea spellcheck="false" class="w-full h-[320px] bg-background border border-border rounded-md p-3 text-[12px] font-mono text-text outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-900 resize-y leading-relaxed"></textarea></div>'),Ue[c],[[475,24,[[476,28,[[477,32,[[478,41]]],[480,32]]],[502,28]]]]),Jv=v(u('<div class="flex border-b border-border"><button><i class="fa-solid fa-sliders mr-1"></i>Parameters</button> <button><i class="fa-solid fa-terminal mr-1"></i>Logs</button> <button><i class="fa-solid fa-file-code mr-1"></i>Manifest</button> <!></div> <div class="p-4"><!></div>',1),Ue[c],[[293,16,[[294,20,[[298,24]]],[300,20,[[304,24]]],[306,20,[[310,24]]]]],[323,16]]),Yv=v(u('<div class="border-t border-border"><!> <div class="flex items-center gap-2 px-4 py-2 border-b border-border"><button><!></button> <button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-rotate-right mr-1"></i>Restart</button> <button class="px-3 py-1.5 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-arrows-rotate mr-1"></i>Refresh</button> <div class="flex-1"></div> <button class="px-3 py-1.5 text-xs border border-error-500/40 rounded-md bg-surface text-error-400 hover:bg-error-500/10 hover:border-error-500 transition-colors disabled:opacity-50"><!></button></div> <!></div>'),Ue[c],[[242,8,[[248,12,[[249,16],[259,16,[[263,20]]],[265,16,[[269,20]]],[271,16],[272,16]]]]]]),Qv=v(u('<div class="border border-border rounded-md mb-3 bg-surface-muted overflow-hidden"><button class="w-full p-4 flex justify-between items-center hover:bg-surface-elevated/40 transition-colors cursor-pointer text-left"><div class="flex items-center gap-2"><i></i> <span class="text-[15px] font-semibold"> </span></div> <div class="flex items-center gap-2"><!> <!> <!> <!></div></button> <!> <!></div>'),Ue[c],[[189,0,[[191,4,[[195,8,[[196,12],[197,12]]],[199,8]]]]]]);function Ue(e,r){Wt(new.target),Gt(r,!0,Ue);let a=Zl(r,"extension",3,null),n=$(A(!1),"expanded"),o=$(A(null),"detail"),l=$(A(!1),"detailLoading"),p=$(A(""),"detailError"),m=$(A("params"),"activeTab"),b=$(A(""),"logContent"),C=$(A(!1),"logLoading"),y=$(A(""),"manifestEdit"),w=$(A(!1),"manifestSaving"),h=$(A(""),"manifestError"),D=$(A(""),"manifestSuccess"),I=$(A(""),"newEnvKey"),Y=$(A(""),"newEnvValue"),j=$(A(!1),"deleting");async function z(){f(n,!t(n)),t(n)&&!t(o)&&(await N(re()))()}async function re(){f(l,!0),f(p,"");try{f(o,(await N(et("GET",`/api/skills/${encodeURIComponent(r.skill.name)}/detail`)))(),!0),f(y,t(o).manifest_raw,!0)}catch(P){f(p,P.message,!0)}finally{f(l,!1)}}async function se(){f(C,!0);try{const P=(await N(et("GET",`/api/skills/${encodeURIComponent(r.skill.name)}/log?lines=300`)))();f(b,P.log,!0)}catch(P){f(b,`Error loading log: ${P.message}`)}finally{f(C,!1)}}async function be(){try{(await N(et("POST",`/api/skills/${encodeURIComponent(r.skill.name)}/restart`)))(),setTimeout(r.onrefresh,1e3)}catch(P){console.error(...bt("error","restartSkill:",P)),alert("Failed to restart skill: "+P.message)}}async function Oe(){const P=!r.skill.enabled;try{(await N(et("PUT",`/api/skills/${encodeURIComponent(r.skill.name)}/enabled`,{enabled:P})))(),setTimeout(r.onrefresh,500)}catch(ae){console.error(...bt("error","toggleEnabled:",ae)),alert("Failed to toggle skill: "+ae.message)}}async function me(){f(w,!0),f(h,""),f(D,"");try{(await N(et("PUT",`/api/skills/${encodeURIComponent(r.skill.name)}/manifest`,{toml:t(y)})))(),f(D,"Saved. Restart the skill for changes to take effect."),setTimeout(()=>{f(D,"")},5e3),(await N(re()))()}catch(P){f(h,P.message,!0)}finally{f(w,!1)}}async function Se(){const P=t(I).trim(),ae=t(Y).trim();if(P)try{(await N(et("PUT",`/api/skills/${encodeURIComponent(r.skill.name)}/env`,{key:P,value:ae})))(),f(I,""),f(Y,""),(await N(re()))()}catch(de){alert("Failed to set env var: "+de.message)}}async function Ce(P){if(confirm(`Remove env var "${P}" from "${r.skill.name}"?`))try{(await N(et("DELETE",`/api/skills/${encodeURIComponent(r.skill.name)}/env/${encodeURIComponent(P)}`)))(),(await N(re()))()}catch(ae){alert("Failed to delete env var: "+ae.message)}}async function Ee(){if(confirm(`Permanently delete skill "${r.skill.name}"? This cannot be undone.`)){f(j,!0);try{(await N(et("DELETE",`/api/skills/${encodeURIComponent(r.skill.name)}`)))(),r.onrefresh()}catch(P){console.error(...bt("error","deleteSkill:",P)),alert("Failed to delete skill: "+P.message)}finally{f(j,!1)}}}function Z(P){f(m,P,!0),O(P,"logs")&&se()}let ye=$(cr(()=>O(a(),null,!1)&&(zi(a().ui.panel,null,!1)||zi(a().ui.page,null,!1)||a().route_count>0)),"hasExtension");var Be={...Ht()},De=Qv(),U=s(De),te=s(U),$e=s(te),T=i($e,2),k=s(T),R=i(te,2),ee=s(R);{var W=P=>{var ae=xv();d(P,ae)},le=P=>{var ae=mv();d(P,ae)};x(()=>g(ee,P=>{O(r.skill.skill_type,"daemon")?P(W):P(le,!1)}),"if",Ue,200,12)}var ke=i(ee,2);{var Ae=P=>{var ae=_v();d(P,ae)},q=P=>{var ae=bv();d(P,ae)},B=P=>{var ae=gv();d(P,ae)};x(()=>g(ke,P=>{r.skill.enabled?r.skill.running?P(q,1):P(B,!1):P(Ae)}),"if",Ue,210,12)}var L=i(ke,2);{var K=P=>{var ae=hv();d(P,ae)};x(()=>g(L,P=>{t(ye)&&P(K)}),"if",Ue,224,12)}var ce=i(L,2);{var he=P=>{var ae=yv(),de=s(ae);S(()=>_(de,`PID ${r.skill.pid??""}`)),d(P,ae)};x(()=>g(ce,P=>{r.skill.pid&&P(he)}),"if",Ue,230,12)}var ge=i(U,2);{var V=P=>{var ae=wv(),de=s(ae);S(()=>_(de,r.skill.description)),d(P,ae)};x(()=>g(ge,P=>{r.skill.description&&!t(n)&&P(V)}),"if",Ue,236,4)}var M=i(ge,2);{var _e=P=>{var ae=Yv(),de=s(ae);{var F=fe=>{var we=kv(),Pe=s(we);S(()=>_(Pe,r.skill.description)),d(fe,we)};x(()=>g(de,fe=>{r.skill.description&&fe(F)}),"if",Ue,243,12)}var ne=i(de,2),pe=s(ne),ie=s(pe);{var H=fe=>{var we=Tv();d(fe,we)},Q=fe=>{var we=$v();d(fe,we)};x(()=>g(ie,fe=>{r.skill.enabled?fe(H):fe(Q,!1)}),"if",Ue,253,20)}var E=i(pe,2),J=i(E,2),xe=i(J,4),oe=s(xe);{var ue=fe=>{var we=Ev();d(fe,we)},Te=fe=>{var we=Sv();d(fe,we)};x(()=>g(oe,fe=>{t(j)?fe(ue):fe(Te,!1)}),"if",Ue,277,20)}var ze=i(ne,2);{var Ne=fe=>{var we=Cv();d(fe,we)},Fe=fe=>{var we=Av(),Pe=s(we);S(()=>_(Pe,t(p))),d(fe,we)},Ie=fe=>{var we=Jv(),Pe=We(we),He=s(Pe),Ge=i(He,2),rt=i(Ge,2),gt=i(rt,2);{var qe=Ye=>{var yt=Pv();S(()=>Le(yt,1,`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${O(t(m),"plugin")?"text-violet-400 border-b-2 border-violet-400":"text-text-muted hover:text-text"}`)),X("click",yt,function(){return Z("plugin")}),d(Ye,yt)};x(()=>g(gt,Ye=>{t(ye)&&Ye(qe)}),"if",Ue,312,20)}var je=i(Pe,2),Ve=s(je);{var ft=Ye=>{var yt=Rv(),st=We(yt),Qe=i(s(st),2),ct=s(Qe),lt=i(Qe,4),at=s(lt),wt=i(lt,4),Dt=s(wt),Yt=i(wt,4),kt=s(Yt),Pt=i(st,2);{var Ke=Ut=>{var Me=jv(),tt=i(s(Me),2);x(()=>mt(tt,17,()=>Object.entries(t(o).env),([or,$r])=>or,(or,$r)=>{var Rt=cr(()=>no(t($r),2));let Et=()=>t(Rt)[0];Et();let Zt=()=>t(Rt)[1];Zt();var mr=Ov(),ya=s(mr),ls=s(ya,!0);var la=i(ya,2),pr=s(la,!0);var Er=i(la,2);S(()=>{_(ls,Et()),Vt(la,"title",Zt()),_(pr,Zt())}),X("click",Er,function(){return Ce(Et())}),d(or,mr)}),"each",Ue,343,32);var Lt=i(tt,2),At=s(Lt),tr=i(At,2),Tr=i(tr,2);St(At,function(){return t(I)},function($r){f(I,$r)}),St(tr,function(){return t(Y)},function($r){f(Y,$r)}),X("click",Tr,Se),d(Ut,Me)},Ze=cr(()=>Object.keys(t(o).env).length>0||!0);x(()=>g(Pt,Ut=>{t(Ze)&&Ut(Ke)}),"if",Ue,338,24)}var Ct=i(Pt,2);{var Qt=Ut=>{var Me=Lv(),tt=i(s(Me),2);x(()=>mt(tt,17,()=>r.skill.credentials,Lt=>Lt.name,(Lt,At)=>{x(()=>as(Lt,{get credential(){return t(At)},get skillName(){return r.skill.name},get onchange(){return r.onrefresh}}),"component",Ue,388,36,{componentTag:"CredentialRow"})}),"each",Ue,387,32),d(Ut,Me)};x(()=>g(Ct,Ut=>{var Me;(Me=r.skill.credentials)!=null&&Me.length&&Ut(Qt)}),"if",Ue,382,24)}S(()=>{_(ct,t(o).entrypoint),Vt(lt,"title",t(o).dir),_(at,t(o).dir),_(Dt,t(o).skill_type),_(kt,t(o).enabled?"Yes":"No")}),d(Ye,yt)},Nt=Ye=>{var yt=Iv(),st=s(yt),Qe=i(s(st),2),ct=i(st,2);{var lt=wt=>{var Dt=Nv();d(wt,Dt)},at=wt=>{var Dt=Dv(),Yt=s(Dt);S(()=>_(Yt,t(b)||"(no log output)")),d(wt,Dt)};x(()=>g(ct,wt=>{t(C)?wt(lt):wt(at,!1)}),"if",Ue,406,28)}X("click",Qe,se),d(Ye,yt)},Kt=Ye=>{var yt=Gv(),st=s(yt);{var Qe=kt=>{var Pt=Mv(),Ke=i(s(Pt),2),Ze=s(Ke);S(Ct=>{Vt(Ze,"src",`/skills/${Ct??""}/ui/${a().ui.panel??""}`),Vt(Ze,"title",`${r.skill.name??""} extension panel`)},[()=>encodeURIComponent(r.skill.name)]),d(kt,Pt)};x(()=>g(st,kt=>{a().ui.panel&&kt(Qe)}),"if",Ue,418,28)}var ct=i(st,2);{var lt=kt=>{var Pt=Fv(),Ke=s(Pt);S(Ze=>Vt(Ke,"href",`/skills/${Ze??""}/page`),[()=>encodeURIComponent(r.skill.name)]),d(kt,Pt)};x(()=>g(ct,kt=>{a().ui.page&&kt(lt)}),"if",Ue,436,28)}var at=i(ct,2);{var wt=kt=>{var Pt=zv(),Ke=s(Pt),Ze=i(s(Ke)),Ct=i(Ke,2);x(()=>mt(Ct,21,()=>a().routes,Ft,(Qt,Ut)=>{var Me=Uv(),tt=s(Me),Lt=s(tt,!0);var At=i(tt,2),tr=s(At);S((Tr,or)=>{_(Lt,Tr),_(tr,`/api/skills/${r.skill.name??""}/ext${or??""}`)},[()=>t(Ut).split(" ")[0],()=>t(Ut).split(" ").slice(1).join(" ")]),d(Qt,Me)}),"each",Ue,455,40),S(()=>_(Ze,` Registered Routes (${a().route_count??""})`)),d(kt,Pt)};x(()=>g(at,kt=>{a().route_count>0&&kt(wt)}),"if",Ue,449,28)}var Dt=i(at,2);{var Yt=kt=>{var Pt=Bv();d(kt,Pt)};x(()=>g(Dt,kt=>{!a().ui.panel&&O(a().route_count,0)&&kt(Yt)}),"if",Ue,467,28)}d(Ye,yt)},Xe=Ye=>{var yt=Hv(),st=s(yt),Qe=i(s(st),2),ct=s(Qe);{var lt=Ke=>{var Ze=qv();d(Ke,Ze)},at=Ke=>{var Ze=Kv();d(Ke,Ze)};x(()=>g(ct,Ke=>{t(w)?Ke(lt):Ke(at,!1)}),"if",Ue,485,36)}var wt=i(st,2);{var Dt=Ke=>{var Ze=Vv(),Ct=i(s(Ze),1,!0);S(()=>_(Ct,t(h))),d(Ke,Ze)};x(()=>g(wt,Ke=>{t(h)&&Ke(Dt)}),"if",Ue,492,28)}var Yt=i(wt,2);{var kt=Ke=>{var Ze=Wv(),Ct=i(s(Ze),1,!0);S(()=>_(Ct,t(D))),d(Ke,Ze)};x(()=>g(Yt,Ke=>{t(D)&&Ke(kt)}),"if",Ue,497,28)}var Pt=i(Yt,2);S(()=>Qe.disabled=t(w)),X("click",Qe,me),St(Pt,function(){return t(y)},function(Ze){f(y,Ze)}),d(Ye,yt)};x(()=>g(Ve,Ye=>{O(t(m),"params")?Ye(ft):O(t(m),"logs")?Ye(Nt,1):O(t(m),"plugin")&&a()?Ye(Kt,2):O(t(m),"manifest")&&Ye(Xe,3)}),"if",Ue,324,20)}S(()=>{Le(He,1,`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${O(t(m),"params")?"text-primary-400 border-b-2 border-primary-400":"text-text-muted hover:text-text"}`),Le(Ge,1,`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${O(t(m),"logs")?"text-primary-400 border-b-2 border-primary-400":"text-text-muted hover:text-text"}`),Le(rt,1,`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${O(t(m),"manifest")?"text-primary-400 border-b-2 border-primary-400":"text-text-muted hover:text-text"}`)}),X("click",He,function(){return Z("params")}),X("click",Ge,function(){return Z("logs")}),X("click",rt,function(){return Z("manifest")}),d(fe,we)};x(()=>g(ze,fe=>{t(l)?fe(Ne):t(p)?fe(Fe,1):t(o)&&fe(Ie,2)}),"if",Ue,285,12)}S(()=>{Le(pe,1,`px-3 py-1.5 text-xs border border-border rounded-md bg-surface transition-colors ${r.skill.enabled?"hover:bg-error-500/10 hover:border-error-500 text-error-400":"hover:bg-success-500/10 hover:border-success-500 text-success-500"}`),xe.disabled=t(j)}),X("click",pe,Oe),X("click",E,be),X("click",J,re),X("click",xe,Ee),d(P,ae)};x(()=>g(M,P=>{t(n)&&P(_e)}),"if",Ue,241,4)}return S(()=>{Le($e,1,`fa-solid fa-chevron-right text-[10px] text-text-subtle transition-transform ${t(n)?"rotate-90":""}`),_(k,r.skill.name)}),X("click",U,z),d(e,De),qt(Be)}ar(["click"]);sr[c]="src/components/SkillsTab.svelte";var Zv=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Importing...',1),sr[c],[[167,28]]),Xv=v(u('<i class="fa-solid fa-download mr-1"></i> Import Skill',1),sr[c],[[169,28]]),eu=v(u('<div class="mt-2 text-xs text-error-400 p-2 bg-error-500/10 border border-error-500/30 rounded"><i class="fa-solid fa-triangle-exclamation mr-1"></i> </div>'),sr[c],[[176,16,[[177,20]]]]),tu=v(u('<div class="mt-2 text-xs text-success-500 p-2 bg-success-500/10 border border-success-500/30 rounded"><i class="fa-solid fa-check mr-1"></i> </div>'),sr[c],[[181,16,[[182,20]]]]),ru=v(u(`<div class="border-b border-border bg-surface-muted p-4"><div class="text-xs font-semibold uppercase tracking-wider text-primary-400 mb-3"><i class="fa-solid fa-file-import mr-1"></i> Import Skill</div> <div class="flex items-center gap-1 mb-3"><button><i class="fa-brands fa-git-alt mr-1"></i> Git Repository</button> <button><i class="fa-solid fa-globe mr-1"></i> Archive URL</button> <button><i class="fa-solid fa-folder mr-1"></i> Local Path</button></div> <div class="flex flex-col gap-2"><input type="text" class="w-full px-3 py-2 text-sm border border-border rounded-md bg-background text-text font-mono outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-900 placeholder:text-text-subtle"/> <div class="flex items-center gap-2"><input type="text" placeholder="Skill name (optional, auto-detected)" class="flex-1 px-3 py-2 text-sm border border-border rounded-md bg-background text-text outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-900 placeholder:text-text-subtle"/> <button class="px-4 py-2 text-xs font-semibold border border-primary-500/50 rounded-md bg-primary-500/15 text-primary-400 hover:bg-primary-500/25 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap"><!></button></div></div> <!> <!> <p class="mt-2 text-[11px] text-text-subtle">Import an existing OpenClaw skill from a Git repository, archive URL (.tar.gz/.zip), or local directory.
                The skill must contain a <code class="font-mono text-accent-300">skill.toml</code> manifest.</p></div>`),sr[c],[[119,8,[[120,12,[[121,16]]],[125,12,[[126,16,[[130,20]]],[132,16,[[136,20]]],[138,16,[[142,20]]]]],[147,12,[[148,16],[154,16,[[155,20],[161,20]]]]],[186,12,[[188,41]]]]]]),au=v(u('<p class="text-text-subtle text-sm italic text-center py-4">Error loading skills</p>'),sr[c],[[195,12]]),su=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No skills installed. Skills will appear here when the agent creates them, or use the <strong>Import</strong> button above.</p>'),sr[c],[[197,12,[[198,101]]]]),iu=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><div class="flex justify-between items-center border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-puzzle-piece mr-1.5"></i> Skills &amp; Credentials</h2> <div class="flex items-center gap-2 pr-3"><span class="text-xs text-text-muted"> </span> <button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface hover:bg-primary-500/10 hover:border-primary-500 text-primary-400 transition-colors"><i class="fa-solid fa-file-import mr-1"></i> Import</button> <button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-arrows-rotate mr-1"></i> Refresh</button></div></div> <!> <div class="p-3"><!></div></section>'),sr[c],[[93,0,[[94,4,[[95,8,[[96,12]]],[98,8,[[99,12],[102,12,[[106,16]]],[108,12,[[112,16]]]]]]],[193,4]]]]);function sr(e,r){Wt(new.target),Gt(r,!0,sr);let a=$(A(ht([])),"skills"),n=$(A(!1),"error"),o=$(A(ht([])),"extensions"),l=$(A(!1),"showImport"),p=$(A("git"),"importSource"),m=$(A(""),"importLocation"),b=$(A(""),"importName"),C=$(A(!1),"importing"),y=$(A(""),"importError"),w=$(A(""),"importSuccess");async function h(){f(n,!1);try{f(a,(await N(et("GET","/api/skills")))(),!0)}catch(te){f(n,!0),console.error(...bt("error","loadSkills:",te))}}async function D(){try{f(o,(await N(et("GET","/api/skills/extensions")))(),!0)}catch(te){console.error(...bt("error","loadExtensions:",te))}}function I(te){return t(o).find($e=>O($e.skill_name,te))??null}async function Y(){const te=t(m).trim();if(te){f(C,!0),f(y,""),f(w,"");try{const $e={source:t(p),location:te},T=t(b).trim();T&&($e.name=T);const k=(await N(et("POST","/api/skills/import",$e)))();k.ok?(f(w,k.message??"Skill imported successfully",!0),f(m,""),f(b,""),setTimeout(()=>{f(w,""),f(l,!1)},3e3),h(),D()):f(y,k.message??"Import failed",!0)}catch($e){f(y,$e.message,!0)}finally{f(C,!1)}}}fr(()=>{O(ot.currentTab,"skills")&&(ot.refreshCounter,h(),D())});var j={...Ht()},z=iu(),re=s(z),se=i(s(re),2),be=s(se),Oe=s(be),me=i(be,2),Se=i(me,2),Ce=i(re,2);{var Ee=te=>{var $e=ru(),T=i(s($e),2),k=s(T),R=i(k,2),ee=i(R,2),W=i(T,2),le=s(W),ke=i(le,2),Ae=s(ke),q=i(Ae,2),B=s(q);{var L=M=>{var _e=Zv();d(M,_e)},K=M=>{var _e=Xv();d(M,_e)};x(()=>g(B,M=>{t(C)?M(L):M(K,!1)}),"if",sr,166,24)}var ce=i(W,2);{var he=M=>{var _e=eu(),P=i(s(_e),1,!0);S(()=>_(P,t(y))),d(M,_e)};x(()=>g(ce,M=>{t(y)&&M(he)}),"if",sr,175,12)}var ge=i(ce,2);{var V=M=>{var _e=tu(),P=i(s(_e),1,!0);S(()=>_(P,t(w))),d(M,_e)};x(()=>g(ge,M=>{t(w)&&M(V)}),"if",sr,180,12)}S(M=>{Le(k,1,`px-3 py-1.5 text-xs rounded-md transition-colors ${O(t(p),"git")?"bg-primary-500/20 text-primary-400 border border-primary-500/50":"border border-border text-text-muted hover:bg-surface-elevated"}`),Le(R,1,`px-3 py-1.5 text-xs rounded-md transition-colors ${O(t(p),"url")?"bg-primary-500/20 text-primary-400 border border-primary-500/50":"border border-border text-text-muted hover:bg-surface-elevated"}`),Le(ee,1,`px-3 py-1.5 text-xs rounded-md transition-colors ${O(t(p),"path")?"bg-primary-500/20 text-primary-400 border border-primary-500/50":"border border-border text-text-muted hover:bg-surface-elevated"}`),Vt(le,"placeholder",O(t(p),"git")?"https://github.com/user/skill-repo.git":O(t(p),"url")?"https://example.com/skill.tar.gz":"/path/to/skill-directory"),q.disabled=M},[()=>t(C)||!t(m).trim()]),X("click",k,function(){return f(p,"git")}),X("click",R,function(){return f(p,"url")}),X("click",ee,function(){return f(p,"path")}),St(le,function(){return t(m)},function(_e){f(m,_e)}),St(Ae,function(){return t(b)},function(_e){f(b,_e)}),X("click",q,Y),d(te,$e)};x(()=>g(Ce,te=>{t(l)&&te(Ee)}),"if",sr,118,4)}var Z=i(Ce,2),ye=s(Z);{var Be=te=>{var $e=au();d(te,$e)},De=te=>{var $e=su();d(te,$e)},U=te=>{var $e=er(),T=We($e);x(()=>mt(T,17,()=>t(a),k=>k.name,(k,R)=>{{let ee=cr(()=>I(t(R).name));x(()=>Ue(k,{get skill(){return t(R)},onrefresh:h,get extension(){return t(ee)}}),"component",sr,202,16,{componentTag:"SkillCard"})}}),"each",sr,201,12),d(te,$e)};x(()=>g(ye,te=>{t(n)?te(Be):O(t(a).length,0)?te(De,1):te(U,!1)}),"if",sr,194,8)}return S(()=>_(Oe,`${t(a).length??""} skill${O(t(a).length,1,!1)?"s":""}`)),X("click",me,function(){f(l,!t(l)),f(y,""),f(w,"")}),X("click",Se,h),d(e,z),qt(j)}ar(["click"]);Ur[c]="src/components/KnowledgeTab.svelte";var nu=v(u('<div class="p-3 border border-border rounded-md mb-2 bg-surface-muted"><div class="text-xs uppercase tracking-wider text-accent-500 font-semibold mb-1"><i class="fa-solid fa-arrow-right-arrow-left mr-1"></i> </div> <div class="text-sm"> <span class="text-text-muted text-[11px]"> </span></div></div>'),Ur[c],[[105,16,[[106,20,[[107,24]]],[109,20,[[111,24]]]]]]),ou=v(u('<button class="px-2.5 py-1 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors mb-3"><i class="fa-solid fa-arrow-left mr-1"></i> Back</button> <!>',1),Ur[c],[[98,12,[[102,16]]]]),lu=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No knowledge nodes</p>'),Ur[c],[[116,12]]),du=v(u('<button class="w-full text-left p-3 border border-border rounded-md mb-2 bg-surface-muted cursor-pointer hover:border-primary-500/50 transition-colors"><div class="text-xs uppercase tracking-wider text-primary-500 font-semibold mb-1"><i class="fa-solid fa-tag mr-1"></i> </div> <div class="text-sm font-semibold mb-1"> </div> <div class="text-xs text-text-muted"> </div> <div class="text-[11px] text-text-subtle mt-1"> </div></button>'),Ur[c],[[119,16,[[123,20,[[124,24]]],[126,20],[127,20],[128,20]]]]),cu=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><div class="flex justify-between items-center border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-diagram-project mr-1.5"></i> Knowledge Graph</h2> <div class="flex items-center gap-2 pr-3"><span class="text-xs text-text-muted"><i class="fa-solid fa-circle-nodes mr-1"></i> </span></div></div> <div class="px-4 py-2 border-b border-border"><input type="text" placeholder="Search knowledge graph..." class="w-full px-2.5 py-1.5 border border-border rounded-md bg-background text-text text-sm outline-none focus:border-primary-500 focus:ring-1 focus:ring-primary-900 font-sans"/></div> <div class="p-3 max-h-[600px] overflow-y-auto custom-scroll"><!></div></section>'),Ur[c],[[76,0,[[77,4,[[78,8,[[79,12]]],[81,8,[[82,12,[[83,16]]]]]]],[87,4,[[88,8]]],[96,4]]]]);function Ur(e,r){Wt(new.target),Gt(r,!0,Ur);let a=$(A(ht({nodes:0,edges:0})),"stats"),n=$(A(ht([])),"nodes"),o=$(A(ht([])),"neighbors"),l=$(A(!1),"viewingNeighbors"),p=$(A(""),"searchQuery");async function m(){try{const[Ee,Z]=(await N(Promise.all([et("GET","/api/knowledge/stats"),et("GET","/api/knowledge/nodes?limit=100")])))();f(a,Ee,!0),f(n,Z,!0),f(l,!1)}catch(Ee){console.error(...bt("error","loadKnowledge:",Ee))}}async function b(){if(!t(p)){m();return}try{f(n,(await N(et("GET",`/api/knowledge/search?q=${encodeURIComponent(t(p))}`)))(),!0),f(l,!1)}catch(Ee){console.error(...bt("error","searchKnowledge:",Ee))}}async function C(Ee){try{const Z=(await N(et("GET",`/api/knowledge/nodes/${Ee}/neighbors`)))();if(!Z.length){alert("No neighbors for this node.");return}f(o,Z,!0),f(l,!0)}catch(Z){console.error(...bt("error","loadNodeNeighbors:",Z))}}function y(){f(l,!1)}function w(Ee){O(Ee.key,"Enter")&&b()}fr(()=>{O(ot.currentTab,"knowledge")&&(ot.refreshCounter,m())});var h={...Ht()},D=cu(),I=s(D),Y=i(s(I),2),j=s(Y),z=i(s(j)),re=i(I,2),se=s(re),be=i(re,2),Oe=s(be);{var me=Ee=>{var Z=ou(),ye=We(Z),Be=i(ye,2);x(()=>mt(Be,17,()=>t(o),Ft,(De,U)=>{var te=nu(),$e=s(te),T=i(s($e),1,!0);var k=i($e,2),R=s(k),ee=i(R),W=s(ee);S(()=>{_(T,t(U).edge.relation),_(R,`${t(U).node.label??""} `),_(W,`(${t(U).node.node_type??""})`)}),d(De,te)}),"each",Ur,104,12),X("click",ye,y),d(Ee,Z)},Se=Ee=>{var Z=lu();d(Ee,Z)},Ce=Ee=>{var Z=er(),ye=We(Z);x(()=>mt(ye,17,()=>t(n),Be=>Be.id,(Be,De)=>{var U=du(),te=s(U),$e=i(s(te),1,!0);var T=i(te,2),k=s(T,!0);var R=i(T,2),ee=s(R,!0);var W=i(R,2),le=s(W);S((ke,Ae,q)=>{_($e,t(De).node_type??"node"),_(k,t(De).label),_(ee,ke),_(le,`confidence: ${Ae??""} · ${q??""}`)},[()=>t(De).content.slice(0,200),()=>(t(De).confidence??1).toFixed(2),()=>ga(t(De).updated_at)]),X("click",U,function(){return C(t(De).id)}),d(Be,U)}),"each",Ur,118,12),d(Ee,Z)};x(()=>g(Oe,Ee=>{t(l)?Ee(me):O(t(n).length,0)?Ee(Se,1):Ee(Ce,!1)}),"if",Ur,97,8)}return S(()=>_(z,`${t(a).nodes??""} nodes, ${t(a).edges??""} edges`)),X("keyup",se,w),St(se,function(){return t(p)},function(Z){f(p,Z)}),d(e,D),qt(h)}ar(["keyup","click"]);ha[c]="src/components/ToolsTab.svelte";var vu=v(u('<p class="text-text-subtle text-sm italic text-center py-4">No tools registered</p>'),ha[c],[[30,12]]),uu=v(u('<div class="p-3 border border-border rounded-md mb-2 bg-surface-muted"><div class="text-xs uppercase tracking-wider text-primary-500 font-semibold mb-1"><i class="fa-solid fa-wrench mr-1"></i> </div> <div class="text-sm text-text-muted"> </div></div>'),ha[c],[[33,16,[[34,20,[[35,24]]],[37,20]]]]),fu=v(u('<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted border-b border-border"><i class="fa-solid fa-screwdriver-wrench mr-1.5"></i> Registered Tools</h2> <div class="p-3 max-h-[600px] overflow-y-auto custom-scroll"><!></div></section>'),ha[c],[[24,0,[[25,4,[[26,8]]],[28,4]]]]);function ha(e,r){Wt(new.target),Gt(r,!0,ha);let a=$(A(ht([])),"tools");async function n(){try{f(a,(await N(et("GET","/api/tools")))(),!0)}catch(y){console.error(...bt("error","loadTools:",y))}}fr(()=>{O(ot.currentTab,"tools")&&(ot.refreshCounter,n())});var o={...Ht()},l=fu(),p=i(s(l),2),m=s(p);{var b=y=>{var w=vu();d(y,w)},C=y=>{var w=er(),h=We(w);x(()=>mt(h,17,()=>t(a),D=>D.name,(D,I)=>{var Y=uu(),j=s(Y),z=i(s(j),1,!0);var re=i(j,2),se=s(re,!0);S(()=>{_(z,t(I).name),_(se,t(I).description)}),d(D,Y)}),"each",ha,32,12),d(y,w)};x(()=>g(m,y=>{O(t(a).length,0)?y(b):y(C,!1)}),"if",ha,29,8)}return d(e,l),qt(o)}zt[c]="src/components/TrashTab.svelte";var pu=v(u('<button class="text-xs px-3 py-1.5 rounded bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 text-red-400 hover:text-red-300 transition-colors"><i class="fa-solid fa-trash mr-1"></i> Empty Trash</button>'),zt[c],[[163,24,[[167,28]]]]),xu=v(u('<div class="flex items-center gap-1.5"><span class="text-xs text-red-400">Delete all?</span> <button class="text-xs px-2 py-1 rounded bg-red-600 hover:bg-red-700 text-white transition-colors">Yes</button> <button class="text-xs px-2 py-1 rounded bg-surface-muted hover:bg-surface border border-border text-text-muted transition-colors">No</button></div>'),zt[c],[[170,24,[[171,28],[172,28],[176,28]]]]),mu=v(u('<div class="bg-red-500/10 border border-red-500/30 text-red-400 text-sm rounded-lg px-4 py-2"><i class="fa-solid fa-circle-exclamation mr-1.5"></i> </div>'),zt[c],[[189,8,[[190,12]]]]),_u=v(u('<div class="bg-emerald-500/10 border border-emerald-500/30 text-emerald-400 text-sm rounded-lg px-4 py-2"><i class="fa-solid fa-check-circle mr-1.5"></i> </div>'),zt[c],[[194,8,[[195,12]]]]),bu=v(u('<div class="relative"><i class="fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-text-subtle text-xs"></i> <input type="text" placeholder="Search by name, path, or source..." class="w-full pl-9 pr-3 py-2 text-sm bg-surface border border-border rounded-lg text-text placeholder:text-text-subtle focus:outline-none focus:ring-1 focus:ring-primary-500 focus:border-primary-500"/></div>'),zt[c],[[201,8,[[202,12],[203,12]]]]),gu=v(u('<div class="p-8 text-center text-text-subtle text-sm"><i class="fa-solid fa-spinner fa-spin mr-1.5"></i> Loading...</div>'),zt[c],[[215,12,[[216,16]]]]),hu=v(u('<i class="fa-solid fa-search mr-1.5"></i> ',1),zt[c],[[221,20]]),yu=v(u('<i class="fa-solid fa-trash-can mr-1.5 opacity-40"></i> <p class="mt-1">Trash is empty</p> <p class="text-xs mt-1 text-text-subtle opacity-70">Deleted files and directories will appear here for recovery.</p>',1),zt[c],[[223,20],[224,20],[225,20]]),wu=v(u('<div class="p-8 text-center text-text-subtle text-sm"><!></div>'),zt[c],[[219,12]]),ku=v(u('<div class="p-3 hover:bg-surface-muted/50 transition-colors group"><div class="flex items-start justify-between gap-3"><div class="flex-1 min-w-0"><div class="flex items-center gap-2 mb-1"><i></i> <span class="text-sm font-medium text-text truncate"> </span> <span class="text-xs text-text-subtle bg-surface-muted px-1.5 py-0.5 rounded"> </span></div> <div class="text-xs text-text-subtle truncate pl-6"> </div> <div class="flex items-center gap-3 mt-1 pl-6"><span class="text-xs text-text-subtle"><i class="fa-regular fa-clock mr-0.5"></i> </span> <span class="text-xs text-text-subtle"><i class="fa-solid fa-tag mr-0.5"></i> </span></div></div> <div class="flex items-center gap-1.5 shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"><button class="text-xs px-2.5 py-1.5 rounded bg-emerald-500/10 hover:bg-emerald-500/20 border border-emerald-500/30 text-emerald-400 hover:text-emerald-300 transition-colors" title="Restore to original location"><i class="fa-solid fa-rotate-left mr-1"></i> Restore</button> <button class="text-xs px-2.5 py-1.5 rounded bg-red-500/10 hover:bg-red-500/20 border border-red-500/30 text-red-400 hover:text-red-300 transition-colors" title="Permanently delete"><i class="fa-solid fa-xmark"></i></button></div></div></div>'),zt[c],[[233,20,[[234,24,[[235,28,[[236,32,[[237,36],[238,36],[239,36]]],[243,32],[246,32,[[247,36,[[248,40]]],[250,36,[[251,40]]]]]]],[255,28,[[256,32,[[261,36]]],[263,32,[[268,36]]]]]]]]]]),Tu=v(u('<div class="max-h-[600px] overflow-y-auto custom-scroll divide-y divide-border"></div>'),zt[c],[[231,12]]),$u=v(u('<section class="space-y-4"><div class="bg-surface border border-border rounded-lg shadow-sm p-4"><div class="flex items-center justify-between"><div class="flex items-center gap-3"><h2 class="text-xs font-semibold uppercase tracking-wider text-text-muted"><i class="fa-solid fa-trash-can mr-1.5"></i> Trash</h2> <span class="text-xs text-text-subtle bg-surface-muted px-2 py-0.5 rounded-full"> </span></div> <div class="flex items-center gap-2"><button class="text-xs px-3 py-1.5 rounded bg-surface-muted hover:bg-surface border border-border text-text-muted hover:text-text transition-colors"><i></i> Refresh</button> <!></div></div></div> <!> <!> <!> <div class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><!></div></section>'),zt[c],[[141,0,[[143,4,[[144,8,[[145,12,[[146,16,[[147,20]]],[149,16]]],[153,12,[[154,16,[[159,20]]]]]]]]],[213,4]]]]);function zt(e,r){Wt(new.target),Gt(r,!0,zt);let a=$(A(ht([])),"items"),n=$(A(ht({count:0,total_bytes:0})),"stats"),o=$(A(!1),"loading"),l=$(A(""),"error"),p=$(A(""),"successMsg"),m=$(A(!1),"confirmEmpty"),b=$(A(""),"searchQuery");async function C(){f(o,!0),f(l,"");try{const q=(await N(et("GET","/api/trash")))();f(a,q.items,!0),f(n,q.stats,!0)}catch(q){f(l,(q==null?void 0:q.message)||"Failed to load trash",!0),console.error(...bt("error","loadTrash:",q))}finally{f(o,!1)}}async function y(q){try{const B=(await N(et("POST",`/api/trash/${q}/restore`)))();f(p,B.message||"Restored",!0),(await N(C()))(),setTimeout(()=>f(p,""),3e3)}catch(B){f(l,(B==null?void 0:B.message)||"Failed to restore",!0)}}async function w(q,B){if(confirm(`Permanently delete "${B}"? This cannot be undone.`))try{const L=(await N(et("DELETE",`/api/trash/${q}`)))();f(p,L.message||"Deleted",!0),(await N(C()))(),setTimeout(()=>f(p,""),3e3)}catch(L){f(l,(L==null?void 0:L.message)||"Failed to delete",!0)}}async function h(){try{const q=(await N(et("POST","/api/trash/empty")))();f(p,q.message||"Trash emptied",!0),f(m,!1),(await N(C()))(),setTimeout(()=>f(p,""),3e3)}catch(q){f(l,(q==null?void 0:q.message)||"Failed to empty trash",!0)}}function D(q){if(O(q,0))return"0 B";const B=["B","KB","MB","GB"],L=Math.min(Math.floor(Math.log(q)/Math.log(1024)),B.length-1);return`${(q/Math.pow(1024,L)).toFixed(O(L,0)?0:1)} ${B[L]}`}function I(q){try{const B=new Date(q),K=new Date().getTime()-B.getTime(),ce=Math.floor(K/6e4),he=Math.floor(K/36e5),ge=Math.floor(K/864e5);return ce<1?"just now":ce<60?`${ce}m ago`:he<24?`${he}h ago`:ge<7?`${ge}d ago`:B.toLocaleDateString()}catch{return q}}function Y(q){return q.startsWith("tool:")?q.replace("tool:",""):q.startsWith("shell:")?q.replace("shell:","")+" (shell)":q.startsWith("rhai:")?q.replace("rhai:","")+" (skill)":q}let j=$(cr(()=>t(b).trim()?t(a).filter(q=>q.name.toLowerCase().includes(t(b).toLowerCase())||q.original_path.toLowerCase().includes(t(b).toLowerCase())||q.source.toLowerCase().includes(t(b).toLowerCase())):t(a)),"filtered");fr(()=>{O(ot.currentTab,"trash")&&(ot.refreshCounter,C())});var z={...Ht()},re=$u(),se=s(re),be=s(se),Oe=s(be),me=i(s(Oe),2),Se=s(me),Ce=i(Oe,2),Ee=s(Ce),Z=s(Ee);let ye;var Be=i(Ee,2);{var De=q=>{var B=er(),L=We(B);{var K=he=>{var ge=pu();X("click",ge,function(){return f(m,!0)}),d(he,ge)},ce=he=>{var ge=xu(),V=i(s(ge),2),M=i(V,2);X("click",V,h),X("click",M,function(){return f(m,!1)}),d(he,ge)};x(()=>g(L,he=>{t(m)?he(ce,!1):he(K)}),"if",zt,162,20)}d(q,B)};x(()=>g(Be,q=>{t(n).count>0&&q(De)}),"if",zt,161,16)}var U=i(se,2);{var te=q=>{var B=mu(),L=i(s(B));S(()=>_(L,` ${t(l)??""}`)),d(q,B)};x(()=>g(U,q=>{t(l)&&q(te)}),"if",zt,188,4)}var $e=i(U,2);{var T=q=>{var B=_u(),L=i(s(B));S(()=>_(L,` ${t(p)??""}`)),d(q,B)};x(()=>g($e,q=>{t(p)&&q(T)}),"if",zt,193,4)}var k=i($e,2);{var R=q=>{var B=bu(),L=i(s(B),2);St(L,function(){return t(b)},function(ce){f(b,ce)}),d(q,B)};x(()=>g(k,q=>{t(a).length>0&&q(R)}),"if",zt,200,4)}var ee=i(k,2),W=s(ee);{var le=q=>{var B=gu();d(q,B)},ke=q=>{var B=wu(),L=s(B);{var K=ge=>{var V=hu(),M=i(We(V));S(()=>_(M,` No items matching "${t(b)??""}"`)),d(ge,V)},ce=cr(()=>t(b).trim()),he=ge=>{var V=yu();d(ge,V)};x(()=>g(L,ge=>{t(ce)?ge(K):ge(he,!1)}),"if",zt,220,16)}d(q,B)},Ae=q=>{var B=Tu();x(()=>mt(B,21,()=>t(j),L=>L.id,(L,K)=>{var ce=ku(),he=s(ce),ge=s(he),V=s(ge),M=s(V),_e=i(M,2),P=s(_e,!0);var ae=i(_e,2),de=s(ae,!0);var F=i(V,2),ne=s(F,!0);var pe=i(F,2),ie=s(pe),H=i(s(ie));var Q=i(ie,2),E=i(s(Q));var J=i(ge,2),xe=s(J),oe=i(xe,2);S((ue,Te,ze)=>{Le(M,1,`fa-solid ${t(K).is_dir?"fa-folder text-amber-400":"fa-file text-blue-400"} text-sm`),_(P,t(K).name),_(de,ue),Vt(F,"title",t(K).original_path),_(ne,t(K).original_path),Vt(ie,"title",t(K).trashed_at),_(H,` ${Te??""}`),_(E,` ${ze??""}`)},[()=>D(t(K).size_bytes),()=>I(t(K).trashed_at),()=>Y(t(K).source)]),X("click",xe,function(){return y(t(K).id)}),X("click",oe,function(){return w(t(K).id,t(K).name)}),d(L,ce)}),"each",zt,232,16),d(q,B)};x(()=>g(W,q=>{t(o)&&O(t(a).length,0)?q(le):O(t(j).length,0)?q(ke,1):q(Ae,!1)}),"if",zt,214,8)}return S(q=>{_(Se,`${t(n).count??""} item${O(t(n).count,1,!1)?"s":""} · ${q??""}`),Ee.disabled=t(o),ye=Le(Z,1,"fa-solid fa-arrows-rotate mr-1",null,ye,{"fa-spin":t(o)})},[()=>D(t(n).total_bytes)]),X("click",Ee,C),d(e,re),qt(z)}ar(["click"]);Je[c]="src/components/SecurityTab.svelte";var Eu=v(u("<button><i></i> </button>"),Je[c],[[205,12,[[213,16]]]]),Su=v(u(`<div class="grid grid-cols-2 md:grid-cols-4 gap-3"><div class="card p-3 text-center"><div class="text-2xl font-bold text-heading"> </div> <div class="text-xs text-muted">Total Events</div></div> <div class="card p-3 text-center"><div class="text-2xl font-bold text-blue-400"> </div> <div class="text-xs text-muted">Tool Calls</div></div> <div class="card p-3 text-center"><div> </div> <div class="text-xs text-muted">Today's Cost <!></div></div> <div class="card p-3 text-center"><div> </div> <div class="text-xs text-muted">Calls/min</div></div></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-3"><div class="card p-3 text-center"><div class="text-lg font-bold text-green-400"> </div> <div class="text-xs text-muted">Approvals</div></div> <div class="card p-3 text-center"><div class="text-lg font-bold text-red-400"> </div> <div class="text-xs text-muted">Rejections</div></div> <div class="card p-3 text-center"><div class="text-lg font-bold text-orange-400"> </div> <div class="text-xs text-muted">Rate Limits</div></div> <div class="card p-3 text-center"><div class="text-lg font-bold text-red-500"> </div> <div class="text-xs text-muted">PII Detected</div></div></div> <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mt-3"><div class="card p-4"><h3 class="text-sm font-semibold text-heading mb-2"><i class="fa-solid fa-dollar-sign mr-1"></i>Cost Summary</h3> <div class="space-y-1 text-sm"><div class="flex justify-between"><span class="text-muted">Today</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">This Month</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">All-time</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">Tokens Today</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">Total Tokens</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">Requests Today</span><span> </span></div></div></div> <div class="card p-4"><h3 class="text-sm font-semibold text-heading mb-2"><i class="fa-solid fa-gauge-high mr-1"></i>Rate Limits</h3> <div class="space-y-1 text-sm"><div class="flex justify-between"><span class="text-muted">Per Minute</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">Per Hour</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">Status</span> <span> </span></div> <div class="flex justify-between"><span class="text-muted">2FA Challenges</span><span> </span></div> <div class="flex justify-between"><span class="text-muted">Permission Denials</span><span> </span></div></div></div></div>`,1),Je[c],[[221,12,[[222,16,[[223,20],[224,20]]],[226,16,[[227,20],[228,20]]],[230,16,[[231,20],[234,20]]],[241,16,[[242,20],[245,20]]]]],[249,12,[[250,16,[[251,20],[252,20]]],[254,16,[[255,20],[256,20]]],[258,16,[[259,20],[260,20]]],[262,16,[[263,20],[264,20]]]]],[268,12,[[269,16,[[270,20,[[270,72]]],[271,20,[[272,24,[[272,58],[272,95]]],[273,24,[[273,58],[273,100]]],[274,24,[[274,58],[274,98]]],[275,24,[[275,58],[275,102]]],[276,24,[[276,58],[276,102]]],[277,24,[[277,58],[277,104]]]]]]],[280,16,[[281,20,[[281,72]]],[282,20,[[283,24,[[283,58],[283,100]]],[284,24,[[284,58],[284,98]]],[285,24,[[286,28],[287,28]]],[291,24,[[291,58],[291,104]]],[292,24,[[292,58],[292,108]]]]]]]]]]),Cu=v(u('<p class="text-muted text-sm">Loading security data...</p>'),Je[c],[[297,12]]),Au=v(u('<p class="text-muted text-sm">No audit entries found.</p>'),Je[c],[[325,12]]),Pu=v(u('<span class="text-xs bg-card-hover px-1.5 py-0.5 rounded"> </span>'),Je[c],[[335,36]]),Ou=v(u('<span class="text-xs text-muted"> </span>'),Je[c],[[338,36]]),ju=v(u("<span> </span>"),Je[c],[[341,36]]),Lu=v(u('<div class="text-xs text-muted mt-0.5 truncate"> </div>'),Je[c],[[348,32]]),Ru=v(u('<div class="text-xs text-muted mt-0.5 truncate"> </div>'),Je[c],[[351,32]]),Nu=v(u('<div class="card p-2 flex items-start gap-2 text-sm"><i></i> <div class="flex-1 min-w-0"><div class="flex items-center gap-2"><span> </span> <!> <!> <!> <span class="text-xs text-muted ml-auto"> </span></div> <!> <!> <div class="text-xs text-muted mt-0.5 flex justify-between"><span> </span> <button class="text-blue-400 hover:text-blue-300" title="Explain this action"><i class="fa-solid fa-magnifying-glass"></i> Why?</button></div></div></div>'),Je[c],[[329,20,[[330,24],[331,24,[[332,28,[[333,32],[345,32]]],[353,28,[[354,32],[355,32,[[356,36]]]]]]]]]]),Du=v(u('<div class="space-y-1"></div>'),Je[c],[[327,12]]),Iu=v(u('<p class="text-muted text-sm">No reasoning chain found for this action.</p>'),Je[c],[[376,24]]),Mu=v(u('<span class="text-muted"> </span>'),Je[c],[[383,55]]),Fu=v(u('<div class="text-sm mt-1"><span class="text-muted">Reasoning:</span> </div>'),Je[c],[[386,40,[[386,66]]]]),Uu=v(u('<div class="text-xs text-muted mt-1"> </div>'),Je[c],[[389,40]]),zu=v(u('<div class="text-xs text-muted mt-1"> </div>'),Je[c],[[392,40]]),Bu=v(u('<div><div> <!></div> <!> <!> <!> <div class="text-xs text-muted"> </div></div>'),Je[c],[[380,32,[[381,36],[394,36]]]]),Gu=v(u('<div class="space-y-2"></div>'),Je[c],[[378,24]]),qu=v(u('<div class="fixed inset-0 bg-black/60 flex items-center justify-center z-50" role="dialog"><div class="card p-4 max-w-lg w-full mx-4 max-h-[80vh] overflow-y-auto" role="document"><div class="flex justify-between items-center mb-3"><h3 class="text-lg font-bold text-heading"><i class="fa-solid fa-lightbulb mr-2"></i>Action Explanation</h3> <button class="text-muted hover:text-heading"><i class="fa-solid fa-xmark"></i></button></div> <!></div></div>'),Je[c],[[367,12,[[368,16,[[369,20,[[370,24,[[370,67]]],[371,24,[[372,28]]]]]]]]]]),Ku=v(u('<div class="flex gap-2 mb-3"><select class="bg-bg border border-border rounded px-2 py-1 text-sm"><option>All Events</option><option>Tool Calls</option><option>Approvals</option><option>Rate Limits</option><option>PII Detected</option><option>2FA</option><option>Permission Denied</option></select> <input type="text" placeholder="Filter by tool name..." class="bg-bg border border-border rounded px-2 py-1 text-sm flex-1"/> <button class="btn btn-sm"><i class="fa-solid fa-rotate mr-1"></i>Refresh</button></div> <!> <!>',1),Je[c],[[302,8,[[303,12,[[304,16],[305,16],[306,16],[307,16],[308,16],[309,16],[310,16]]],[312,12],[319,12,[[320,16]]]]]]),Vu=v(u('<div class="mt-2 w-full bg-bg rounded-full h-2"><div></div></div> <div class="text-xs text-muted mt-1"> </div>',1),Je[c],[[413,24,[[414,28]]],[421,24]]),Wu=v(u('<div class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-4"><div class="card p-4 text-center"><div> </div> <div class="text-xs text-muted">Today</div> <!></div> <div class="card p-4 text-center"><div class="text-3xl font-bold text-heading"> </div> <div class="text-xs text-muted">This Month</div></div> <div class="card p-4 text-center"><div class="text-3xl font-bold text-heading"> </div> <div class="text-xs text-muted">All-time</div></div></div> <div class="grid grid-cols-3 gap-3"><div class="card p-3 text-center"><div class="text-xl font-bold"> </div> <div class="text-xs text-muted">Tokens Today</div></div> <div class="card p-3 text-center"><div class="text-xl font-bold"> </div> <div class="text-xs text-muted">Total Tokens</div></div> <div class="card p-3 text-center"><div class="text-xl font-bold"> </div> <div class="text-xs text-muted">Requests Today</div></div></div>',1),Je[c],[[406,12,[[407,16,[[408,20],[411,20]]],[424,16,[[425,20],[426,20]]],[428,16,[[429,20],[430,20]]]]],[433,12,[[434,16,[[435,20],[436,20]]],[438,16,[[439,20],[440,20]]],[442,16,[[443,20],[444,20]]]]]]),Hu=v(u('<p class="text-muted text-sm">Loading cost data...</p>'),Je[c],[[448,12]]),Ju=v(u('<div class="w-full bg-bg rounded-full h-3"><div></div></div>'),Je[c],[[463,28,[[464,32]]]]),Yu=v(u('<div class="w-full bg-bg rounded-full h-3"><div></div></div>'),Je[c],[[480,28,[[481,32]]]]),Qu=v(u('<div class="card p-6 max-w-md"><h3 class="text-lg font-bold text-heading mb-4"><i class="fa-solid fa-gauge-high mr-2"></i>Rate Limit Status</h3> <div class="space-y-4"><div><div class="flex justify-between text-sm mb-1"><span class="text-muted">Per Minute</span> <span> </span></div> <!></div> <div><div class="flex justify-between text-sm mb-1"><span class="text-muted">Per Hour</span> <span> </span></div> <!></div> <div class="text-center p-3 rounded"><span> </span></div></div></div>'),Je[c],[[454,12,[[455,16,[[455,64]]],[456,16,[[457,20,[[458,24,[[459,28],[460,28]]]]],[474,20,[[475,24,[[476,28],[477,28]]]]],[491,20,[[492,24]]]]]]]]),Zu=v(u('<p class="text-muted text-sm">Loading rate limit data...</p>'),Je[c],[[499,12]]),Xu=v(u(`<div class="card p-6 text-center"><i class="fa-solid fa-shield-check text-3xl text-green-400 mb-2"></i> <p class="text-muted">No pending 2FA challenges.</p> <p class="text-xs text-muted mt-1">When the agent attempts a dangerous operation (like executing shell commands),
                        a 2FA challenge will appear here for your confirmation.</p></div>`),Je[c],[[513,16,[[514,20],[515,20],[516,20]]]]),ef=v(u('<div class="card p-4"><div class="flex items-start gap-3"><i class="fa-solid fa-lock text-purple-400 text-lg mt-1"></i> <div class="flex-1"><div class="flex items-center gap-2"><span class="font-semibold text-heading"> </span> <span class="text-xs bg-card-hover px-1.5 py-0.5 rounded"> </span> <span class="text-xs text-muted"> </span></div> <p class="text-sm text-muted mt-1"> </p> <div class="flex gap-2 mt-2"><button class="btn btn-sm bg-green-600 hover:bg-green-500 text-white"><i class="fa-solid fa-check mr-1"></i>Confirm</button> <button class="btn btn-sm bg-red-600 hover:bg-red-500 text-white"><i class="fa-solid fa-xmark mr-1"></i>Reject</button></div></div></div></div>'),Je[c],[[523,20,[[524,24,[[525,28],[526,28,[[527,32,[[528,36],[529,36],[530,36]]],[532,32],[533,32,[[534,36,[[535,40]]],[537,36,[[538,40]]]]]]]]]]]]),tf=v(u('<div class="space-y-3"><div class="flex items-center justify-between mb-2"><h3 class="text-lg font-bold text-heading"><i class="fa-solid fa-lock mr-2"></i>2FA Challenges</h3> <button class="btn btn-sm"><i class="fa-solid fa-rotate mr-1"></i>Refresh</button></div> <!></div>'),Je[c],[[504,8,[[505,12,[[506,16,[[506,59]]],[507,16,[[508,20]]]]]]]]),rf=v(u('<div class="space-y-4"><div class="flex items-center gap-3 mb-4"><h2 class="text-xl font-bold text-heading"><i class="fa-solid fa-shield-halved mr-2"></i>Security & Trust</h2></div> <div class="flex gap-1 border-b border-border pb-1 mb-4"></div> <!></div>'),Je[c],[[191,0,[[192,4,[[193,8,[[193,51]]]]],[197,4]]]]);function Je(e,r){Wt(new.target),Gt(r,!0,Je);let a=$(A(null),"auditSummary"),n=$(A(null),"costSummary"),o=$(A(null),"rateStatus"),l=$(A(ht([])),"challenges"),p=$(A(ht([])),"auditEntries"),m=$(A(ht([])),"explanationChain"),b=$(A(!1),"showExplanation"),C=$(A("overview"),"activeSection"),y=is(ht({event_type:"",tool:""}),"auditFilter");async function w(){try{const T=(await N(fetch("/api/security/overview")))(),k=(await N(T.json()))();f(a,k.audit,!0),f(n,k.cost,!0),f(o,k.rate_limit,!0),f(l,[],!0)}catch(T){console.error(...bt("error","Failed to load security overview",T))}}async function h(){try{const T=new URLSearchParams({limit:"50"});y.event_type&&T.set("event_type",y.event_type),y.tool&&T.set("tool",y.tool);const k=(await N(fetch(`/api/security/audit?${T}`)))();f(p,(await N(k.json()))(),!0)}catch(T){console.error(...bt("error","Failed to load audit log",T))}}async function D(){try{const T=(await N(fetch("/api/security/cost")))();f(n,(await N(T.json()))(),!0)}catch(T){console.error(...bt("error","Failed to load cost summary",T))}}async function I(){try{const T=(await N(fetch("/api/security/rate-limit")))();f(o,(await N(T.json()))(),!0)}catch(T){console.error(...bt("error","Failed to load rate limit status",T))}}async function Y(){try{const T=(await N(fetch("/api/security/2fa")))();f(l,(await N(T.json()))(),!0)}catch(T){console.error(...bt("error","Failed to load 2FA challenges",T))}}async function j(T){(await N(fetch(`/api/security/2fa/${T}/confirm`,{method:"POST"})))(),(await N(Y()))()}async function z(T){(await N(fetch(`/api/security/2fa/${T}/reject`,{method:"POST"})))(),(await N(Y()))()}async function re(T){try{const k=(await N(fetch(`/api/security/audit/${T}/explain`)))();f(m,(await N(k.json()))(),!0),f(b,!0)}catch(k){console.error(...bt("error","Failed to load explanation",k))}}function se(T){f(C,T,!0),O(T,"overview")?w():O(T,"audit")?h():O(T,"cost")?D():O(T,"rate")?I():O(T,"2fa")&&Y()}function be(T){return`$${T.toFixed(4)}`}function Oe(T){return T>=1e6?`${(T/1e6).toFixed(1)}M`:T>=1e3?`${(T/1e3).toFixed(1)}K`:T.toString()}function me(T){switch(T){case"tool_call":return"text-blue-400";case"approval":return"text-yellow-400";case"rate_limit":return"text-orange-400";case"pii_detected":return"text-red-400";case"2fa":return"text-purple-400";case"permission_denied":return"text-red-500";default:return"text-muted"}}function Se(T){switch(T){case"tool_call":return"fa-wrench";case"approval":return"fa-check-double";case"rate_limit":return"fa-gauge-high";case"pii_detected":return"fa-user-shield";case"2fa":return"fa-lock";case"permission_denied":return"fa-ban";default:return"fa-circle-info"}}fr(()=>{ot.refreshCounter,w()});var Ce={...Ht()},Ee=rf(),Z=i(s(Ee),2);x(()=>mt(Z,20,()=>[{id:"overview",label:"Overview",icon:"fa-chart-pie"},{id:"audit",label:"Audit Trail",icon:"fa-scroll"},{id:"cost",label:"Cost Tracking",icon:"fa-dollar-sign"},{id:"rate",label:"Rate Limits",icon:"fa-gauge-high"},{id:"2fa",label:"2FA",icon:"fa-lock"}],Ft,(T,k)=>{var R=Eu();let ee;var W=s(R),le=i(W,1,!0);S(()=>{ee=Le(R,1,"px-3 py-1.5 text-sm rounded-t transition-colors",null,ee,{"bg-card":O(t(C),k.id),"text-heading":O(t(C),k.id),"text-muted":O(t(C),k.id,!1),"hover:text-heading":O(t(C),k.id,!1)}),Le(W,1,`fa-solid ${k.icon??""} mr-1`),_(le,k.label)}),X("click",R,function(){return se(k.id)}),d(T,R)}),"each",Je,198,8);var ye=i(Z,2);{var Be=T=>{var k=er(),R=We(k);{var ee=le=>{var ke=Su(),Ae=We(ke),q=s(Ae),B=s(q),L=s(B),K=i(q,2),ce=s(K),he=s(ce),ge=i(K,2),V=s(ge);let M;var _e=s(V),P=i(V,2),ae=i(s(P));{var de=Et=>{var Zt=ua();S(mr=>_(Zt,`/ ${mr??""}`),[()=>be(t(n).daily_limit_usd)]),d(Et,Zt)};x(()=>g(ae,Et=>{t(n).daily_limit_usd>0&&Et(de)}),"if",Je,236,24)}var F=i(ge,2),ne=s(F);let pe;var ie=s(ne),H=i(Ae,2),Q=s(H),E=s(Q),J=s(E),xe=i(Q,2),oe=s(xe),ue=s(oe),Te=i(xe,2),ze=s(Te),Ne=s(ze),Fe=i(Te,2),Ie=s(Fe),fe=s(Ie),we=i(H,2),Pe=s(we),He=i(s(Pe),2),Ge=s(He),rt=i(s(Ge)),gt=s(rt),qe=i(Ge,2),je=i(s(qe)),Ve=s(je),ft=i(qe,2),Nt=i(s(ft)),Kt=s(Nt),Xe=i(ft,2),Ye=i(s(Xe)),yt=s(Ye),st=i(Xe,2),Qe=i(s(st)),ct=s(Qe),lt=i(st,2),at=i(s(lt)),wt=s(at),Dt=i(Pe,2),Yt=i(s(Dt),2),kt=s(Yt),Pt=i(s(kt)),Ke=s(Pt),Ze=i(kt,2),Ct=i(s(Ze)),Qt=s(Ct),Ut=i(Ze,2),Me=i(s(Ut),2);let tt;var Lt=s(Me),At=i(Ut,2),tr=i(s(At)),Tr=s(tr),or=i(At,2),$r=i(s(or)),Rt=s($r);S((Et,Zt,mr,ya,ls,la)=>{_(L,t(a).total_events),_(he,t(a).tool_calls),M=Le(V,1,"text-2xl font-bold",null,M,{"text-red-400":t(n).limit_exceeded,"text-green-400":!t(n).limit_exceeded}),_(_e,Et),pe=Le(ne,1,"text-2xl font-bold",null,pe,{"text-orange-400":t(o).is_limited,"text-green-400":!t(o).is_limited}),_(ie,`${t(o).calls_last_minute??""}/${(t(o).limit_per_minute||"∞")??""}`),_(J,t(a).approvals),_(ue,t(a).rejections),_(Ne,t(a).rate_limits),_(fe,t(a).pii_detections),_(gt,Zt),_(Ve,mr),_(Kt,ya),_(yt,ls),_(ct,la),_(wt,t(n).today_requests),_(Ke,`${t(o).calls_last_minute??""} / ${(t(o).limit_per_minute||"∞")??""}`),_(Qt,`${t(o).calls_last_hour??""} / ${(t(o).limit_per_hour||"∞")??""}`),tt=Le(Me,1,"",null,tt,{"text-red-400":t(o).is_limited,"text-green-400":!t(o).is_limited}),_(Lt,t(o).is_limited?"RATE LIMITED":"OK"),_(Tr,t(a).twofa_challenges),_(Rt,t(a).permission_denials)},[()=>be(t(n).today_usd),()=>be(t(n).today_usd),()=>be(t(n).month_usd),()=>be(t(n).total_usd),()=>Oe(t(n).today_tokens),()=>Oe(t(n).total_tokens)]),d(le,ke)},W=le=>{var ke=Cu();d(le,ke)};x(()=>g(R,le=>{t(a)&&t(n)&&t(o)?le(ee):le(W,!1)}),"if",Je,220,8)}d(T,k)},De=T=>{var k=Ku(),R=We(k),ee=s(R),W=s(ee);W.value=W.__value="";var le=i(W);le.value=le.__value="tool_call";var ke=i(le);ke.value=ke.__value="approval";var Ae=i(ke);Ae.value=Ae.__value="rate_limit";var q=i(Ae);q.value=q.__value="pii_detected";var B=i(q);B.value=B.__value="2fa";var L=i(B);L.value=L.__value="permission_denied",Qi("bind:value={auditFilter.event_type}",[],()=>y,()=>"event_type",303,81);var K=i(ee,2);Qi("bind:value={auditFilter.tool}",[],()=>y,()=>"tool",316,16);var ce=i(K,2),he=i(R,2);{var ge=P=>{var ae=Au();d(P,ae)},V=P=>{var ae=Du();x(()=>mt(ae,21,()=>t(p),Ft,(de,F)=>{var ne=Nu(),pe=s(ne),ie=i(pe,2),H=s(ie),Q=s(H),E=s(Q,!0);var J=i(Q,2);{var xe=qe=>{var je=Pu(),Ve=s(je,!0);S(()=>_(Ve,t(F).tool)),d(qe,je)};x(()=>g(J,qe=>{t(F).tool&&qe(xe)}),"if",Je,334,32)}var oe=i(J,2);{var ue=qe=>{var je=Ou(),Ve=s(je,!0);S(()=>_(Ve,t(F).action)),d(qe,je)};x(()=>g(oe,qe=>{t(F).action&&qe(ue)}),"if",Je,337,32)}var Te=i(oe,2);{var ze=qe=>{var je=ju();let Ve;var ft=s(je,!0);S(()=>{Ve=Le(je,1,"text-xs",null,Ve,{"text-green-400":t(F).success,"text-red-400":!t(F).success}),_(ft,t(F).success?"✓":"✗")}),d(qe,je)};x(()=>g(Te,qe=>{O(t(F).success,null,!1)&&qe(ze)}),"if",Je,340,32)}var Ne=i(Te,2),Fe=s(Ne,!0);var Ie=i(H,2);{var fe=qe=>{var je=Lu(),Ve=s(je);S(()=>_(Ve,`Reasoning: ${t(F).reasoning??""}`)),d(qe,je)};x(()=>g(Ie,qe=>{t(F).reasoning&&qe(fe)}),"if",Je,347,28)}var we=i(Ie,2);{var Pe=qe=>{var je=Ru(),Ve=s(je);S(()=>_(Ve,`Result: ${t(F).result??""}`)),d(qe,je)};x(()=>g(we,qe=>{t(F).result&&qe(Pe)}),"if",Je,350,28)}var He=i(we,2),Ge=s(He),rt=s(Ge,!0);var gt=i(Ge,2);S((qe,je,Ve,ft)=>{Le(pe,1,`fa-solid ${qe??""} ${je??""} mt-0.5`),Le(Q,1,`font-semibold ${Ve??""}`),_(E,t(F).event_type),_(Fe,t(F).source),_(rt,ft)},[()=>Se(t(F).event_type),()=>me(t(F).event_type),()=>me(t(F).event_type),()=>ga(t(F).created_at)]),X("click",gt,function(){return re(t(F).id)}),d(de,ne)}),"each",Je,328,16),d(P,ae)};x(()=>g(he,P=>{O(t(p).length,0)?P(ge):P(V,!1)}),"if",Je,324,8)}var M=i(he,2);{var _e=P=>{var ae=qu(),de=s(ae),F=s(de),ne=i(s(F),2),pe=i(F,2);{var ie=Q=>{var E=Iu();d(Q,E)},H=Q=>{var E=Gu();x(()=>mt(E,21,()=>t(m),Ft,(J,xe,oe)=>{var ue=Bu();let Te;var ze=s(ue),Ne=s(ze),Fe=i(Ne);{var Ie=je=>{var Ve=Mu(),ft=s(Ve);S(()=>_(ft,`(${t(xe).tool??""})`)),d(je,Ve)};x(()=>g(Fe,je=>{t(xe).tool&&je(Ie)}),"if",Je,383,40)}var fe=i(ze,2);{var we=je=>{var Ve=Fu(),ft=i(s(Ve));S(()=>_(ft,` ${t(xe).reasoning??""}`)),d(je,Ve)};x(()=>g(fe,je=>{t(xe).reasoning&&je(we)}),"if",Je,385,36)}var Pe=i(fe,2);{var He=je=>{var Ve=Uu(),ft=s(Ve);S(()=>_(ft,`Context: ${t(xe).user_context??""}`)),d(je,Ve)};x(()=>g(Pe,je=>{t(xe).user_context&&je(He)}),"if",Je,388,36)}var Ge=i(Pe,2);{var rt=je=>{var Ve=zu(),ft=s(Ve);S(()=>_(ft,`Result: ${t(xe).result??""}`)),d(je,Ve)};x(()=>g(Ge,je=>{t(xe).result&&je(rt)}),"if",Je,391,36)}var gt=i(Ge,2),qe=s(gt,!0);S((je,Ve,ft)=>{Te=Le(ue,1,"border-l-2 pl-3",null,Te,je),Le(ze,1,`text-sm font-semibold ${Ve??""}`),_(Ne,`Step ${oe+1}: ${t(xe).event_type??""} `),_(qe,ft)},[()=>({"border-blue-400":O(t(xe).event_type,"tool_call"),"border-yellow-400":O(t(xe).event_type,"approval"),"border-red-400":O(t(xe).event_type,"pii_detected")||O(t(xe).event_type,"permission_denied"),"border-border":!["tool_call","approval","pii_detected","permission_denied"].includes(t(xe).event_type)}),()=>me(t(xe).event_type),()=>ga(t(xe).created_at)]),d(J,ue)}),"each",Je,379,28),d(Q,E)};x(()=>g(pe,Q=>{O(t(m).length,0)?Q(ie):Q(H,!1)}),"if",Je,375,20)}X("click",ae,function(){return f(b,!1)}),X("click",de,function(E){return E.stopPropagation()}),X("click",ne,function(){return f(b,!1)}),d(P,ae)};x(()=>g(M,P=>{t(b)&&P(_e)}),"if",Je,366,8)}X("change",ee,function(){return h()}),Xs(ee,function(){return y.event_type},function(ae){y.event_type=ae}),X("keyup",K,function(ae){O(ae.key,"Enter")&&h()}),St(K,function(){return y.tool},function(ae){y.tool=ae}),X("click",ce,function(){return h()}),d(T,k)},U=T=>{var k=er(),R=We(k);{var ee=le=>{var ke=Wu(),Ae=We(ke),q=s(Ae),B=s(q);let L;var K=s(B),ce=i(B,4);{var he=oe=>{var ue=Vu(),Te=We(ue),ze=s(Te);let Ne;var Fe=i(Te,2),Ie=s(Fe);S((fe,we)=>{Ne=Le(ze,1,"h-2 rounded-full transition-all",null,Ne,{"bg-green-400":!t(n).limit_exceeded,"bg-red-400":t(n).limit_exceeded}),us(ze,`width: ${fe??""}%`),_(Ie,`Limit: ${we??""}`)},[()=>Math.min(100,t(n).today_usd/t(n).daily_limit_usd*100),()=>be(t(n).daily_limit_usd)]),d(oe,ue)};x(()=>g(ce,oe=>{t(n).daily_limit_usd>0&&oe(he)}),"if",Je,412,20)}var ge=i(q,2),V=s(ge),M=s(V),_e=i(ge,2),P=s(_e),ae=s(P),de=i(Ae,2),F=s(de),ne=s(F),pe=s(ne),ie=i(F,2),H=s(ie),Q=s(H),E=i(ie,2),J=s(E),xe=s(J);S((oe,ue,Te,ze,Ne)=>{L=Le(B,1,"text-3xl font-bold",null,L,{"text-red-400":t(n).limit_exceeded,"text-green-400":!t(n).limit_exceeded}),_(K,oe),_(M,ue),_(ae,Te),_(pe,ze),_(Q,Ne),_(xe,t(n).today_requests)},[()=>be(t(n).today_usd),()=>be(t(n).month_usd),()=>be(t(n).total_usd),()=>Oe(t(n).today_tokens),()=>Oe(t(n).total_tokens)]),d(le,ke)},W=le=>{var ke=Hu();d(le,ke)};x(()=>g(R,le=>{t(n)?le(ee):le(W,!1)}),"if",Je,405,8)}d(T,k)},te=T=>{var k=er(),R=We(k);{var ee=le=>{var ke=Qu(),Ae=i(s(ke),2),q=s(Ae),B=s(q),L=i(s(B),2),K=s(L),ce=i(B,2);{var he=ie=>{var H=Ju(),Q=s(H);let E;S(J=>{E=Le(Q,1,"h-3 rounded-full transition-all",null,E,{"bg-green-400":t(o).calls_last_minute/t(o).limit_per_minute<.8,"bg-yellow-400":t(o).calls_last_minute/t(o).limit_per_minute>=.8&&t(o).calls_last_minute/t(o).limit_per_minute<1,"bg-red-400":t(o).calls_last_minute/t(o).limit_per_minute>=1}),us(Q,`width: ${J??""}%`)},[()=>Math.min(100,t(o).calls_last_minute/t(o).limit_per_minute*100)]),d(ie,H)};x(()=>g(ce,ie=>{t(o).limit_per_minute>0&&ie(he)}),"if",Je,462,24)}var ge=i(q,2),V=s(ge),M=i(s(V),2),_e=s(M),P=i(V,2);{var ae=ie=>{var H=Yu(),Q=s(H);let E;S(J=>{E=Le(Q,1,"h-3 rounded-full transition-all",null,E,{"bg-green-400":t(o).calls_last_hour/t(o).limit_per_hour<.8,"bg-yellow-400":t(o).calls_last_hour/t(o).limit_per_hour>=.8&&t(o).calls_last_hour/t(o).limit_per_hour<1,"bg-red-400":t(o).calls_last_hour/t(o).limit_per_hour>=1}),us(Q,`width: ${J??""}%`)},[()=>Math.min(100,t(o).calls_last_hour/t(o).limit_per_hour*100)]),d(ie,H)};x(()=>g(P,ie=>{t(o).limit_per_hour>0&&ie(ae)}),"if",Je,479,24)}var de=i(ge,2),F=s(de);let ne;var pe=s(F);S(()=>{_(K,`${t(o).calls_last_minute??""} / ${(t(o).limit_per_minute||"∞")??""}`),_(_e,`${t(o).calls_last_hour??""} / ${(t(o).limit_per_hour||"∞")??""}`),us(de,`background-color: ${t(o).is_limited?"rgba(248,113,113,0.1)":"rgba(74,222,128,0.1)"}`),ne=Le(F,1,"text-lg font-bold",null,ne,{"text-green-400":!t(o).is_limited,"text-red-400":t(o).is_limited}),_(pe,t(o).is_limited?"RATE LIMITED":"Within Limits")}),d(le,ke)},W=le=>{var ke=Zu();d(le,ke)};x(()=>g(R,le=>{t(o)?le(ee):le(W,!1)}),"if",Je,453,8)}d(T,k)},$e=T=>{var k=tf(),R=s(k),ee=i(s(R),2),W=i(R,2);{var le=Ae=>{var q=Xu();d(Ae,q)},ke=Ae=>{var q=er(),B=We(q);x(()=>mt(B,17,()=>t(l),Ft,(L,K)=>{var ce=ef(),he=s(ce),ge=i(s(he),2),V=s(ge),M=s(V),_e=s(M,!0);var P=i(M,2),ae=s(P,!0);var de=i(P,2),F=s(de);var ne=i(V,2),pe=s(ne,!0);var ie=i(ne,2),H=s(ie),Q=i(H,2);S(()=>{_(_e,t(K).tool),_(ae,t(K).source),_(F,`${t(K).age_secs??""}s ago`),_(pe,t(K).description)}),X("click",H,function(){return j(t(K).id)}),X("click",Q,function(){return z(t(K).id)}),d(L,ce)}),"each",Je,522,16),d(Ae,q)};x(()=>g(W,Ae=>{O(t(l).length,0)?Ae(le):Ae(ke,!1)}),"if",Je,512,12)}X("click",ee,function(){return Y()}),d(T,k)};x(()=>g(ye,T=>{O(t(C),"overview")?T(Be):O(t(C),"audit")?T(De,1):O(t(C),"cost")?T(U,2):O(t(C),"rate")?T(te,3):O(t(C),"2fa")&&T($e,4)}),"if",Je,219,4)}return d(e,Ee),qt(Ce)}ar(["click","change","keyup"]);Re[c]="src/components/OperationsTab.svelte";var af=v(u("<button><i></i> </button>"),Re[c],[[180,12,[[184,16]]]]),sf=v(u('<p class="text-muted">Checking health...</p>'),Re[c],[[196,16]]),nf=v(u('<div class="grid grid-cols-1 sm:grid-cols-3 gap-3 mt-3"><div class="bg-surface rounded p-3"><div class="text-xs text-muted mb-1">Database</div> <div> </div></div> <div class="bg-surface rounded p-3"><div class="text-xs text-muted mb-1">Agent</div> <div> </div></div> <div class="bg-surface rounded p-3"><div class="text-xs text-muted mb-1">Tools</div> <div class="font-mono text-fg"> </div></div></div>'),Re[c],[[207,24,[[208,28,[[209,32],[210,32]]],[214,28,[[215,32],[216,32]]],[220,28,[[221,32],[222,32]]]]]]),of=v(u('<div class="space-y-3"><div class="flex items-center gap-3"><span> </span> <span class="text-muted text-sm"> </span></div> <!> <button class="btn-secondary text-sm mt-2"><i class="fa-solid fa-rotate mr-1"></i> Refresh</button></div>'),Re[c],[[198,16,[[199,20,[[200,24],[203,24]]],[227,20,[[228,24]]]]]]),lf=v(u(`<div class="card"><h3 class="text-lg font-semibold mb-3"><i class="fa-solid fa-heart-pulse mr-1"></i> Health Check</h3> <!></div> <div class="card"><h3 class="text-lg font-semibold mb-2"><i class="fa-solid fa-chart-bar mr-1"></i> Prometheus Metrics</h3> <p class="text-sm text-muted mb-2">Metrics are exposed at <code class="bg-surface px-1.5 py-0.5 rounded font-mono text-accent">/metrics</code> in Prometheus text format.</p> <p class="text-sm text-muted">Point your Prometheus scrape config or Grafana agent at this endpoint.
                No authentication is required for <code class="bg-surface px-1 py-0.5 rounded font-mono">/metrics</code>.</p> <div class="mt-2"><button class="btn-secondary text-sm"><i class="fa-solid fa-arrow-up-right-from-square mr-1"></i> View Raw Metrics</button></div></div>`,1),Re[c],[[191,8,[[192,12,[[193,16]]]]],[235,8,[[236,12,[[237,16]]],[239,12,[[240,39]]],[242,12,[[244,50]]],[246,12,[[247,16,[[248,20]]]]]]]]),df=v(u('<span class="text-sm text-muted">&rarr;</span> <span class="font-mono text-green-400"> </span> <span class="bg-green-500/20 text-green-400 text-xs px-2 py-0.5 rounded">Update Available</span>',1),Re[c],[[266,28],[267,28],[268,28]]),cf=v(u('<span class="bg-surface text-muted text-xs px-2 py-0.5 rounded">Up to date</span>'),Re[c],[[270,28]]),vf=v(u('<div class="bg-surface rounded p-3 text-sm"><div class="text-xs text-muted mb-1">Release Notes</div> <pre class="whitespace-pre-wrap text-fg"> </pre></div>'),Re[c],[[275,24,[[276,28],[277,28]]]]),uf=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Applying...',1),Re[c],[[285,36]]),ff=v(u('<i class="fa-solid fa-rocket mr-1"></i> Apply Update',1),Re[c],[[287,36]]),pf=v(u('<a target="_blank" class="btn-secondary text-sm"><i class="fa-solid fa-arrow-up-right-from-square mr-1"></i> View Release</a>'),Re[c],[[291,32,[[292,36]]]]),xf=v(u('<div class="flex gap-2"><button class="btn-primary text-sm"><!></button> <!></div>'),Re[c],[[282,24,[[283,28]]]]),mf=v(u('<div class="flex items-center gap-3 flex-wrap"><span class="text-sm text-muted">Current:</span> <span class="font-mono text-fg"> </span> <!></div> <!> <!>',1),Re[c],[[262,20,[[263,24],[264,24]]]]),_f=v(u('<div class="bg-surface rounded p-2 text-sm text-muted"> </div>'),Re[c],[[300,20]]),bf=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Checking...',1),Re[c],[[305,24]]),gf=v(u('<i class="fa-solid fa-magnifying-glass mr-1"></i> Check for Updates',1),Re[c],[[307,24]]),hf=v(u('<div class="card"><h3 class="text-lg font-semibold mb-3"><i class="fa-solid fa-download mr-1"></i> Auto-Update</h3> <div class="space-y-3"><!> <!> <button class="btn-secondary text-sm"><!></button></div></div>'),Re[c],[[256,8,[[257,12,[[258,16]]],[260,12,[[303,16]]]]]]),yf=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Exporting...',1),Re[c],[[328,28]]),wf=v(u('<i class="fa-solid fa-download mr-1"></i> Download Backup',1),Re[c],[[330,28]]),kf=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Restoring...',1),Re[c],[[344,28]]),Tf=v(u('<i class="fa-solid fa-upload mr-1"></i> Upload Backup File',1),Re[c],[[346,28]]),$f=v(u('<div class="bg-surface rounded p-2 text-sm text-muted mt-2"> </div>'),Re[c],[[351,24]]),Ef=v(u('<div class="card"><h3 class="text-lg font-semibold mb-3"><i class="fa-solid fa-box-archive mr-1"></i> Backup & Restore</h3> <div class="space-y-4"><div><h4 class="text-sm font-medium mb-2">Export Backup</h4> <p class="text-xs text-muted mb-2">Download a JSON export of all agent data (memory, activity, goals, cron jobs, stats).</p> <button class="btn-primary text-sm"><!></button></div> <hr class="border-border"/> <div><h4 class="text-sm font-medium mb-2">Restore from Backup</h4> <p class="text-xs text-muted mb-2">Upload a previously exported backup file. Existing data will be merged (INSERT OR REPLACE).</p> <label><!> <input type="file" accept=".json" class="hidden"/></label> <!></div></div></div>'),Re[c],[[316,8,[[317,12,[[318,16]]],[320,12,[[321,16,[[322,20],[323,20],[326,20]]],[335,16],[337,16,[[338,20],[339,20],[342,20,[[348,24]]]]]]]]]]),Sf=v(u('<p class="text-muted">Loading federation status...</p>'),Re[c],[[366,16]]),Cf=v(u('<span class="text-sm text-muted">Node:</span> <span class="font-mono text-sm text-fg"> </span> <span class="text-xs text-muted font-mono"> </span>',1),Re[c],[[374,28],[375,28],[376,28]]),Af=v(u('<p class="text-sm text-muted">Federation is not enabled. Add <code class="bg-surface px-1 py-0.5 rounded font-mono">[federation]</code> with <code class="bg-surface px-1 py-0.5 rounded font-mono">enabled = true</code> to your config to enable multi-node features.</p>'),Re[c],[[381,24,[[382,59],[382,139]]]]),Pf=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i>'),Re[c],[[398,36]]),Of=v(u('<i class="fa-solid fa-plus mr-1"></i>'),Re[c],[[400,36]]),jf=v(u('<div class="text-sm text-muted"> </div>'),Re[c],[[406,28]]),Lf=v(u('<div class="bg-surface rounded p-3 flex items-center justify-between"><div><span class="font-mono text-sm text-fg"> </span> <span class="text-xs text-muted ml-2"> </span> <span> </span> <span class="text-xs text-muted ml-2"> </span></div> <button class="text-red-400 hover:text-red-300 text-sm" title="Remove peer"><i class="fa-solid fa-xmark"></i></button></div>'),Re[c],[[414,36,[[415,40,[[416,44],[417,44],[418,44],[421,44]]],[423,40,[[424,44]]]]]]),Rf=v(u('<div class="space-y-2"></div>'),Re[c],[[412,28]]),Nf=v(u('<p class="text-sm text-muted">No peers connected.</p>'),Re[c],[[430,28]]),Df=v(u('<div class="flex gap-2 items-end"><div class="flex-1"><label class="text-xs text-muted block mb-1">Add Peer Address</label> <input type="text" placeholder="http://192.168.1.101:3031" class="w-full bg-surface border border-border rounded px-3 py-1.5 text-sm font-mono"/></div> <button class="btn-primary text-sm"><!> Add</button></div> <!> <h4 class="text-sm font-medium"> </h4> <!>',1),Re[c],[[386,24,[[387,28,[[388,32],[389,32]]],[396,28]]],[410,24]]),If=v(u('<div class="space-y-4"><div class="flex items-center gap-3"><span> </span> <!></div> <!> <button class="btn-secondary text-sm"><i class="fa-solid fa-rotate mr-1"></i> Refresh</button></div>'),Re[c],[[368,16,[[369,20,[[370,24]]],[434,20,[[435,24]]]]]]),Mf=v(u('<div class="card"><h3 class="text-lg font-semibold mb-3"><i class="fa-solid fa-network-wired mr-1"></i> Multi-Node Federation</h3> <!></div>'),Re[c],[[360,8,[[361,12,[[362,16]]]]]]),Ff=v(u('<p class="text-muted">Loading backends...</p>'),Re[c],[[450,16]]),Uf=v(u('<div><i></i> <span class="font-mono text-sm"> </span></div>'),Re[c],[[462,28,[[463,32],[464,32]]]]),zf=v(u(`<div class="space-y-3"><div class="flex items-center gap-3"><span class="text-sm text-muted">Active:</span> <span class="bg-accent/20 text-accent px-2 py-1 rounded font-mono text-sm"> </span> <span class="text-sm text-muted"> </span></div> <h4 class="text-sm font-medium mt-3">Available Backends</h4> <div class="grid grid-cols-2 sm:grid-cols-3 gap-2"></div> <p class="text-xs text-muted mt-2">To switch backends, set <code class="bg-surface px-1 py-0.5 rounded font-mono">backend</code> in <code class="bg-surface px-1 py-0.5 rounded font-mono">[llm]</code> config or the <code class="bg-surface px-1 py-0.5 rounded font-mono">LLM_BACKEND</code> env var and restart.
                        Custom backends can be registered as plugins at runtime.</p> <button class="btn-secondary text-sm"><i class="fa-solid fa-rotate mr-1"></i> Refresh</button></div>`),Re[c],[[452,16,[[453,20,[[454,24],[455,24],[456,24]]],[459,20],[460,20],[469,20,[[470,48],[470,121],[470,203]]],[474,20,[[475,24]]]]]]),Bf=v(u('<div class="card"><h3 class="text-lg font-semibold mb-3"><i class="fa-solid fa-brain mr-1"></i> LLM Backend Plugins</h3> <!></div>'),Re[c],[[444,8,[[445,12,[[446,16]]]]]]),Gf=v(u('<div class="space-y-4"><div class="flex gap-2 mb-4 flex-wrap"></div> <!> <!> <!> <!> <!></div>'),Re[c],[[177,0,[[178,4]]]]);function Re(e,r){Wt(new.target),Gt(r,!0,Re);let a=$(A("health"),"activeSection"),n=$(A(null),"health"),o=$(A(!0),"healthLoading"),l=$(A(null),"updateInfo"),p=$(A(!1),"updateLoading"),m=$(A(!1),"updateApplying"),b=$(A(""),"updateMessage"),C=$(A(!1),"backupLoading"),y=$(A(!1),"restoreLoading"),w=$(A(""),"restoreMessage"),h=$(A(null),"fedStatus"),D=$(A(!0),"fedLoading"),I=$(A(""),"addPeerAddress"),Y=$(A(!1),"addPeerLoading"),j=$(A(""),"addPeerMessage"),z=$(A(null),"backends"),re=$(A(!0),"backendsLoading");async function se(){f(o,!0);try{const B=(await N(fetch("/healthz")))();f(n,(await N(B.json()))(),!0)}catch{f(n,{status:"error",checks:{}},!0)}f(o,!1)}async function be(){f(p,!0),f(b,"");try{const B=(await N(fetch("/api/update/check")))();f(l,(await N(B.json()))(),!0)}catch{f(b,"Failed to check for updates")}f(p,!1)}async function Oe(){f(m,!0),f(b,"");try{const B=(await N(fetch("/api/update/apply",{method:"POST"})))(),L=(await N(B.json()))();f(b,L.message||(L.ok?"Update applied":"Update failed"),!0)}catch{f(b,"Failed to apply update")}f(m,!1)}async function me(){f(C,!0);try{const B=(await N(fetch("/api/backup")))(),L=(await N(B.blob()))(),K=URL.createObjectURL(L),ce=document.createElement("a");ce.href=K,ce.download=`safe-agent-backup-${new Date().toISOString().slice(0,10)}.json`,ce.click(),URL.revokeObjectURL(K)}catch(B){console.error(...bt("error","Backup download failed",B))}f(C,!1)}async function Se(B){var K;const L=B.target;if((K=L.files)!=null&&K.length){f(y,!0),f(w,"");try{const ce=(await N(L.files[0].text()))(),he=JSON.parse(ce),ge=(await N(fetch("/api/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)})))(),V=(await N(ge.json()))();f(w,V.message||(V.ok?"Restore complete":"Restore failed"),!0)}catch{f(w,"Failed to restore backup")}f(y,!1),L.value=""}}async function Ce(){f(D,!0);try{const B=(await N(fetch("/api/federation/status")))();f(h,(await N(B.json()))(),!0)}catch{f(h,{enabled:!1,peers:[]},!0)}f(D,!1)}async function Ee(){if(t(I).trim()){f(Y,!0),f(j,"");try{const B=(await N(fetch("/api/federation/peers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:t(I)})})))(),L=(await N(B.json()))();f(j,L.message||(L.ok?"Peer added":"Failed"),!0),L.ok&&(f(I,""),Ce())}catch{f(j,"Failed to add peer")}f(Y,!1)}}async function Z(B){try{(await N(fetch(`/api/federation/peers/${B}`,{method:"DELETE"})))(),Ce()}catch(L){console.error(...bt("error","Failed to remove peer",L))}}async function ye(){f(re,!0);try{const B=(await N(fetch("/api/llm/backends")))();f(z,(await N(B.json()))(),!0)}catch{f(z,{active:"unknown",available:[]},!0)}f(re,!1)}os(()=>{se(),Ce(),ye()});const Be=[{id:"health",label:"Health",icon:"fa-heart-pulse"},{id:"update",label:"Updates",icon:"fa-download"},{id:"backup",label:"Backup",icon:"fa-box-archive"},{id:"federation",label:"Federation",icon:"fa-network-wired"},{id:"backends",label:"LLM Backends",icon:"fa-brain"}];var De={...Ht()},U=Gf(),te=s(U);x(()=>mt(te,21,()=>Be,Ft,(B,L)=>{var K=af(),ce=s(K),he=i(ce);S(()=>{Le(K,1,`px-3 py-1.5 rounded text-sm transition-colors ${O(t(a),t(L).id)?"bg-accent text-white":"bg-surface text-muted hover:text-fg"}`),Le(ce,1,`fa-solid ${t(L).icon??""} mr-1`),_(he,` ${t(L).label??""}`)}),X("click",K,function(){return f(a,t(L).id,!0)}),d(B,K)}),"each",Re,179,8);var $e=i(te,2);{var T=B=>{var L=lf(),K=We(L),ce=i(s(K),2);{var he=P=>{var ae=sf();d(P,ae)},ge=P=>{var ae=of(),de=s(ae),F=s(de),ne=s(F),pe=i(F,2),ie=s(pe),H=i(de,2);{var Q=J=>{var xe=nf(),oe=s(xe),ue=i(s(oe),2),Te=s(ue),ze=i(oe,2),Ne=i(s(ze),2),Fe=s(Ne),Ie=i(ze,2),fe=i(s(Ie),2),we=s(fe);S(()=>{Le(ue,1,`font-mono ${O(t(n).checks.database,"ok")?"text-green-400":"text-red-400"}`),_(Te,t(n).checks.database),Le(Ne,1,`font-mono ${O(t(n).checks.agent,"running")?"text-green-400":"text-yellow-400"}`),_(Fe,t(n).checks.agent),_(we,t(n).checks.tools)}),d(J,xe)};x(()=>g(H,J=>{t(n).checks&&J(Q)}),"if",Re,206,20)}var E=i(H,2);S(J=>{Le(F,1,`px-3 py-1 rounded text-sm font-mono font-bold ${O(t(n).status,"healthy")?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`),_(ne,J),_(ie,`v${t(n).version??""}`)},[()=>{var J;return(J=t(n).status)==null?void 0:J.toUpperCase()}]),X("click",E,se),d(P,ae)};x(()=>g(ce,P=>{t(o)?P(he):t(n)&&P(ge,1)}),"if",Re,195,12)}var V=i(K,2),M=i(s(V),6),_e=s(M);X("click",_e,function(){return window.open("/metrics","_blank")}),d(B,L)};x(()=>g($e,B=>{O(t(a),"health")&&B(T)}),"if",Re,190,4)}var k=i($e,2);{var R=B=>{var L=hf(),K=i(s(L),2),ce=s(K);{var he=de=>{var F=mf(),ne=We(F),pe=i(s(ne),2),ie=s(pe),H=i(pe,2);{var Q=Te=>{var ze=df(),Ne=i(We(ze),2),Fe=s(Ne);S(()=>_(Fe,`v${t(l).latest_version??""}`)),d(Te,ze)},E=Te=>{var ze=cf();d(Te,ze)};x(()=>g(H,Te=>{t(l).update_available?Te(Q):Te(E,!1)}),"if",Re,265,24)}var J=i(ne,2);{var xe=Te=>{var ze=vf(),Ne=i(s(ze),2),Fe=s(Ne);S(()=>_(Fe,t(l).release_notes)),d(Te,ze)};x(()=>g(J,Te=>{t(l).update_available&&t(l).release_notes&&Te(xe)}),"if",Re,274,20)}var oe=i(J,2);{var ue=Te=>{var ze=xf(),Ne=s(ze),Fe=s(Ne);{var Ie=He=>{var Ge=uf();d(He,Ge)},fe=He=>{var Ge=ff();d(He,Ge)};x(()=>g(Fe,He=>{t(m)?He(Ie):He(fe,!1)}),"if",Re,284,32)}var we=i(Ne,2);{var Pe=He=>{var Ge=pf();S(()=>Vt(Ge,"href",t(l).release_url)),d(He,Ge)};x(()=>g(we,He=>{t(l).release_url&&He(Pe)}),"if",Re,290,28)}S(()=>Ne.disabled=t(m)),X("click",Ne,Oe),d(Te,ze)};x(()=>g(oe,Te=>{t(l).update_available&&Te(ue)}),"if",Re,281,20)}S(()=>_(ie,`v${t(l).current_version??""}`)),d(de,F)};x(()=>g(ce,de=>{t(l)&&de(he)}),"if",Re,261,16)}var ge=i(ce,2);{var V=de=>{var F=_f(),ne=s(F);S(()=>_(ne,t(b))),d(de,F)};x(()=>g(ge,de=>{t(b)&&de(V)}),"if",Re,299,16)}var M=i(ge,2),_e=s(M);{var P=de=>{var F=bf();d(de,F)},ae=de=>{var F=gf();d(de,F)};x(()=>g(_e,de=>{t(p)?de(P):de(ae,!1)}),"if",Re,304,20)}S(()=>M.disabled=t(p)),X("click",M,be),d(B,L)};x(()=>g(k,B=>{O(t(a),"update")&&B(R)}),"if",Re,255,4)}var ee=i(k,2);{var W=B=>{var L=Ef(),K=i(s(L),2),ce=s(K),he=i(s(ce),4),ge=s(he);{var V=H=>{var Q=yf();d(H,Q)},M=H=>{var Q=wf();d(H,Q)};x(()=>g(ge,H=>{t(C)?H(V):H(M,!1)}),"if",Re,327,24)}var _e=i(ce,4),P=i(s(_e),4),ae=s(P);{var de=H=>{var Q=kf();d(H,Q)},F=H=>{var Q=Tf();d(H,Q)};x(()=>g(ae,H=>{t(y)?H(de):H(F,!1)}),"if",Re,343,24)}var ne=i(ae,2),pe=i(P,2);{var ie=H=>{var Q=$f(),E=s(Q);S(()=>_(E,t(w))),d(H,Q)};x(()=>g(pe,H=>{t(w)&&H(ie)}),"if",Re,350,20)}S(()=>{he.disabled=t(C),Le(P,1,`btn-secondary text-sm inline-flex items-center cursor-pointer ${t(y)?"opacity-50":""}`),ne.disabled=t(y)}),X("click",he,me),X("change",ne,Se),d(B,L)};x(()=>g(ee,B=>{O(t(a),"backup")&&B(W)}),"if",Re,315,4)}var le=i(ee,2);{var ke=B=>{var L=Mf(),K=i(s(L),2);{var ce=ge=>{var V=Sf();d(ge,V)},he=ge=>{var V=If(),M=s(V),_e=s(M),P=s(_e),ae=i(_e,2);{var de=H=>{var Q=Cf(),E=i(We(Q),2),J=s(E),xe=i(E,2),oe=s(xe);S(ue=>{_(J,t(h).node.name),_(oe,`(${ue??""}...)`)},[()=>t(h).node.node_id.slice(0,8)]),d(H,Q)};x(()=>g(ae,H=>{t(h).node&&H(de)}),"if",Re,373,24)}var F=i(M,2);{var ne=H=>{var Q=Af();d(H,Q)},pe=H=>{var Q=Df(),E=We(Q),J=s(E),xe=i(s(J),2),oe=i(J,2),ue=s(oe);{var Te=Ge=>{var rt=Pf();d(Ge,rt)},ze=Ge=>{var rt=Of();d(Ge,rt)};x(()=>g(ue,Ge=>{t(Y)?Ge(Te):Ge(ze,!1)}),"if",Re,397,32)}var Ne=i(E,2);{var Fe=Ge=>{var rt=jf(),gt=s(rt);S(()=>_(gt,t(j))),d(Ge,rt)};x(()=>g(Ne,Ge=>{t(j)&&Ge(Fe)}),"if",Re,405,24)}var Ie=i(Ne,2),fe=s(Ie),we=i(Ie,2);{var Pe=Ge=>{var rt=Rf();x(()=>mt(rt,21,()=>t(h).peers,Ft,(gt,qe)=>{var je=Lf(),Ve=s(je),ft=s(Ve),Nt=s(ft,!0);var Kt=i(ft,2),Xe=s(Kt,!0);var Ye=i(Kt,2),yt=s(Ye,!0);var st=i(Ye,2),Qe=s(st);var ct=i(Ve,2);S(()=>{_(Nt,t(qe).name),_(Xe,t(qe).address),Le(Ye,1,`ml-2 px-1.5 py-0.5 rounded text-xs ${O(t(qe).status,"online")?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`),_(yt,t(qe).status),_(Qe,`v${t(qe).version??""}`)}),X("click",ct,function(){return Z(t(qe).node_id)}),d(gt,je)}),"each",Re,413,32),d(Ge,rt)},He=Ge=>{var rt=Nf();d(Ge,rt)};x(()=>g(we,Ge=>{var rt;(rt=t(h).peers)!=null&&rt.length?Ge(Pe):Ge(He,!1)}),"if",Re,411,24)}S(()=>{oe.disabled=t(Y),_(fe,`Peers (${(t(h).peer_count||0)??""})`)}),St(xe,function(){return t(I)},function(rt){f(I,rt)}),X("click",oe,Ee),d(H,Q)};x(()=>g(F,H=>{t(h).enabled?H(pe,!1):H(ne)}),"if",Re,380,20)}var ie=i(F,2);S(()=>{Le(_e,1,`px-2 py-1 rounded text-xs font-semibold ${t(h).enabled?"bg-green-500/20 text-green-400":"bg-surface text-muted"}`),_(P,t(h).enabled?"ENABLED":"DISABLED")}),X("click",ie,Ce),d(ge,V)};x(()=>g(K,ge=>{t(D)?ge(ce):t(h)&&ge(he,1)}),"if",Re,365,12)}d(B,L)};x(()=>g(le,B=>{O(t(a),"federation")&&B(ke)}),"if",Re,359,4)}var Ae=i(le,2);{var q=B=>{var L=Bf(),K=i(s(L),2);{var ce=ge=>{var V=Ff();d(ge,V)},he=ge=>{var V=zf(),M=s(V),_e=i(s(M),2),P=s(_e),ae=i(_e,2),de=s(ae),F=i(M,4);x(()=>mt(F,21,()=>t(z).available,Ft,(pe,ie)=>{var H=Uf(),Q=s(H),E=i(Q,2),J=s(E,!0);S(()=>{Le(H,1,`bg-surface rounded p-3 flex items-center gap-2 ${O(t(ie),t(z).active)?"ring-1 ring-accent":""}`),Le(Q,1,`fa-solid ${O(t(ie),t(z).active)?"fa-circle-check text-accent":"fa-circle text-muted"} text-xs`),_(J,t(ie))}),d(pe,H)}),"each",Re,461,24);var ne=i(F,4);S(()=>{_(P,t(z).active),_(de,`(${t(z).active_info??""})`)}),X("click",ne,ye),d(ge,V)};x(()=>g(K,ge=>{t(re)?ge(ce):t(z)&&ge(he,1)}),"if",Re,449,12)}d(B,L)};x(()=>g(Ae,B=>{O(t(a),"backends")&&B(q)}),"if",Re,443,4)}return d(e,U),qt(De)}ar(["click","change"]);jt[c]="src/components/UsersPanel.svelte";var qf=v(u('<button class="btn-primary text-sm"><i class="fa-solid fa-plus mr-1"></i> New User</button>'),jt[c],[[142,12,[[143,16]]]]),Kf=v(u('<div class="bg-surface rounded p-2 text-sm text-muted mb-3"> </div>'),jt[c],[[149,8]]),Vf=v(u('<div class="bg-surface rounded p-4 mb-4 space-y-3"><h4 class="text-sm font-medium">Create User</h4> <div class="grid grid-cols-1 sm:grid-cols-2 gap-3"><div><label class="text-xs text-muted block mb-1">Username *</label> <input type="text" placeholder="jdoe" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div> <div><label class="text-xs text-muted block mb-1">Display Name</label> <input type="text" placeholder="Jane Doe" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div> <div><label class="text-xs text-muted block mb-1">Role</label> <select class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"><option>Admin</option><option>User</option><option>Viewer</option></select></div> <div><label class="text-xs text-muted block mb-1">Password</label> <input type="password" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div> <div><label class="text-xs text-muted block mb-1">Email</label> <input type="email" placeholder="jane@example.com" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div> <div><label class="text-xs text-muted block mb-1">Telegram User ID</label> <input type="text" placeholder="123456789" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div> <div><label class="text-xs text-muted block mb-1">WhatsApp Number</label> <input type="text" placeholder="+15551234567" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div></div> <div class="flex gap-2"><button class="btn-primary text-sm"><i class="fa-solid fa-check mr-1"></i> Create</button> <button class="btn-secondary text-sm">Cancel</button></div></div>'),jt[c],[[154,8,[[155,12],[156,12,[[157,16,[[158,20],[159,20]]],[161,16,[[162,20],[163,20]]],[165,16,[[166,20],[167,20,[[168,24],[169,24],[170,24]]]]],[173,16,[[174,20],[175,20]]],[177,16,[[178,20],[179,20]]],[181,16,[[182,20],[183,20]]],[185,16,[[186,20],[187,20]]]]],[190,12,[[191,16,[[192,20]]],[194,16]]]]]]),Wf=v(u('<p class="text-muted text-sm">Loading users...</p>'),jt[c],[[201,8]]),Hf=v(u('<p class="text-muted text-sm">No users configured. The agent operates in single-user mode.</p>'),jt[c],[[203,8]]),Jf=v(u('<span class="px-1.5 py-0.5 rounded text-xs bg-red-500/20 text-red-400">disabled</span>'),jt[c],[[218,36]]),Yf=v(u('<span><i class="fa-solid fa-envelope mr-0.5"></i> </span>'),jt[c],[[223,36,[[223,42]]]]),Qf=v(u('<span><i class="fa-brands fa-telegram mr-0.5"></i> </span>'),jt[c],[[226,36,[[226,42]]]]),Zf=v(u('<span><i class="fa-brands fa-whatsapp mr-0.5"></i> </span>'),jt[c],[[229,36,[[229,42]]]]),Xf=v(u('<div class="flex items-center gap-2 flex-shrink-0"><select class="bg-bg border border-border rounded px-2 py-1 text-xs"><option>Admin</option><option>User</option><option>Viewer</option></select> <button> </button> <button class="text-xs px-2 py-1 rounded bg-red-500/20 text-red-400 hover:bg-red-500/30" title="Delete user"><i class="fa-solid fa-trash"></i></button></div>'),jt[c],[[237,24,[[238,28,[[243,32],[244,32],[245,32]]],[247,28],[254,28,[[259,32]]]]]]),ep=v(u('<div class="bg-surface rounded p-3 flex items-center justify-between gap-3 flex-wrap"><div class="flex items-center gap-3 min-w-0"><div class="w-8 h-8 rounded-full bg-accent/20 flex items-center justify-center text-accent font-bold text-sm flex-shrink-0"> </div> <div class="min-w-0"><div class="flex items-center gap-2"><span class="font-medium text-fg truncate"> </span> <span class="text-xs text-muted font-mono"> </span> <span> </span> <!></div> <div class="flex gap-3 text-xs text-muted mt-0.5"><!> <!> <!> <span> </span></div></div></div> <!></div>'),jt[c],[[207,16,[[208,20,[[209,24],[212,24,[[213,28,[[214,32],[215,32],[216,32]]],[221,28,[[231,32]]]]]]]]]]),tp=v(u('<div class="space-y-2"></div>'),jt[c],[[205,8]]),rp=v(u('<div class="card"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold"><i class="fa-solid fa-users mr-1"></i> Users</h3> <!></div> <!> <!> <!></div>'),jt[c],[[136,0,[[137,4,[[138,8,[[139,12]]]]]]]]);function jt(e,r){Wt(new.target),Gt(r,!0,jt);let a=$(A(ht([])),"users"),n=$(A(!0),"loading"),o=$(A(!1),"showCreateForm"),l=$(A(""),"message"),p=$(A(""),"newUsername"),m=$(A(""),"newDisplayName"),b=$(A("user"),"newRole"),C=$(A(""),"newPassword"),y=$(A(""),"newEmail"),w=$(A(""),"newTelegramId"),h=$(A(""),"newWhatsappId");async function D(){f(n,!0);try{const k=(await N(fetch("/api/users")))(),R=(await N(k.json()))();f(a,R.users||[],!0)}catch{f(a,[],!0)}f(n,!1)}async function I(){f(l,"");const k={username:t(p),display_name:t(m)||t(p),role:t(b),password:t(C)};t(y)&&(k.email=t(y)),t(w)&&(k.telegram_id=parseInt(t(w))),t(h)&&(k.whatsapp_id=t(h));try{(await N(fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)})))().ok?(f(l,`User "${t(p)}" created`),f(p,""),f(m,""),f(b,"user"),f(C,""),f(y,""),f(w,""),f(h,""),f(o,!1),D()):f(l,"Failed to create user (username may already exist)")}catch{f(l,"Error creating user")}}async function Y(k){try{(await N(fetch(`/api/users/${k.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:!k.enabled})})))(),D()}catch{f(l,"Failed to update user")}}async function j(k,R){try{(await N(fetch(`/api/users/${k.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:R})})))(),D()}catch{f(l,"Failed to update role")}}async function z(k){if(confirm(`Delete user "${k.username}"? This cannot be undone.`))try{(await N(fetch(`/api/users/${k.id}`,{method:"DELETE"})))(),D()}catch{f(l,"Failed to delete user")}}function re(k){switch(k){case"admin":return"bg-red-500/20 text-red-400";case"viewer":return"bg-blue-500/20 text-blue-400";default:return"bg-green-500/20 text-green-400"}}function se(k){if(!k)return"Never";const R=new Date(k+"Z"),ee=Date.now()-R.getTime();return ee<6e4?"Just now":ee<36e5?`${Math.floor(ee/6e4)}m ago`:ee<864e5?`${Math.floor(ee/36e5)}h ago`:`${Math.floor(ee/864e5)}d ago`}os(D);const be=$(cr(()=>O(Tt.role,"admin")||!Tt.userId),"isAdmin");var Oe={...Ht()},me=rp(),Se=s(me),Ce=i(s(Se),2);{var Ee=k=>{var R=qf();X("click",R,function(){return f(o,!t(o))}),d(k,R)};x(()=>g(Ce,k=>{t(be)&&k(Ee)}),"if",jt,141,8)}var Z=i(Se,2);{var ye=k=>{var R=Kf(),ee=s(R);S(()=>_(ee,t(l))),d(k,R)};x(()=>g(Z,k=>{t(l)&&k(ye)}),"if",jt,148,4)}var Be=i(Z,2);{var De=k=>{var R=Vf(),ee=i(s(R),2),W=s(ee),le=i(s(W),2),ke=i(W,2),Ae=i(s(ke),2),q=i(ke,2),B=i(s(q),2),L=s(B);L.value=L.__value="admin";var K=i(L);K.value=K.__value="user";var ce=i(K);ce.value=ce.__value="viewer";var he=i(q,2),ge=i(s(he),2),V=i(he,2),M=i(s(V),2),_e=i(V,2),P=i(s(_e),2),ae=i(_e,2),de=i(s(ae),2),F=i(ee,2),ne=s(F),pe=i(ne,2);S(ie=>ne.disabled=ie,[()=>!t(p).trim()]),St(le,function(){return t(p)},function(H){f(p,H)}),St(Ae,function(){return t(m)},function(H){f(m,H)}),Xs(B,function(){return t(b)},function(H){f(b,H)}),St(ge,function(){return t(C)},function(H){f(C,H)}),St(M,function(){return t(y)},function(H){f(y,H)}),St(P,function(){return t(w)},function(H){f(w,H)}),St(de,function(){return t(h)},function(H){f(h,H)}),X("click",ne,I),X("click",pe,function(){return f(o,!1)}),d(k,R)};x(()=>g(Be,k=>{t(o)&&t(be)&&k(De)}),"if",jt,153,4)}var U=i(Be,2);{var te=k=>{var R=Wf();d(k,R)},$e=k=>{var R=Hf();d(k,R)},T=k=>{var R=tp();x(()=>mt(R,21,()=>t(a),Ft,(ee,W)=>{var le=ep(),ke=s(le),Ae=s(ke),q=s(Ae,!0);var B=i(Ae,2),L=s(B),K=s(L),ce=s(K,!0);var he=i(K,2),ge=s(he);var V=i(he,2),M=s(V,!0);var _e=i(V,2);{var P=oe=>{var ue=Jf();d(oe,ue)};x(()=>g(_e,oe=>{t(W).enabled||oe(P)}),"if",jt,217,32)}var ae=i(L,2),de=s(ae);{var F=oe=>{var ue=Yf(),Te=i(s(ue));S(()=>_(Te,` ${t(W).email??""}`)),d(oe,ue)};x(()=>g(de,oe=>{t(W).email&&oe(F)}),"if",jt,222,32)}var ne=i(de,2);{var pe=oe=>{var ue=Qf(),Te=i(s(ue));S(()=>_(Te,` ${t(W).telegram_id??""}`)),d(oe,ue)};x(()=>g(ne,oe=>{t(W).telegram_id&&oe(pe)}),"if",jt,225,32)}var ie=i(ne,2);{var H=oe=>{var ue=Zf(),Te=i(s(ue));S(()=>_(Te,` ${t(W).whatsapp_id??""}`)),d(oe,ue)};x(()=>g(ie,oe=>{t(W).whatsapp_id&&oe(H)}),"if",jt,228,32)}var Q=i(ie,2),E=s(Q);var J=i(ke,2);{var xe=oe=>{var ue=Xf(),Te=s(ue),ze=s(Te);ze.value=ze.__value="admin";var Ne=i(ze);Ne.value=Ne.__value="user";var Fe=i(Ne);Fe.value=Fe.__value="viewer";var Ie;Jn(Te);var fe=i(Te,2),we=s(fe,!0);var Pe=i(fe,2);S(()=>{Ie!==(Ie=t(W).role)&&(Te.value=(Te.__value=t(W).role)??"",Pi(Te,t(W).role)),Le(fe,1,`text-xs px-2 py-1 rounded ${t(W).enabled?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30":"bg-green-500/20 text-green-400 hover:bg-green-500/30"}`),Vt(fe,"title",t(W).enabled?"Disable user":"Enable user"),_(we,t(W).enabled?"Disable":"Enable")}),X("change",Te,function(Ge){return j(t(W),Ge.target.value)}),X("click",fe,function(){return Y(t(W))}),X("click",Pe,function(){return z(t(W))}),d(oe,ue)};x(()=>g(J,oe=>{t(be)&&oe(xe)}),"if",jt,236,20)}S((oe,ue,Te)=>{_(q,oe),_(ce,t(W).display_name||t(W).username),_(ge,`@${t(W).username??""}`),Le(V,1,`px-1.5 py-0.5 rounded text-xs font-semibold ${ue??""}`),_(M,t(W).role),_(E,`Last seen: ${Te??""}`)},[()=>{var oe,ue;return((ue=(oe=t(W).display_name)==null?void 0:oe.charAt(0))==null?void 0:ue.toUpperCase())||t(W).username.charAt(0).toUpperCase()},()=>re(t(W).role),()=>se(t(W).last_seen_at)]),d(ee,le)}),"each",jt,206,12),d(k,R)};x(()=>g(U,k=>{t(n)?k(te):O(t(a).length,0)?k($e,1):k(T,!1)}),"if",jt,200,4)}return d(e,me),qt(Oe)}ar(["click","change"]);xt[c]="src/components/TwoFactorPanel.svelte";var ap=v(u('<div class="card"><p class="text-text-muted text-sm"><i class="fa-solid fa-circle-info mr-1"></i> Two-factor authentication is only available for multi-user accounts.</p></div>'),xt[c],[[242,4,[[243,8,[[244,12]]]]]]),sp=v(u('<div class="card"><p class="text-text-muted text-sm"><i class="fa-solid fa-spinner fa-spin mr-1"></i> Loading 2FA status...</p></div>'),xt[c],[[249,4,[[250,8,[[250,43]]]]]]),ip=v(u("<div><i></i> </div>"),xt[c],[[255,12,[[256,16]]]]),np=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-green-900/40 text-green-400 border-green-800/50">Enabled</span>'),xt[c],[[272,20]]),op=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-zinc-800/60 text-text-subtle border-border">Disabled</span>'),xt[c],[[274,20]]),lp=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i>'),xt[c],[[300,32]]),dp=v(u('<p class="text-sm text-text-subtle mb-3">TOTP two-factor authentication is active. Enter your current code to disable it.</p> <div class="flex gap-2 items-end"><div><label class="text-xs text-text-muted block mb-1">TOTP Code</label> <input type="text" maxlength="6" placeholder="000000" class="w-32 bg-bg border border-border rounded px-3 py-1.5 text-sm font-mono tracking-widest text-center"/></div> <button class="px-3 py-1.5 text-sm rounded bg-red-600/80 text-white hover:bg-red-500 transition-colors disabled:opacity-50"><!> Disable 2FA</button></div>',1),xt[c],[[280,20],[283,20,[[284,24,[[285,28],[286,28]]],[294,24]]]]),cp=v(u('<p class="text-sm text-text-subtle mb-3">Add an extra layer of security by requiring a time-based code from your phone when signing in.</p> <button class="px-4 py-2 text-sm rounded bg-primary-600 text-white hover:bg-primary-500 transition-colors"><i class="fa-solid fa-shield-halved mr-1"></i> Set Up Authenticator</button>',1),xt[c],[[307,20],[310,20,[[314,24]]]]),vp=v(u('<div class="px-2 py-1 rounded bg-bg border border-border"><span class="text-text-muted mr-1"></span> </div>'),xt[c],[[349,40,[[350,44]]]]),up=v(u('<div class="grid grid-cols-2 gap-1 font-mono text-xs"></div>'),xt[c],[[347,32]]),fp=v(u('<div class="space-y-4"><div class="p-4 rounded-lg bg-surface border border-border"><p class="text-sm text-text mb-2 font-medium">1. Scan with your authenticator app:</p> <div class="bg-white p-4 rounded-lg inline-block"><img alt="TOTP QR Code" class="w-48 h-48"/></div> <p class="text-xs text-text-muted mt-3">Or enter this key manually:</p> <code class="block mt-1 px-3 py-2 rounded bg-bg border border-border text-sm font-mono break-all select-all"> </code></div> <div class="p-4 rounded-lg bg-surface border border-border"><p class="text-sm text-text mb-2 font-medium">2. Save your recovery codes:</p> <p class="text-xs text-text-subtle mb-2">Store these codes somewhere safe. Each code can only be used once.</p> <button class="text-xs text-primary-400 hover:text-primary-300 mb-2"> </button> <!></div> <div class="p-4 rounded-lg bg-surface border border-border"><p class="text-sm text-text mb-2 font-medium">3. Verify your setup:</p> <p class="text-xs text-text-subtle mb-2">Enter a code from your authenticator to confirm.</p> <div class="flex gap-2"><input type="text" maxlength="6" placeholder="000000" class="w-32 bg-bg border border-border rounded px-3 py-1.5 text-sm font-mono tracking-widest text-center"/> <button class="px-4 py-1.5 text-sm rounded bg-green-600 text-white hover:bg-green-500 transition-colors disabled:opacity-50"><i class="fa-solid fa-check mr-1"></i> Verify &amp; Enable</button> <button class="px-3 py-1.5 text-sm rounded border border-border text-text-muted hover:bg-surface-elevated transition-colors">Cancel</button></div></div></div>'),xt[c],[[318,20,[[319,24,[[320,28],[321,28,[[323,32]]],[329,28],[330,28]]],[335,24,[[336,28],[337,28],[340,28]]],[357,24,[[358,28],[359,28],[360,28,[[361,32],[369,32,[[374,36]]],[376,32]]]]]]]]),pp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-green-900/40 text-green-400 border-green-800/50"> </span>'),xt[c],[[401,24]]),xp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-zinc-800/60 text-text-subtle border-border">None</span>'),xt[c],[[405,24]]),mp=v(u('<div class="flex items-center justify-between p-2.5 rounded-md bg-surface border border-border/50"><div class="flex items-center gap-2.5"><i class="fa-solid fa-key text-text-muted"></i> <div><span class="text-sm text-text"> </span> <span class="text-xs text-text-subtle ml-2"> </span></div></div> <button class="text-xs px-2 py-1 rounded bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors" title="Delete passkey"><i class="fa-solid fa-trash"></i></button></div>'),xt[c],[[413,32,[[414,36,[[415,40],[416,40,[[417,44],[418,44]]]]],[421,36,[[426,40]]]]]]),_p=v(u('<div class="space-y-2 mb-4"></div>'),xt[c],[[411,24]]),bp=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Registering...',1),xt[c],[[450,32]]),gp=v(u('<i class="fa-solid fa-plus mr-1"></i> Add Passkey',1),xt[c],[[452,32]]),hp=v(u(`<p class="text-xs text-text-subtle mt-3"><i class="fa-solid fa-circle-info mr-1"></i> Passkeys use your device's biometric sensor, security key, or screen lock for passwordless 2FA.</p>`),xt[c],[[458,24,[[459,28]]]]),yp=v(u(`<div class="rounded-lg border border-border overflow-hidden"><div class="flex items-center justify-between p-3 bg-surface-elevated"><div class="flex items-center gap-2.5"><i class="fa-solid fa-fingerprint text-amber-400"></i> <div><span class="text-sm font-medium text-text">Passkeys</span> <p class="text-xs text-text-subtle mt-0.5">Use biometrics, security keys, or your device's screen lock</p></div></div> <!></div> <div class="p-4"><!> <div class="flex items-end gap-2"><div class="flex-1"><label class="text-xs text-text-muted block mb-1">Passkey Name</label> <input type="text" placeholder="e.g. MacBook Touch ID" class="w-full bg-bg border border-border rounded px-3 py-1.5 text-sm"/></div> <button class="px-4 py-1.5 text-sm rounded bg-primary-600 text-white hover:bg-primary-500 transition-colors disabled:opacity-50 whitespace-nowrap"><!></button></div> <!></div></div>`),xt[c],[[391,12,[[392,16,[[393,20,[[394,24],[395,24,[[396,28],[397,28]]]]]]],[408,16,[[434,20,[[435,24,[[436,28],[437,28]]],[444,24]]]]]]]]),wp=v(u(`<div class="space-y-4"><!> <div class="rounded-lg border border-border overflow-hidden"><div class="flex items-center justify-between p-3 bg-surface-elevated"><div class="flex items-center gap-2.5"><i class="fa-solid fa-clock text-primary-400"></i> <div><span class="text-sm font-medium text-text">Authenticator App (TOTP)</span> <p class="text-xs text-text-subtle mt-0.5">Use an app like Google Authenticator or Authy</p></div></div> <!></div> <div class="p-4"><!></div></div> <!> <div class="p-3 rounded-lg bg-surface-elevated border border-border/50"><p class="text-xs text-text-subtle"><i class="fa-solid fa-circle-info mr-1"></i> When 2FA is enabled, you'll need to provide a second factor (authenticator code or passkey) after entering your password. <!></p></div></div>`),xt[c],[[253,4,[[262,8,[[263,12,[[264,16,[[265,20],[266,20,[[267,24],[268,24]]]]]]],[277,12]]],[468,8,[[469,12,[[470,16]]]]]]]]);function xt(e,r){Wt(new.target),Gt(r,!0,xt);let a=$(A(null),"status"),n=$(A(ht([])),"passkeys"),o=$(A(!0),"loading"),l=$(A(""),"message"),p=$(A("success"),"messageType"),m=$(A("idle"),"setupStep"),b=$(A(""),"totpSecret"),C=$(A(""),"otpauthUri"),y=$(A(ht([])),"recoveryCodes"),w=$(A(""),"verifyCode"),h=$(A(!1),"showRecoveryCodes"),D=$(A(""),"passkeyName"),I=$(A(!1),"registeringPasskey"),Y=$(A(""),"disableCode"),j=$(A(!1),"disabling");async function z(){f(o,!0);try{const[k,R]=(await N(Promise.all([fetch("/api/auth/2fa/status"),fetch("/api/auth/passkeys")])))();f(a,(await N(k.json()))(),!0);const ee=(await N(R.json()))();f(n,ee.passkeys||[],!0)}catch{re("Failed to load 2FA status","error")}f(o,!1)}function re(k,R="success"){f(l,k,!0),f(p,R,!0),k&&setTimeout(()=>{f(l,"")},5e3)}async function se(){try{const k=(await N(fetch("/api/auth/2fa/setup",{method:"POST"})))(),R=(await N(k.json()))();R.ok?(f(b,R.secret,!0),f(C,R.otpauth_uri,!0),f(y,R.recovery_codes,!0),f(m,"showing_secret")):re(R.error||"Failed to set up TOTP","error")}catch{re("Failed to set up TOTP","error")}}async function be(){if(t(w).trim())try{const k=(await N(fetch("/api/auth/2fa/enable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t(w).trim()})})))(),R=(await N(k.json()))();R.ok?(re("TOTP 2FA enabled successfully"),f(m,"idle"),f(w,""),f(b,""),f(C,""),(await N(z()))()):re(R.error||"Invalid code","error")}catch{re("Failed to enable TOTP","error")}}async function Oe(){if(t(Y).trim()){f(j,!0);try{const k=(await N(fetch("/api/auth/2fa/disable",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t(Y).trim()})})))(),R=(await N(k.json()))();R.ok?(re("TOTP 2FA disabled"),f(Y,""),(await N(z()))()):re(R.error||"Invalid code","error")}catch{re("Failed to disable TOTP","error")}f(j,!1)}}async function me(){f(I,!0);try{const k=(await N(fetch("/api/auth/passkey/register/start",{method:"POST"})))(),R=(await N(k.json()))();if(!R.ok){re(R.error||"Failed to start passkey registration","error"),f(I,!1);return}const ee=R.options;if(ee.publicKey.challenge=Ce(ee.publicKey.challenge),ee.publicKey.user.id=Ce(ee.publicKey.user.id),ee.publicKey.excludeCredentials)for(const B of ee.publicKey.excludeCredentials)B.id=Ce(B.id);const W=(await N(navigator.credentials.create(ee)))();if(!W){re("Passkey creation was cancelled","error"),f(I,!1);return}const le=W.response,ke={credential:{id:W.id,rawId:Ee(W.rawId),response:{attestationObject:Ee(le.attestationObject),clientDataJSON:Ee(le.clientDataJSON)},type:W.type},name:t(D)||"Passkey"},Ae=(await N(fetch("/api/auth/passkey/register/finish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)})))(),q=(await N(Ae.json()))();q.ok?(re("Passkey registered successfully"),f(D,""),(await N(z()))()):re(q.error||"Failed to register passkey","error")}catch(k){O(k.name,"NotAllowedError")?re("Passkey creation was cancelled or timed out","error"):re(`Passkey registration failed: ${k.message}`,"error")}f(I,!1)}async function Se(k){if(confirm(`Delete passkey "${k.name}"?`))try{const R=(await N(fetch(`/api/auth/passkeys/${k.id}`,{method:"DELETE"})))(),ee=(await N(R.json()))();ee.ok?(re("Passkey deleted"),(await N(z()))()):re(ee.error||"Failed to delete passkey","error")}catch{re("Failed to delete passkey","error")}}function Ce(k){const R=k.replace(/-/g,"+").replace(/_/g,"/"),ee=R+"=".repeat((4-R.length%4)%4),W=atob(ee),le=new ArrayBuffer(W.length),ke=new Uint8Array(le);for(let Ae=0;Ae<W.length;Ae++)ke[Ae]=W.charCodeAt(Ae);return le}function Ee(k){const R=new Uint8Array(k);let ee="";for(const W of R)ee+=String.fromCharCode(W);return btoa(ee).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Z(k){const R=new Date(k+"Z"),ee=Date.now()-R.getTime();return ee<6e4?"Just now":ee<36e5?`${Math.floor(ee/6e4)}m ago`:ee<864e5?`${Math.floor(ee/36e5)}h ago`:`${Math.floor(ee/864e5)}d ago`}const ye=$(cr(()=>!!Tt.userId),"hasUserId");os(()=>{t(ye)&&z()});var Be={...Ht()},De=er(),U=We(De);{var te=k=>{var R=ap();d(k,R)},$e=k=>{var R=sp();d(k,R)},T=k=>{var R=wp(),ee=s(R);{var W=F=>{var ne=ip(),pe=s(ne),ie=i(pe);S(()=>{Le(ne,1,`px-3 py-2 rounded-md text-sm ${O(t(p),"error")?"bg-red-900/20 border border-red-800/40 text-red-400":"bg-green-900/20 border border-green-800/40 text-green-400"}`),Le(pe,1,`fa-solid ${O(t(p),"error")?"fa-circle-exclamation":"fa-check-circle"} mr-1`),_(ie,` ${t(l)??""}`)}),d(F,ne)};x(()=>g(ee,F=>{t(l)&&F(W)}),"if",xt,254,8)}var le=i(ee,2),ke=s(le),Ae=i(s(ke),2);{var q=F=>{var ne=np();d(F,ne)},B=F=>{var ne=op();d(F,ne)};x(()=>g(Ae,F=>{t(a).totp_enabled?F(q):F(B,!1)}),"if",xt,271,16)}var L=i(ke,2),K=s(L);{var ce=F=>{var ne=dp(),pe=i(We(ne),2),ie=s(pe),H=i(s(ie),2),Q=i(ie,2),E=s(Q);{var J=xe=>{var oe=lp();d(xe,oe)};x(()=>g(E,xe=>{t(j)&&xe(J)}),"if",xt,299,28)}S(xe=>Q.disabled=xe,[()=>t(j)||O(t(Y).trim().length,6,!1)]),St(H,function(){return t(Y)},function(oe){f(Y,oe)}),X("click",Q,Oe),d(F,ne)},he=F=>{var ne=cp(),pe=i(We(ne),2);X("click",pe,se),d(F,ne)},ge=F=>{var ne=fp(),pe=s(ne),ie=i(s(pe),2),H=s(ie),Q=i(ie,4),E=s(Q),J=i(pe,2),xe=i(s(J),4),oe=s(xe),ue=i(xe,2);{var Te=we=>{var Pe=up();x(()=>mt(Pe,21,()=>t(y),Ft,(He,Ge,rt)=>{var gt=vp(),qe=s(gt);qe.textContent=`${rt+1}.`;var je=i(qe);S(()=>_(je,` ${t(Ge)??""}`)),d(He,gt)}),"each",xt,348,36),d(we,Pe)};x(()=>g(ue,we=>{t(h)&&we(Te)}),"if",xt,346,28)}var ze=i(J,2),Ne=i(s(ze),4),Fe=s(Ne),Ie=i(Fe,2),fe=i(Ie,2);S((we,Pe)=>{Vt(H,"src",`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${we??""}`),_(E,t(b)),_(oe,`${t(h)?"Hide":"Show"} recovery codes`),Ie.disabled=Pe},[()=>encodeURIComponent(t(C)),()=>O(t(w).trim().length,6,!1)]),X("click",xe,function(){return f(h,!t(h))}),X("keydown",Fe,function(Pe){O(Pe.key,"Enter")&&be()}),St(Fe,function(){return t(w)},function(Pe){f(w,Pe)}),X("click",Ie,be),X("click",fe,function(){f(m,"idle"),f(b,""),f(C,"")}),d(F,ne)};x(()=>g(K,F=>{t(a).totp_enabled?F(ce):O(t(m),"idle")?F(he,1):O(t(m),"showing_secret")&&F(ge,2)}),"if",xt,278,16)}var V=i(le,2);{var M=F=>{var ne=yp(),pe=s(ne),ie=i(s(pe),2);{var H=Pe=>{var He=pp(),Ge=s(He);S(()=>_(Ge,`${t(a).passkey_count??""} registered`)),d(Pe,He)},Q=Pe=>{var He=xp();d(Pe,He)};x(()=>g(ie,Pe=>{t(a).passkey_count>0?Pe(H):Pe(Q,!1)}),"if",xt,400,20)}var E=i(pe,2),J=s(E);{var xe=Pe=>{var He=_p();x(()=>mt(He,21,()=>t(n),Ft,(Ge,rt)=>{var gt=mp(),qe=s(gt),je=i(s(qe),2),Ve=s(je),ft=s(Ve,!0);var Nt=i(Ve,2),Kt=s(Nt);var Xe=i(qe,2);S(Ye=>{_(ft,t(rt).name),_(Kt,`Added ${Ye??""}`)},[()=>Z(t(rt).created_at)]),X("click",Xe,function(){return Se(t(rt))}),d(Ge,gt)}),"each",xt,412,28),d(Pe,He)};x(()=>g(J,Pe=>{t(n).length>0&&Pe(xe)}),"if",xt,410,20)}var oe=i(J,2),ue=s(oe),Te=i(s(ue),2),ze=i(ue,2),Ne=s(ze);{var Fe=Pe=>{var He=bp();d(Pe,He)},Ie=Pe=>{var He=gp();d(Pe,He)};x(()=>g(Ne,Pe=>{t(I)?Pe(Fe):Pe(Ie,!1)}),"if",xt,449,28)}var fe=i(oe,2);{var we=Pe=>{var He=hp();d(Pe,He)};x(()=>g(fe,Pe=>{O(t(n).length,0)&&Pe(we)}),"if",xt,457,20)}S(()=>ze.disabled=t(I)),St(Te,function(){return t(D)},function(He){f(D,He)}),X("click",ze,me),d(F,ne)};x(()=>g(V,F=>{t(a).passkeys_available&&F(M)}),"if",xt,390,8)}var _e=i(V,2),P=s(_e),ae=i(s(P),2);{var de=F=>{var ne=ua("You can use either your authenticator app or a passkey.");d(F,ne)};x(()=>g(ae,F=>{t(a).totp_enabled&&t(a).passkey_count>0&&F(de)}),"if",xt,472,16)}d(k,R)};x(()=>g(U,k=>{t(ye)?t(o)?k($e,1):t(a)&&k(T,2):k(te)}),"if",xt,241,0)}return d(e,De),qt(Be)}ar(["click","keydown"]);ve[c]="src/components/SettingsTab.svelte";var kp=v(u('<p class="text-text-subtle text-sm italic text-center py-2">Loading...</p>'),ve[c],[[260,12]]),Tp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-green-900/40 text-green-400 border-green-800/50">Connected</span>'),ve[c],[[273,24]]),$p=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-red-900/40 text-red-400 border-red-800/50">Disconnected</span>'),ve[c],[[275,24]]),Ep=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-zinc-800/60 text-text-subtle border-border">Disabled</span>'),ve[c],[[277,24]]),Sp=v(u('<div class="flex justify-between"><span class="text-text-muted">Allowed Chat IDs</span> <span class="text-text font-mono text-xs"> </span></div>'),ve[c],[[292,24,[[293,28],[294,28]]]]),Cp=v(u('<div class="flex justify-between"><span class="text-text-muted">Allowed Chat IDs</span> <span class="text-amber-400 text-xs"><i class="fa-solid fa-triangle-exclamation mr-1"></i> None (all denied)</span></div>'),ve[c],[[299,24,[[300,28],[301,28,[[302,32]]]]]]),Ap=v(u('<div class="flex justify-between"><span class="text-text-muted">Primary Channel</span> <span class="text-text font-mono text-xs"> </span></div>'),ve[c],[[307,24,[[308,28],[309,28]]]]),Pp=v(u('<div class="mt-2 p-2 rounded bg-zinc-800/40 border border-border/50"><p class="text-xs text-text-subtle"><i class="fa-solid fa-circle-info mr-1"></i> Enable Telegram by setting <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">telegram.enabled = true</code> in your config and providing a <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">TELEGRAM_BOT_TOKEN</code> env var.</p></div>'),ve[c],[[313,24,[[314,28,[[315,32],[316,59],[316,183]]]]]]),Op=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-zinc-800/60 text-text-subtle border-border">Disabled</span>'),ve[c],[[334,24]]),jp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-green-900/40 text-green-400 border-green-800/50">Connected</span>'),ve[c],[[336,24]]),Lp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-amber-900/40 text-amber-400 border-amber-800/50">Pairing</span>'),ve[c],[[338,24]]),Rp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-red-900/40 text-red-400 border-red-800/50"> </span>'),ve[c],[[340,24]]),Np=v(u('<div class="flex justify-between"><span class="text-text-muted">Allowed Numbers</span> <span class="text-text font-mono text-xs"> </span></div>'),ve[c],[[358,28,[[359,32],[360,32]]]]),Dp=v(u('<div class="flex justify-between"><span class="text-text-muted">Allowed Numbers</span> <span class="text-amber-400 text-xs"><i class="fa-solid fa-triangle-exclamation mr-1"></i> None (all denied)</span></div>'),ve[c],[[365,28,[[366,32],[367,32,[[368,36]]]]]]),Ip=v(u('<div class="flex justify-between"><span class="text-text-muted">Connected Number</span> <span class="text-green-400 font-mono text-xs"> </span></div>'),ve[c],[[373,28,[[374,32],[375,32]]]]),Mp=v(u('<img alt="WhatsApp QR Code" class="mx-auto w-52 h-52 rounded-lg shadow-lg"/>'),ve[c],[[386,36]]),Fp=v(u('<div class="w-52 h-52 mx-auto bg-zinc-800 rounded-lg flex items-center justify-center"><span class="text-text-subtle text-sm">Waiting for QR...</span></div>'),ve[c],[[388,36,[[389,40]]]]),Up=v(u('<div class="mt-3 p-4 rounded-lg bg-surface border border-amber-800/50 text-center"><p class="text-sm text-amber-400 mb-3"><i class="fa-solid fa-qrcode mr-1.5"></i> Scan this QR code with WhatsApp to pair</p> <!> <button class="mt-3 px-4 py-1.5 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-arrows-rotate mr-1"></i> Refresh QR</button></div>'),ve[c],[[381,28,[[382,32,[[383,36]]],[392,32,[[396,36]]]]]]),zp=v(u('<div class="flex justify-between"><span class="text-text-muted">Bridge Port</span> <span class="text-text font-mono text-xs"> </span></div> <div class="flex justify-between"><span class="text-text-muted">Webhook Port</span> <span class="text-text font-mono text-xs"> </span></div> <!> <!> <!>',1),ve[c],[[349,24,[[350,28],[351,28]]],[353,24,[[354,28],[355,28]]]]),Bp=v(u(`<div class="mt-2 p-2 rounded bg-zinc-800/40 border border-border/50"><p class="text-xs text-text-subtle"><i class="fa-solid fa-circle-info mr-1"></i> Enable WhatsApp by setting <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">whatsapp.enabled = true</code> in your config and adding allowed numbers.
                                The Baileys bridge requires Node.js in the container.</p></div>`),ve[c],[[401,24,[[402,28,[[403,32],[404,59]]]]]]),Gp=v(u('<div class="rounded-lg border border-border overflow-hidden"><div class="flex items-center justify-between p-3 bg-surface-elevated"><div class="flex items-center gap-2.5"><i class="fa-brands fa-telegram text-blue-400 text-lg"></i> <div><span class="text-sm font-medium text-text">Telegram</span> <p class="text-xs text-text-subtle mt-0.5">Long-polling bot via teloxide</p></div></div> <!></div> <div class="p-3 space-y-2 text-sm"><div class="flex justify-between"><span class="text-text-muted">Enabled</span> <span class="text-text"> </span></div> <div class="flex justify-between"><span class="text-text-muted">Bot Token</span> <span> </span></div> <!> <!> <!></div></div> <div class="rounded-lg border border-border overflow-hidden"><div class="flex items-center justify-between p-3 bg-surface-elevated"><div class="flex items-center gap-2.5"><i class="fa-brands fa-whatsapp text-green-400 text-lg"></i> <div><span class="text-sm font-medium text-text">WhatsApp</span> <p class="text-xs text-text-subtle mt-0.5">Baileys bridge (Node.js)</p></div></div> <!></div> <div class="p-3 space-y-2 text-sm"><div class="flex justify-between"><span class="text-text-muted">Enabled</span> <span class="text-text"> </span></div> <!></div></div> <div class="flex items-center gap-3 p-2.5 rounded-lg bg-surface-elevated border border-border/50"><i class="fa-solid fa-circle-info text-text-subtle"></i> <span class="text-xs text-text-subtle"> <!> — the primary messaging backend is used by the <code class="px-1 py-0.5 bg-zinc-900 rounded">message</code> tool.</span></div>',1),ve[c],[[263,12,[[264,16,[[265,20,[[266,24],[267,24,[[268,28],[269,28]]]]]]],[280,16,[[281,20,[[282,24],[283,24]]],[285,20,[[286,24],[287,24]]]]]]],[324,12,[[325,16,[[326,20,[[327,24],[328,24,[[329,28],[330,28]]]]]]],[343,16,[[344,20,[[345,24],[346,24]]]]]]],[413,12,[[414,16],[415,16,[[420,67]]]]]]),qp=v(u('<p class="text-text-subtle text-sm italic text-center py-2">Loading...</p>'),ve[c],[[436,12]]),Kp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-green-900/40 text-green-400 border-green-800/50">Enabled</span>'),ve[c],[[447,28]]),Vp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-zinc-800/60 text-text-subtle border-border">Disabled</span>'),ve[c],[[449,28]]),Wp=v(u('<p>Password authentication is active via the <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">DASHBOARD_PASSWORD</code> env var.</p>'),ve[c],[[454,28,[[454,73]]]]),Hp=v(u("<p>Password login is disabled. Users must sign in via SSO.</p>"),ve[c],[[456,28]]),Jp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-green-900/40 text-green-400 border-green-800/50"> </span>'),ve[c],[[469,28]]),Yp=v(u('<span class="text-xs px-2 py-0.5 rounded-full border bg-zinc-800/60 text-text-subtle border-border">None</span>'),ve[c],[[473,28]]),Qp=v(u('<div class="flex items-center gap-2 p-2 rounded-md bg-surface border border-border/50"><i></i> <span class="text-sm text-text"> </span> <span class="text-xs px-1.5 py-0.5 rounded bg-primary-900/30 text-primary-400 border border-primary-800/30 ml-auto">SSO</span></div>'),ve[c],[[480,36,[[481,40],[482,40],[483,40]]]]),Zp=v(u('<div class="space-y-1.5"></div>'),ve[c],[[478,28]]),Xp=v(u('<p class="text-sm text-text-subtle">No SSO providers configured. Add providers to <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">[dashboard].sso_providers</code> in config.</p>'),ve[c],[[488,28,[[489,78]]]]),e2=v(u('<div class="p-3 rounded-lg bg-red-900/20 border border-red-800/40"><p class="text-sm text-red-400"><i class="fa-solid fa-triangle-exclamation mr-1"></i> Password login is disabled and no SSO providers are configured. You may be locked out after your session expires.</p></div>'),ve[c],[[497,16,[[498,20,[[499,24]]]]]]),t2=v(u(`<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="rounded-lg border border-border overflow-hidden"><div class="flex items-center justify-between p-3 bg-surface-elevated"><div class="flex items-center gap-2.5"><i class="fa-solid fa-key text-amber-400"></i> <span class="text-sm font-medium text-text">Password Login</span></div> <!></div> <div class="p-3 text-sm text-text-subtle"><!></div></div> <div class="rounded-lg border border-border overflow-hidden"><div class="flex items-center justify-between p-3 bg-surface-elevated"><div class="flex items-center gap-2.5"><i class="fa-solid fa-right-to-bracket text-primary-400"></i> <span class="text-sm font-medium text-text">SSO Providers</span></div> <!></div> <div class="p-3"><!></div></div></div> <!> <div class="p-3 rounded bg-surface-elevated border border-border/50"><p class="text-xs text-text-subtle"><i class="fa-solid fa-circle-info mr-1"></i> Configure SSO in your <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">config.toml</code>:</p> <code class="block mt-2 whitespace-pre-wrap text-xs text-text-subtle leading-relaxed">[dashboard]
password_enabled = true
sso_providers = ["google", "github"]
sso_allowed_emails = ["you@example.com"]</code> <p class="text-xs text-text-subtle mt-2">SSO reuses the same OAuth client credentials (e.g. <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">GOOGLE_CLIENT_ID</code>). The SSO callback URL is <code class="px-1 py-0.5 bg-zinc-900 rounded text-text-muted">/api/auth/sso/&#123;provider&#125;/callback</code>.</p></div>`,1),ve[c],[[438,12,[[440,16,[[441,20,[[442,24,[[443,28],[444,28]]]]],[452,20]]],[462,16,[[463,20,[[464,24,[[465,28],[466,28]]]]],[476,20]]]]],[505,12,[[506,16,[[507,20],[508,42]]],[510,16],[514,16,[[515,71],[515,183]]]]]]),r2=v(u('<span class="text-xs text-text-muted pr-3"> </span>'),ve[c],[[541,12]]),a2=v(u('<p class="text-text-subtle text-sm italic text-center py-2">Loading...</p>'),ve[c],[[548,12]]),s2=v(u('<button class="px-2 py-0.5 text-xs border border-border rounded bg-surface hover:bg-surface-elevated transition-colors disabled:opacity-50" title="Refresh all"><i></i></button>'),ve[c],[[569,32,[[575,36]]]]),i2=v(u("<span> </span>"),ve[c],[[598,48]]),n2=v(u('<span class="text-amber-400"><i class="fa-solid fa-triangle-exclamation"></i> No refresh token</span>'),ve[c],[[601,48,[[602,52]]]]),o2=v(u('<div class="flex items-center justify-between p-2 rounded-md bg-surface border border-border/50"><div class="min-w-0 flex-1 space-y-0.5"><div class="text-sm text-text truncate"> </div> <div class="flex items-center gap-2 text-xs text-text-subtle"><!> <!></div></div> <div class="flex gap-1.5 ml-2 flex-shrink-0"><button class="px-2 py-1 text-xs border border-border rounded bg-surface hover:bg-surface-elevated transition-colors disabled:opacity-50" title="Refresh"><i></i></button> <button class="px-2 py-1 text-xs border border-red-800/50 rounded bg-red-900/20 text-red-400 hover:bg-red-900/40 transition-colors" title="Disconnect"><i class="fa-solid fa-xmark"></i></button></div></div>'),ve[c],[[593,32,[[594,36,[[595,40],[596,40]]],[607,36,[[608,40,[[614,44]]],[616,40,[[621,44]]]]]]]]),l2=v(u('<div class="mt-1.5 space-y-1.5 pl-7"></div>'),ve[c],[[591,24]]),d2=v(u('<div class="mb-3 last:mb-0"><div role="button" tabindex="0" class="w-full flex items-center justify-between p-2.5 rounded-lg bg-surface-elevated border border-border hover:border-text-subtle/30 transition-colors cursor-pointer"><div class="flex items-center gap-2"><i></i> <span class="text-sm font-medium text-text"> </span> <span class="text-xs px-1.5 py-0.5 rounded-full bg-green-900/40 text-green-400 border border-green-800/50"> </span></div> <div class="flex items-center gap-2"><!> <a class="px-2 py-0.5 text-xs border border-border rounded bg-surface hover:bg-surface-elevated transition-colors text-text-muted" title="Add account"><i class="fa-solid fa-plus"></i></a> <i></i></div></div> <!></div>'),ve[c],[[552,16,[[553,20,[[560,24,[[561,28],[562,28],[563,28]]],[567,24,[[578,28,[[584,32]]],[586,28]]]]]]]]),c2=v(u('<a class="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-md border border-border bg-surface hover:bg-surface-elevated hover:border-text-subtle/30 transition-colors text-text"><i></i> </a>'),ve[c],[[638,32,[[642,36]]]]),v2=v(u('<span class="inline-flex items-center gap-1.5 px-3 py-1.5 text-xs rounded-md border border-border/50 bg-surface text-text-subtle opacity-50 cursor-not-allowed"><i></i> </span>'),ve[c],[[645,32,[[649,36]]]]),u2=v(u('<div class="mt-3 pt-3 border-t border-border/50"><p class="text-xs text-text-subtle mb-2 uppercase tracking-wider">Available Integrations</p> <div class="flex flex-wrap gap-2"></div></div>'),ve[c],[[633,16,[[634,20],[635,20]]]]),f2=v(u('<p class="text-text-subtle text-sm italic text-center py-2">No OAuth providers available.</p>'),ve[c],[[658,16]]),p2=v(u("<!> <!> <!>",1),ve[c],[]),x2=v(u('<span class="text-xs text-text-subtle">(per-user override)</span>'),ve[c],[[682,24]]),m2=v(u('<span class="text-xs text-text-subtle">(system default)</span>'),ve[c],[[684,24]]),_2=v(u("<option></option>"),ve[c],[[711,32]]),b2=v(u("<option></option>"),ve[c],[[714,32]]),g2=v(u('<i class="fa-solid fa-spinner fa-spin mr-1"></i> Saving...',1),ve[c],[[749,28]]),h2=v(u('<i class="fa-solid fa-floppy-disk mr-1"></i> Save',1),ve[c],[[751,28]]),y2=v(u("<span> </span>"),ve[c],[[755,24]]),w2=v(u(`<div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm"><div class="p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-text-muted text-xs uppercase tracking-wide">Current Time</span> <p class="text-text font-medium mt-1"> </p></div> <div class="p-3 rounded-lg bg-surface-elevated border border-border"><span class="text-text-muted text-xs uppercase tracking-wide">Effective Timezone</span> <p class="text-text font-medium mt-1"> </p> <!></div></div> <div class="space-y-3"><div><div class="flex items-center gap-2 mb-1"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Timezone</span> <button class="text-[10px] px-1.5 py-0.5 rounded border border-border bg-surface-elevated text-text-muted hover:text-text transition-colors"><i class="fa-solid fa-crosshairs mr-0.5"></i> Detect</button></div> <div class="relative"><input type="text" list="tz-list" class="w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text text-sm
                                   placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50"/> <datalist id="tz-list"><!><!></datalist></div> <p class="text-xs text-text-subtle mt-1"> </p></div> <div><div class="flex items-center gap-2 mb-1"><span class="text-xs font-medium text-text-muted uppercase tracking-wide">Locale</span> <button class="text-[10px] px-1.5 py-0.5 rounded border border-border bg-surface-elevated text-text-muted hover:text-text transition-colors"><i class="fa-solid fa-crosshairs mr-0.5"></i> Detect</button></div> <input type="text" class="w-full px-3 py-2 rounded-md border border-border bg-surface-elevated text-text text-sm
                               placeholder-text-muted/50 focus:outline-none focus:ring-2 focus:ring-primary-500/50"/> <p class="text-xs text-text-subtle mt-1"> </p></div> <div class="flex items-center gap-3"><button class="px-4 py-2 rounded-md bg-primary-600 text-white font-medium text-sm
                               hover:bg-primary-500 transition-colors disabled:opacity-50"><!></button> <!></div></div>`,1),ve[c],[[673,12,[[674,16,[[675,20],[676,20]]],[678,16,[[679,20],[680,20]]]]],[689,12,[[690,16,[[691,20,[[692,24],[693,24,[[697,28]]]]],[700,20,[[701,24],[709,24]]],[718,20]]],[721,16,[[722,20,[[723,24],[724,24,[[728,28]]]]],[731,20],[738,20]]],[741,16,[[742,20]]]]]]),k2=v(u('<p class="text-text-subtle text-sm italic text-center py-2">Loading...</p>'),ve[c],[[760,12]]),T2=v(u(`<section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden mb-4"><div class="flex justify-between items-center border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-tower-broadcast mr-1.5"></i> Messaging Platforms</h2> <button class="mr-3 px-2.5 py-1 text-xs border border-border rounded-md bg-surface hover:bg-surface-elevated transition-colors"><i class="fa-solid fa-arrows-rotate mr-1"></i> Refresh</button></div> <div class="p-4 space-y-4"><!></div></section> <section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden mb-4"><div class="border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-shield-halved mr-1.5"></i> Dashboard Authentication</h2></div> <div class="p-4 space-y-4"><!></div></section> <section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden mb-4"><div class="border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-lock mr-1.5"></i> Two-Factor Authentication</h2></div> <div class="p-4"><!></div></section> <section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden mb-4"><div class="flex justify-between items-center border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-link mr-1.5"></i> Connected Accounts (OAuth)</h2> <!></div> <div class="p-3"><!></div></section> <section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden mb-4"><div class="border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-clock mr-1.5"></i> Timezone & Locale</h2></div> <div class="p-4 space-y-4"><!></div></section> <section class="bg-surface border border-border rounded-lg shadow-sm overflow-hidden"><div class="border-b border-border"><h2 class="text-xs font-semibold px-4 py-3 uppercase tracking-wider text-text-muted"><i class="fa-solid fa-circle-info mr-1.5"></i> Configuration Reference</h2></div> <div class="p-4 space-y-3 text-xs text-text-subtle"><p>Messaging and OAuth configuration is done via the TOML config file and environment variables. Changes require a container restart.</p> <div class="grid grid-cols-1 md:grid-cols-2 gap-3"><div class="p-3 rounded bg-surface-elevated border border-border/50"><p class="font-medium text-text-muted mb-1.5">Telegram</p> <code class="block whitespace-pre-wrap text-text-subtle leading-relaxed">[telegram]
enabled = true
allowed_chat_ids = [123456]

# env: TELEGRAM_BOT_TOKEN</code></div> <div class="p-3 rounded bg-surface-elevated border border-border/50"><p class="font-medium text-text-muted mb-1.5">WhatsApp</p> <code class="block whitespace-pre-wrap text-text-subtle leading-relaxed">[whatsapp]
enabled = true
bridge_port = 3033
webhook_port = 3030
allowed_numbers = ["+1234567890"]</code></div> <div class="p-3 rounded bg-surface-elevated border border-border/50"><p class="font-medium text-text-muted mb-1.5">Dashboard SSO</p> <code class="block whitespace-pre-wrap text-text-subtle leading-relaxed">[dashboard]
password_enabled = true
sso_providers = ["google", "github"]
sso_allowed_emails = ["admin@example.com"]</code></div> <div class="p-3 rounded bg-surface-elevated border border-border/50"><p class="font-medium text-text-muted mb-1.5">OAuth Providers</p> <code class="block whitespace-pre-wrap text-text-subtle leading-relaxed"># Per-provider env vars:
GOOGLE_CLIENT_ID / GOOGLE_CLIENT_SECRET
GITHUB_CLIENT_ID / GITHUB_CLIENT_SECRET
DISCORD_CLIENT_ID / DISCORD_CLIENT_SECRET
# ... etc. See config.example.toml</code></div></div></div></section> <section class="mt-6"><!></section>`,1),ve[c],[[246,0,[[247,4,[[248,8,[[249,12]]],[251,8,[[255,12]]]]],[258,4]]],[428,0,[[429,4,[[430,8,[[431,12]]]]],[434,4]]],[523,0,[[524,4,[[525,8,[[526,12]]]]],[529,4]]],[535,0,[[536,4,[[537,8,[[538,12]]]]],[546,4]]],[665,0,[[666,4,[[667,8,[[668,12]]]]],[671,4]]],[766,0,[[767,4,[[768,8,[[769,12]]]]],[772,4,[[773,8],[774,8,[[775,12,[[776,16],[777,16]]],[783,12,[[784,16],[785,16]]],[791,12,[[792,16],[793,16]]],[798,12,[[799,16],[800,16]]]]]]]]],[811,0]]);function ve(e,r){Wt(new.target),Gt(r,!0,ve);let a=$(A(null),"msgConfig"),n=$(A(null),"oauth"),o=$(A(null),"authInfo"),l=$(A(null),"refreshing"),p=$(A(ht(new Set)),"expandedProviders"),m=$(A(null),"waQrImage");async function b(){var E,J,xe,oe;try{if(f(a,(await N(et("GET","/api/messaging/config")))(),!0),O((J=(E=t(a))==null?void 0:E.whatsapp)==null?void 0:J.bridge_status,"pairing")&&((oe=(xe=t(a))==null?void 0:xe.whatsapp)!=null&&oe.qr))try{const ue=(await N(et("GET","/api/messaging/whatsapp/qr")))();f(m,(ue==null?void 0:ue.qr)??null,!0)}catch{f(m,null)}else f(m,null)}catch(ue){console.error(...bt("error","loadConfig:",ue))}}async function C(){try{f(n,(await N(et("GET","/api/oauth/status")))(),!0)}catch(E){console.error(...bt("error","loadOAuth:",E))}}async function y(){try{f(o,(await N(et("GET","/api/auth/info")))(),!0)}catch(E){console.error(...bt("error","loadAuth:",E))}}async function w(E,J){f(l,J??`${E}:all`,!0);try{const xe=J?`/api/oauth/${E}/refresh?account=${encodeURIComponent(J)}`:`/api/oauth/${E}/refresh`;(await N(et("POST",xe)))(),(await N(C()))()}catch(xe){console.error(...bt("error","refreshToken:",xe))}finally{f(l,null)}}async function h(E,J,xe){if(confirm(`Disconnect ${xe} from ${E}?`))try{(await N(et("POST",`/api/oauth/${E}/disconnect/${encodeURIComponent(J)}`)))(),(await N(C()))()}catch(oe){console.error(...bt("error","disconnect:",oe))}}function D(E){const J=new Set(t(p));J.has(E)?J.delete(E):J.add(E),f(p,J,!0)}function I(E){return E.filter(J=>J.accounts.length>0)}function Y(E){return E.filter(J=>O(J.accounts.length,0))}let j=$(A(null),"tzInfo"),z=$(A(ht([])),"allTimezones"),re=$(A(""),"selectedTimezone"),se=$(A(""),"selectedLocale"),be=$(A(!1),"tzSaving"),Oe=$(A(""),"tzMessage");async function me(){try{const E=Tt.userId||"",J=(await N(et("GET",`/api/timezone?user_id=${encodeURIComponent(E)}`)))();f(j,J,!0),f(re,(J==null?void 0:J.user_timezone)||"",!0),f(se,(J==null?void 0:J.user_locale)||"",!0)}catch(E){console.error(...bt("error","loadTimezone:",E))}}async function Se(){if(!(t(z).length>0))try{const E=(await N(et("GET","/api/timezones")))();f(z,(E==null?void 0:E.timezones)??[],!0)}catch(E){console.error(...bt("error","loadTimezoneList:",E))}}async function Ce(){if(Tt.userId){f(be,!0),f(Oe,"");try{const E=(await N(et("POST","/api/timezone",{user_id:Tt.userId,timezone:t(re)||void 0,locale:t(se)||void 0})))();f(Oe,E!=null&&E.ok?"Saved":(E==null?void 0:E.message)??"Failed",!0),(await N(me()))(),setTimeout(()=>{f(Oe,"")},3e3)}catch{f(Oe,"Network error")}finally{f(be,!1)}}}function Ee(){try{f(re,Intl.DateTimeFormat().resolvedOptions().timeZone,!0)}catch{f(re,"UTC")}}function Z(){try{f(se,navigator.language||"en-US",!0)}catch{f(se,"en-US")}}const ye=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","America/Toronto","America/Vancouver","America/Sao_Paulo","America/Mexico_City","Europe/London","Europe/Paris","Europe/Berlin","Europe/Moscow","Asia/Tokyo","Asia/Shanghai","Asia/Kolkata","Asia/Singapore","Asia/Dubai","Australia/Sydney","Australia/Melbourne","Pacific/Auckland","Africa/Cairo","Africa/Johannesburg"];fr(()=>{O(ot.currentTab,"settings")&&(ot.refreshCounter,b(),C(),y(),me(),Se())});var Be={...Ht()},De=T2(),U=We(De),te=s(U),$e=i(s(te),2),T=i(te,2),k=s(T);{var R=E=>{var J=kp();d(E,J)},ee=E=>{var J=Gp(),xe=We(J),oe=s(xe),ue=i(s(oe),2);{var Te=Me=>{var tt=Tp();d(Me,tt)},ze=Me=>{var tt=$p();d(Me,tt)},Ne=Me=>{var tt=Ep();d(Me,tt)};x(()=>g(ue,Me=>{t(a).telegram.enabled&&t(a).telegram.connected?Me(Te):t(a).telegram.enabled?Me(ze,1):Me(Ne,!1)}),"if",ve,272,20)}var Fe=i(oe,2),Ie=s(Fe),fe=i(s(Ie),2),we=s(fe),Pe=i(Ie,2),He=i(s(Pe),2),Ge=s(He),rt=i(Pe,2);{var gt=Me=>{var tt=Sp(),Lt=i(s(tt),2),At=s(Lt);S(tr=>_(At,tr),[()=>t(a).telegram.allowed_chat_ids.join(", ")]),d(Me,tt)},qe=Me=>{var tt=Cp();d(Me,tt)};x(()=>g(rt,Me=>{t(a).telegram.allowed_chat_ids.length>0?Me(gt):Me(qe,!1)}),"if",ve,291,20)}var je=i(rt,2);{var Ve=Me=>{var tt=Ap(),Lt=i(s(tt),2),At=s(Lt);S(()=>_(At,t(a).telegram.primary_channel)),d(Me,tt)};x(()=>g(je,Me=>{t(a).telegram.primary_channel&&Me(Ve)}),"if",ve,306,20)}var ft=i(je,2);{var Nt=Me=>{var tt=Pp();d(Me,tt)};x(()=>g(ft,Me=>{t(a).telegram.enabled||Me(Nt)}),"if",ve,312,20)}var Kt=i(xe,2),Xe=s(Kt),Ye=i(s(Xe),2);{var yt=Me=>{var tt=Op();d(Me,tt)},st=Me=>{var tt=jp();d(Me,tt)},Qe=Me=>{var tt=Lp();d(Me,tt)},ct=Me=>{var tt=Rp(),Lt=s(tt);S(()=>_(Lt,t(a).whatsapp.bridge_status)),d(Me,tt)};x(()=>g(Ye,Me=>{t(a).whatsapp.enabled?O(t(a).whatsapp.bridge_status,"connected")?Me(st,1):O(t(a).whatsapp.bridge_status,"pairing")?Me(Qe,2):Me(ct,!1):Me(yt)}),"if",ve,333,20)}var lt=i(Xe,2),at=s(lt),wt=i(s(at),2),Dt=s(wt),Yt=i(at,2);{var kt=Me=>{var tt=zp(),Lt=We(tt),At=i(s(Lt),2),tr=s(At),Tr=i(Lt,2),or=i(s(Tr),2),$r=s(or),Rt=i(Tr,2);{var Et=pr=>{var Er=Np(),wa=i(s(Er),2),ds=s(wa);S(ei=>_(ds,ei),[()=>t(a).whatsapp.allowed_numbers.join(", ")]),d(pr,Er)},Zt=pr=>{var Er=Dp();d(pr,Er)};x(()=>g(Rt,pr=>{t(a).whatsapp.allowed_numbers.length>0?pr(Et):pr(Zt,!1)}),"if",ve,357,24)}var mr=i(Rt,2);{var ya=pr=>{var Er=Ip(),wa=i(s(Er),2),ds=s(wa);S(()=>_(ds,t(a).whatsapp.connected_number)),d(pr,Er)};x(()=>g(mr,pr=>{t(a).whatsapp.connected_number&&pr(ya)}),"if",ve,372,24)}var ls=i(mr,2);{var la=pr=>{var Er=Up(),wa=i(s(Er),2);{var ds=Ba=>{var Ps=Mp();S(()=>Vt(Ps,"src",t(m))),d(Ba,Ps)},ei=Ba=>{var Ps=Fp();d(Ba,Ps)};x(()=>g(wa,Ba=>{t(m)?Ba(ds):Ba(ei,!1)}),"if",ve,385,32)}var Zn=i(wa,2);X("click",Zn,b),d(pr,Er)};x(()=>g(ls,pr=>{O(t(a).whatsapp.bridge_status,"pairing")&&pr(la)}),"if",ve,380,24)}S(()=>{_(tr,t(a).whatsapp.bridge_port),_($r,t(a).whatsapp.webhook_port)}),d(Me,tt)},Pt=Me=>{var tt=Bp();d(Me,tt)};x(()=>g(Yt,Me=>{t(a).whatsapp.enabled?Me(kt):Me(Pt,!1)}),"if",ve,348,20)}var Ke=i(Kt,2),Ze=i(s(Ke),2),Ct=s(Ze),Qt=i(Ct);{var Ut=Me=>{var tt=ua();S(Lt=>_(tt,`(${Lt??""})`),[()=>t(a).active_platforms.join(", ")]),d(Me,tt)};x(()=>g(Qt,Me=>{t(a).active_platforms.length>0&&Me(Ut)}),"if",ve,417,20)}S(()=>{_(we,t(a).telegram.enabled?"Yes":"No"),Le(He,1,t(a).telegram.has_token?"text-green-400":"text-red-400"),_(Ge,t(a).telegram.has_token?"Set (TELEGRAM_BOT_TOKEN)":"Not set"),_(Dt,t(a).whatsapp.enabled?"Yes":"No"),_(Ct,`${t(a).active_platforms.length??""} active platform${O(t(a).active_platforms.length,1,!1)?"s":""} `)}),d(E,J)};x(()=>g(k,E=>{t(a)?E(ee,!1):E(R)}),"if",ve,259,8)}var W=i(U,2),le=i(s(W),2),ke=s(le);{var Ae=E=>{var J=qp();d(E,J)},q=E=>{var J=t2(),xe=We(J),oe=s(xe),ue=s(oe),Te=i(s(ue),2);{var ze=Xe=>{var Ye=Kp();d(Xe,Ye)},Ne=Xe=>{var Ye=Vp();d(Xe,Ye)};x(()=>g(Te,Xe=>{t(o).password_enabled?Xe(ze):Xe(Ne,!1)}),"if",ve,446,24)}var Fe=i(ue,2),Ie=s(Fe);{var fe=Xe=>{var Ye=Wp();d(Xe,Ye)},we=Xe=>{var Ye=Hp();d(Xe,Ye)};x(()=>g(Ie,Xe=>{t(o).password_enabled?Xe(fe):Xe(we,!1)}),"if",ve,453,24)}var Pe=i(oe,2),He=s(Pe),Ge=i(s(He),2);{var rt=Xe=>{var Ye=Jp(),yt=s(Ye);S(()=>_(yt,`${t(o).sso_providers.length??""} configured`)),d(Xe,Ye)},gt=Xe=>{var Ye=Yp();d(Xe,Ye)};x(()=>g(Ge,Xe=>{t(o).sso_providers.length>0?Xe(rt):Xe(gt,!1)}),"if",ve,468,24)}var qe=i(He,2),je=s(qe);{var Ve=Xe=>{var Ye=Zp();x(()=>mt(Ye,21,()=>t(o).sso_providers,Ft,(yt,st)=>{var Qe=Qp(),ct=s(Qe),lt=i(ct,2),at=s(lt,!0);S(()=>{Le(ct,1,`${t(st).icon??""} text-sm w-5 text-center`),_(at,t(st).name)}),d(yt,Qe)}),"each",ve,479,32),d(Xe,Ye)},ft=Xe=>{var Ye=Xp();d(Xe,Ye)};x(()=>g(je,Xe=>{t(o).sso_providers.length>0?Xe(Ve):Xe(ft,!1)}),"if",ve,477,24)}var Nt=i(xe,2);{var Kt=Xe=>{var Ye=e2();d(Xe,Ye)};x(()=>g(Nt,Xe=>{!t(o).password_enabled&&O(t(o).sso_providers.length,0)&&Xe(Kt)}),"if",ve,496,12)}d(E,J)};x(()=>g(ke,E=>{t(o)?E(q,!1):E(Ae)}),"if",ve,435,8)}var B=i(W,2),L=i(s(B),2),K=s(L);x(()=>xt(K,{}),"component",ve,530,8,{componentTag:"TwoFactorPanel"});var ce=i(B,2),he=s(ce),ge=i(s(he),2);{var V=E=>{var J=r2(),xe=s(J);S((oe,ue)=>_(xe,`${oe??""} account${ue??""}`),[()=>I(t(n).providers).reduce((oe,ue)=>oe+ue.accounts.length,0),()=>O(I(t(n).providers).reduce((oe,ue)=>oe+ue.accounts.length,0),1,!1)?"s":""]),d(E,J)};x(()=>g(ge,E=>{t(n)&&E(V)}),"if",ve,540,8)}var M=i(he,2),_e=s(M);{var P=E=>{var J=a2();d(E,J)},ae=E=>{var J=p2(),xe=We(J);x(()=>mt(xe,17,()=>I(t(n).providers),Fe=>Fe.id,(Fe,Ie)=>{var fe=d2(),we=s(fe),Pe=s(we),He=s(Pe),Ge=i(He,2),rt=s(Ge,!0);var gt=i(Ge,2),qe=s(gt,!0);var je=i(Pe,2),Ve=s(je);{var ft=st=>{var Qe=s2(),ct=s(Qe);let lt;S(()=>{Qe.disabled=O(t(l),null,!1),lt=Le(ct,1,"fa-solid fa-arrows-rotate",null,lt,{"fa-spin":O(t(l),`${t(Ie).id}:all`)})}),X("click",Qe,function(wt){wt.stopPropagation(),w(t(Ie).id)}),d(st,Qe)};x(()=>g(Ve,st=>{t(Ie).accounts.length>1&&st(ft)}),"if",ve,568,28)}var Nt=i(Ve,2),Kt=i(Nt,2);var Xe=i(we,2);{var Ye=st=>{var Qe=l2();x(()=>mt(Qe,21,()=>t(Ie).accounts,ct=>ct.account,(ct,lt)=>{var at=o2(),wt=s(at),Dt=s(wt),Yt=s(Dt,!0);var kt=i(Dt,2),Pt=s(kt);{var Ke=At=>{var tr=i2(),Tr=s(tr);S(or=>_(Tr,`Updated: ${or??""}`),[()=>ga(t(lt).updated_at)]),d(At,tr)};x(()=>g(Pt,At=>{t(lt).updated_at&&At(Ke)}),"if",ve,597,44)}var Ze=i(Pt,2);{var Ct=At=>{var tr=n2();d(At,tr)};x(()=>g(Ze,At=>{t(lt).has_refresh_token||At(Ct)}),"if",ve,600,44)}var Qt=i(wt,2),Ut=s(Qt),Me=s(Ut);let tt;var Lt=i(Ut,2);S(()=>{_(Yt,t(lt).email),Ut.disabled=O(t(l),null,!1),tt=Le(Me,1,"fa-solid fa-arrows-rotate",null,tt,{"fa-spin":O(t(l),t(lt).account)})}),X("click",Ut,function(){return w(t(Ie).id,t(lt).account)}),X("click",Lt,function(){return h(t(Ie).id,t(lt).account,t(lt).email)}),d(ct,at)}),"each",ve,592,28),d(st,Qe)},yt=cr(()=>t(p).has(t(Ie).id)||t(Ie).accounts.length<=2);x(()=>g(Xe,st=>{t(yt)&&st(Ye)}),"if",ve,590,20)}S(st=>{Le(He,1,`${t(Ie).icon??""} text-sm w-5 text-center`),_(rt,t(Ie).name),_(qe,t(Ie).accounts.length),Vt(Nt,"href",t(Ie).authorize_url),Le(Kt,1,`fa-solid fa-chevron-${st??""} text-xs text-text-subtle`)},[()=>t(p).has(t(Ie).id)?"up":"down"]),X("click",we,function(){return D(t(Ie).id)}),X("keydown",we,function(Qe){O(Qe.key,"Enter")&&D(t(Ie).id)}),X("click",Nt,function(Qe){return Qe.stopPropagation()}),d(Fe,fe)}),"each",ve,551,12);var oe=i(xe,2);{var ue=Fe=>{var Ie=u2(),fe=i(s(Ie),2);x(()=>mt(fe,21,()=>Y(t(n).providers),we=>we.id,(we,Pe)=>{var He=er(),Ge=We(He);{var rt=qe=>{var je=c2(),Ve=s(je),ft=i(Ve);S(()=>{Vt(je,"href",t(Pe).authorize_url),Le(Ve,1,t(Pe).icon),_(ft,` ${t(Pe).name??""}`)}),d(qe,je)},gt=qe=>{var je=v2(),Ve=s(je),ft=i(Ve);S((Nt,Kt)=>{Vt(je,"title",`Not configured — set ${Nt??""}_CLIENT_ID and ${Kt??""}_CLIENT_SECRET`),Le(Ve,1,t(Pe).icon),_(ft,` ${t(Pe).name??""}`)},[()=>t(Pe).id.toUpperCase(),()=>t(Pe).id.toUpperCase()]),d(qe,je)};x(()=>g(Ge,qe=>{t(Pe).configured?qe(rt):qe(gt,!1)}),"if",ve,637,28)}d(we,He)}),"each",ve,636,24),d(Fe,Ie)},Te=cr(()=>Y(t(n).providers).length>0);x(()=>g(oe,Fe=>{t(Te)&&Fe(ue)}),"if",ve,632,12)}var ze=i(oe,2);{var Ne=Fe=>{var Ie=f2();d(Fe,Ie)};x(()=>g(ze,Fe=>{O(t(n).providers.length,0)&&Fe(Ne)}),"if",ve,657,12)}d(E,J)};x(()=>g(_e,E=>{O(t(n),null)?E(P):E(ae,!1)}),"if",ve,547,8)}var de=i(ce,2),F=i(s(de),2),ne=s(F);{var pe=E=>{var J=w2(),xe=We(J),oe=s(xe),ue=i(s(oe),2),Te=s(ue),ze=i(oe,2),Ne=i(s(ze),2),Fe=s(Ne),Ie=i(Ne,2);{var fe=Ke=>{var Ze=x2();d(Ke,Ze)},we=Ke=>{var Ze=m2();d(Ke,Ze)};x(()=>g(Ie,Ke=>{t(j).user_timezone?Ke(fe):Ke(we,!1)}),"if",ve,681,20)}var Pe=i(xe,2),He=s(Pe),Ge=s(He),rt=i(s(Ge),2),gt=i(Ge,2),qe=s(gt),je=i(qe,2),Ve=s(je);x(()=>mt(Ve,17,()=>ye,Ft,(Ke,Ze)=>{var Ct=_2(),Qt={};S(()=>{Qt!==(Qt=t(Ze))&&(Ct.value=(Ct.__value=t(Ze))??"")}),d(Ke,Ct)}),"each",ve,710,28);var ft=i(Ve);x(()=>mt(ft,17,()=>t(z).filter(Ke=>!ye.includes(Ke)),Ft,(Ke,Ze)=>{var Ct=b2(),Qt={};S(()=>{Qt!==(Qt=t(Ze))&&(Ct.value=(Ct.__value=t(Ze))??"")}),d(Ke,Ct)}),"each",ve,713,28);var Nt=i(gt,2),Kt=s(Nt),Xe=i(He,2),Ye=s(Xe),yt=i(s(Ye),2),st=i(Ye,2),Qe=i(st,2),ct=s(Qe),lt=i(Xe,2),at=s(lt),wt=s(at);{var Dt=Ke=>{var Ze=g2();d(Ke,Ze)},Yt=Ke=>{var Ze=h2();d(Ke,Ze)};x(()=>g(wt,Ke=>{t(be)?Ke(Dt):Ke(Yt,!1)}),"if",ve,748,24)}var kt=i(at,2);{var Pt=Ke=>{var Ze=y2(),Ct=s(Ze);S(()=>{Le(Ze,1,`text-xs ${O(t(Oe),"Saved")?"text-green-400":"text-red-400"}`),_(Ct,t(Oe))}),d(Ke,Ze)};x(()=>g(kt,Ke=>{t(Oe)&&Ke(Pt)}),"if",ve,754,20)}S(()=>{_(Te,t(j).current_time_formatted),_(Fe,t(j).effective_timezone),Vt(qe,"placeholder",t(j).system_timezone||"UTC"),_(Kt,`IANA timezone name. Leave empty to use system default (${t(j).system_timezone??""}).`),Vt(st,"placeholder",t(j).system_locale||"en-US"),_(ct,`BCP 47 locale tag (e.g. en-US, de-DE, ja-JP). Leave empty to use system default (${t(j).system_locale??""}).`),at.disabled=t(be)}),X("click",rt,Ee),St(qe,function(){return t(re)},function(Ze){f(re,Ze)}),X("click",yt,Z),St(st,function(){return t(se)},function(Ze){f(se,Ze)}),X("click",at,Ce),d(E,J)},ie=E=>{var J=k2();d(E,J)};x(()=>g(ne,E=>{t(j)?E(pe):E(ie,!1)}),"if",ve,672,8)}var H=i(de,4),Q=s(H);return x(()=>jt(Q,{}),"component",ve,812,4,{componentTag:"UsersPanel"}),X("click",$e,b),d(e,De),qt(Be)}ar(["click","keydown"]);Ot[c]="src/App.svelte";var $2=v(u("<button><i></i> </button>"),Ot[c],[[140,16,[[145,20]]]]),E2=v(u('<!> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"><!> <!> <!> <!></div>',1),Ot[c],[[152,12]]),S2=v(u('<!> <main class="p-6"><div class="flex border-b border-border mb-4"></div> <!></main>',1),Ot[c],[[137,4,[[138,8]]]]);function Ot(e,r){Wt(new.target),Gt(r,!0,Ot);const a=3e4,n=[{id:"overview",label:"Overview",icon:"fa-chart-line"},{id:"chat",label:"Chat",icon:"fa-comments"},{id:"goals",label:"Goals",icon:"fa-bullseye"},{id:"skills",label:"Skills",icon:"fa-puzzle-piece"},{id:"knowledge",label:"Knowledge",icon:"fa-diagram-project"},{id:"tools",label:"Tools",icon:"fa-screwdriver-wrench"},{id:"trash",label:"Trash",icon:"fa-trash-can"},{id:"security",label:"Security",icon:"fa-shield-halved"},{id:"operations",label:"Ops",icon:"fa-server"},{id:"settings",label:"Settings",icon:"fa-gear"}];function o(z){ot.currentTab=z}async function l(){try{const z=(await N(fetch("/api/auth/check")))(),re=(await N(z.json()))();Tt.authenticated=O(re.authenticated,!0),Tt.userId=re.user_id||null,Tt.role=re.role||null,Tt.subject=re.subject||null}catch{Tt.authenticated=!1}finally{Tt.checked=!0}}async function p(){try{const z=(await N(fetch("/api/onboarding/status")))(),re=(await N(z.json()))();Tt.onboardingCompleted=O(re.completed,!0)}catch{Tt.onboardingCompleted=!0}}function m(){Tt.onboardingCompleted=!0}os(()=>(p(),l(),window.addEventListener("onboarding-complete",m),()=>{window.removeEventListener("onboarding-complete",m)}));let b,C;fr(()=>(Tt.authenticated&&(ns(()=>Mr()),b=new EventSource("/api/events"),b.onmessage=z=>{const re=z.data;if(re&&re.startsWith("{"))try{const se=JSON.parse(re);if(se.type){Yn(se),(O(se.type,"turn_complete")||O(se.type,"approval_needed"))&&Mr();return}}catch{}Mr()},b.onerror=()=>{console.error("SSE connection lost, will retry..."),Qn()},C=setInterval(Mr,a)),()=>{b==null||b.close(),b=void 0,C&&(clearInterval(C),C=void 0)}));var y={...Ht()},w=er(),h=We(w);{var D=z=>{},I=z=>{x(()=>nt(z,{}),"component",Ot,131,4,{componentTag:"OnboardingWizard"})},Y=z=>{x(()=>dt(z,{}),"component",Ot,133,4,{componentTag:"LoginOverlay"})},j=z=>{var re=S2(),se=We(re);x(()=>Fr(se,{}),"component",Ot,135,4,{componentTag:"Header"});var be=i(se,2),Oe=s(be);x(()=>mt(Oe,21,()=>n,Ft,(T,k)=>{var R=$2();let ee;var W=s(R),le=i(W);S(()=>{ee=Le(R,1,"main-tab",null,ee,{active:O(ot.currentTab,t(k).id)}),Le(W,1,`fa-solid ${t(k).icon??""} mr-1.5`),_(le,` ${t(k).label??""}`)}),X("click",R,function(){return o(t(k).id)}),d(T,R)}),"each",Ot,139,12);var me=i(Oe,2);{var Se=T=>{var k=E2(),R=We(k);x(()=>Mt(R,{}),"component",Ot,151,12,{componentTag:"LiveFeed"});var ee=i(R,2),W=s(ee);x(()=>ba(W,{}),"component",Ot,153,16,{componentTag:"PendingActions"});var le=i(W,2);x(()=>Jr(le,{}),"component",Ot,154,16,{componentTag:"ActivityLog"});var ke=i(le,2);x(()=>rr(ke,{}),"component",Ot,155,16,{componentTag:"MemoryPanel"});var Ae=i(ke,2);x(()=>Qr(Ae,{}),"component",Ot,156,16,{componentTag:"StatsPanel"}),d(T,k)},Ce=T=>{x(()=>Bt(T,{}),"component",Ot,159,12,{componentTag:"ChatTab"})},Ee=T=>{x(()=>it(T,{}),"component",Ot,161,12,{componentTag:"GoalsTab"})},Z=T=>{x(()=>sr(T,{}),"component",Ot,163,12,{componentTag:"SkillsTab"})},ye=T=>{x(()=>Ur(T,{}),"component",Ot,165,12,{componentTag:"KnowledgeTab"})},Be=T=>{x(()=>ha(T,{}),"component",Ot,167,12,{componentTag:"ToolsTab"})},De=T=>{x(()=>zt(T,{}),"component",Ot,169,12,{componentTag:"TrashTab"})},U=T=>{x(()=>Je(T,{}),"component",Ot,171,12,{componentTag:"SecurityTab"})},te=T=>{x(()=>Re(T,{}),"component",Ot,173,12,{componentTag:"OperationsTab"})},$e=T=>{x(()=>ve(T,{}),"component",Ot,175,12,{componentTag:"SettingsTab"})};x(()=>g(me,T=>{O(ot.currentTab,"overview")?T(Se):O(ot.currentTab,"chat")?T(Ce,1):O(ot.currentTab,"goals")?T(Ee,2):O(ot.currentTab,"skills")?T(Z,3):O(ot.currentTab,"knowledge")?T(ye,4):O(ot.currentTab,"tools")?T(Be,5):O(ot.currentTab,"trash")?T(De,6):O(ot.currentTab,"security")?T(U,7):O(ot.currentTab,"operations")?T(te,8):O(ot.currentTab,"settings")&&T($e,9)}),"if",Ot,150,8)}d(z,re)};x(()=>g(h,z=>{Tt.checked?O(Tt.onboardingCompleted,!1)?z(I,1):Tt.authenticated?z(j,!1):z(Y,2):z(D)}),"if",Ot,128,0)}return d(e,w),qt(y)}ar(["click"]);Dl(Ot,{target:document.getElementById("app")});
